---
layout: default
title: TechnicalReference_Asr_Dcm
nav_order: 14
parent: Fiasa_326_327_EPS_TMS570
---
{% raw %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title></title>
  <meta name="generator" content="LibreOffice 24.2.7.2 (Linux)"/>
  <meta name="created" content="00:00:00"/>
  <meta name="changed" content="00:00:00"/>
</head>
<body>
<h1></h1>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>MICROSAR DCM </b></p>
<p>Technical Reference </p>
<p> </p>
<p>Vector  </p>
<p>Version 3.26.02 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Authors </p>
<p>Mishel Shishmanyan, Jochen Breunich, Katrin Thurow </p>
<p>Status </p>
<p>Released </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>2 / 163 </p>
<p><b>1 </b></p>
<p><b>Document Information </b></p>
<p><b>1.1 </b></p>
<p><b>History </b></p>
<p><b>Author </b></p>
<p><b>Date </b></p>
<p><b>Version </b></p>
<p><b>Remarks </b></p>
<p>Mishel Shishmanyan </p>
<p>2008-04-20 </p>
<p>1.0 </p>
<p>Reworks based on the new document </p>
<p>template. </p>
<p>Mishel Shishmanyan </p>
<p>2008-06-13 </p>
<p>1.1 </p>
<p>Extensions to DCM 3.03.00 </p>
<p>Removed unused chapters and sections. </p>
<p>Modified: </p>
<p><i>5.10.3 Configuration Aspects </i></p>
<p>Mishel Shishmanyan </p>
<p>2008-07-18 </p>
<p>1.2 </p>
<p>Minor editorial changes. </p>
<p>Added: </p>
<p><i>6 Additional features beyond AUTOSAR </i></p>
<p><i>DCM 3.0 </i></p>
<p>Mishel Shishmanyan </p>
<p>2008-08-20 </p>
<p>3.4 </p>
<p>Modified: </p>
<p>Version jump to unify the different DCM </p>
<p>generation documentations. </p>
<p><i>8.5.1.2.11, 8.5.1.2.12, 8.5.1.2.13, 8.5.1.2.14 </i></p>
<p>– port interface change for service $2F. </p>
<p><i>9.2.2 General DCM options </i></p>
<p> </p>
<p><i> </i></p>
<p>Mishel Shishmanyan </p>
<p>2008-09-01 </p>
<p>3.5 </p>
<p>Modified: </p>
<p><i>5.18.1 Functionality </i></p>
<p><i>Table 8-23   Require Ports on BSW module </i></p>
<p><i>side </i></p>
<p> </p>
<p>Added: </p>
<p><i>5.18.1.1 Difference between single and </i></p>
<p><i>multiple UUDT message transmission </i></p>
<p>Mishel Shishmanyan </p>
<p> 2008-10-08 </p>
<p>3.6 </p>
<p>Modified: </p>
<p><i>5.16.2 Implementation Limitations </i></p>
<p><i>Figure 8-1 </i></p>
<p><i>DCM interactions with other </i></p>
<p><i>BSW </i></p>
<p><i> </i></p>
<p><i>10.2.5 Jump into FBL on Request </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>3 / 163 </p>
<p><i>“Programming Session” ($10 $02) </i></p>
<p>Mishel Shishmanyan </p>
<p>2008-11-21 </p>
<p>3.7 </p>
<p>Modified: </p>
<p><i>5.13.3.2 GENy </i></p>
<p><i>9.2.2General DCM options </i></p>
<p>Mishel Shishmanyan </p>
<p>2008-12-15 </p>
<p>3.8 </p>
<p>Modified: </p>
<p>Minor editorial changes. </p>
<p><i>Table 8-23   Require Ports on BSW module </i></p>
<p><i>side </i></p>
<p> </p>
<p>Added: </p>
<p>Full description of all service ports required </p>
<p>by DCM. </p>
<p><i>8.5.1.3 Implementation Hints for Port Usage </i></p>
<p>Mishel Shishmanyan </p>
<p>2009-01-23 </p>
<p>3.9 </p>
<p>Modified: </p>
<p><i>1.2 Reference Documents </i></p>
<p><i> </i></p>
<p>Mishel Shishmanyan </p>
<p>2009-02-27 </p>
<p>3.10 </p>
<p>Added: </p>
<p><i>8.5.1.2Require Ports </i>– detailed description </p>
<p>of all ports. </p>
<p> </p>
<p>Modified: </p>
<p><i>8.3 Services Used by DCM </i>– all services </p>
<p>that DCM uses are now described. </p>
<p><i>8.5.1.2Require Ports </i>– all ports that DCM </p>
<p>requires are now described. </p>
<p><i>9.2.2General DCM options </i></p>
<p><i>5.11EcuReset ($11) </i></p>
<p>Mishel Shishmanyan </p>
<p>2009-03-27 </p>
<p>3.11 </p>
<p>Added: </p>
<p><i>10.1.2 Compiler abstraction </i></p>
<p> </p>
<p>Modified: </p>
<p><i>Table 1-3  Component history </i></p>
<p><i>Table 8-3  Services used by the DCM </i></p>
<p><i> </i></p>
<p>Mishel Shishmanyan </p>
<p>2009-05-22 </p>
<p>3.12 </p>
<p>Modified: </p>
<p><i>10.1.2 Compiler abstraction </i></p>
<p><i>3.2 Initialization </i></p>
<p> </p>
<p>Added: </p>
<p><i>Table 3-3  Dcm_Init </i></p>
<p>Mishel Shishmanyan </p>
<p>2009-07-31 </p>
<p>3.13 </p>
<p>Modified: </p>
<p>Minor editorial changes. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>4 / 163 </p>
<p><i>Table 1-3  Component history </i></p>
<p><i>Table 8-3  Services used by the DCM </i></p>
<p> </p>
<p> </p>
<p>Added: </p>
<p><i>3.3 VSG Configuration Set Pre-Selection </i></p>
<p><i> </i></p>
<p><i>6.3 Multi-Identity Support </i></p>
<p><i> </i></p>
<p>Mishel Shishmanyan </p>
<p>2009-08-31 </p>
<p>3.14 </p>
<p> </p>
<p>Jochen Breunich </p>
<p>Mishel Shishmanyan </p>
<p>2009-10-27 </p>
<p>3.15 </p>
<p>Added: </p>
<p><i>6.4 Code Template </i></p>
<p> </p>
<p>Modified: </p>
<p>4.1.2 <i>Dynamic Files – </i>Added new dynamic </p>
<p>files Appl_Dcm.h/.c </p>
<p>8.5.1.2 <i>Require Ports </i>– Corrected API </p>
<p>descriptions </p>
<p> </p>
<p>Mishel Shishmanyan </p>
<p>2010-01-20 </p>
<p>3.16 </p>
<p>Added: </p>
<p><i>7 Overview of all Services handled by DCM </i></p>
<p>Modified: </p>
<p><i> </i></p>
<p>Minor editorial changes. </p>
<p>Mishel Shishmanyan </p>
<p>2010-02-11 </p>
<p>3.17 </p>
<p>Added: </p>
<p>New OEM support </p>
<p>Mishel Shishmanyan </p>
<p>2010-03-31 </p>
<p>3.18 </p>
<p>Added: </p>
<p>Support for DirectMemoryAccess services </p>
<p> </p>
<p>New ISO 14229-1 standard reference </p>
<p>Katrin Thurow </p>
<p>2010-04-27 </p>
<p>3.19 </p>
<p>Added: </p>
<p><i>New OEM support </i></p>
<p><i>Table 5-18    Security Access Attributes in </i></p>
<p><i>CANdela </i></p>
<p>Used Service </p>
<p>EcuM_GeneratorCompatibilityError </p>
<p>Support Communication Control </p>
<p><i>  </i></p>
<p> </p>
<p>Modified: </p>
<p><i>9.2 Configuration with GENy </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>5 / 163 </p>
<p>Mishel Shishmanyan </p>
<p>2010-07-28 </p>
<p>3.20 </p>
<p>Added: </p>
<p><i>4.4Critical Sections </i></p>
<p> </p>
<p>Modified: </p>
<p>Minor editorial changes. </p>
<p><i>8.5.1.2.8&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_R</i></p>
<p><i>eadData </i></p>
<p>Mishel Shishmanyan </p>
<p>2010-08-09 </p>
<p>3.21 </p>
<p>Added: </p>
<p><i>6.5 Support of Unspecified Services </i></p>
<p><i> </i></p>
<p><i> </i></p>
<p>Modified: </p>
<p><i>9.2.2 General DCM options </i></p>
<p>Mishel Shishmanyan </p>
<p>2010-10-27 </p>
<p>3.22 </p>
<p>Added: </p>
<p>New OEM support. </p>
<p><i> </i></p>
<p>Removed: </p>
<p> </p>
<p>Mishel Shishmanyan </p>
<p>2010-12-10 </p>
<p>3.23 </p>
<p>Added: </p>
<p><i>3.5.1 Split task functions </i></p>
<p><i>8.3.3 Jump To/From FBL </i></p>
<p><i>9.2.1.1 Path placeholders </i></p>
<p> </p>
<p>Modified: </p>
<p><i>5.22.2 Implementation Limitations </i></p>
<p>Mishel Shishmanyan </p>
<p>2011-02-03 </p>
<p>3.24 </p>
<p>Minor editorial changes. </p>
<p> </p>
<p>Mishel Shishmanyan </p>
<p>2011-02-14 </p>
<p>3.25 </p>
<p>Modified: </p>
<p><i>9.2.2 General DCM options </i></p>
<p>Mishel Shishmanyan </p>
<p>2011-05-06 </p>
<p>3.26 </p>
<p> </p>
<p>Added: </p>
<p>Chapters <i>5.1- 5.9 </i>(OBD services) </p>
<p><i>6.2 (WWH-)OBD Support </i></p>
<p><i>7 Overview of all Services handled by DCM </i></p>
<p><i>10.2.5.2 AR 4.0 like Jump to/from the FBL </i></p>
<p>Modified: </p>
<p><i>1.2 Reference Documents</i>. </p>
<p>Mishel Shishmanyan </p>
<p>2011-12-16 </p>
<p>3.26.01 </p>
<p>Added: </p>
<p><i>8.5.1.2.24&lt;CallPrefix&gt;InfoTypeServices_&lt;IN</i></p>
<p><i>FID&gt;_ReadDataLength </i></p>
<p>Modified: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>6 / 163 </p>
<p><i>8.5.1.2.23&lt;CallPrefix&gt;InfoTypeServices_&lt;IN</i></p>
<p><i>FID&gt;_GetInfoTypeValue </i></p>
<p> </p>
<p>Mishel Shishmanyan </p>
<p>2012-10-10 </p>
<p>3.26.02 </p>
<p>Modified: </p>
<p><i>Table 8-35 </i></p>
<p><i> </i></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteDat</i></p>
<p><i>a </i>– minor changes on return value and </p>
<p>function descriptions. </p>
<p><i>Table 8-36 </i></p>
<p><i> </i></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnC</i></p>
<p><i>ontrolToECU </i>– added limitation to the </p>
<p>DCM_E_PENDING return value usage. </p>
<p>Table 1-1  </p>
<p>History of the document </p>
<p><b>1.2 </b></p>
<p><b>Reference Documents </b></p>
<p><b>No. </b></p>
<p><b>Title </b></p>
<p><b>Version </b></p>
<p>[1] </p>
<p> </p>
<p>AUTOSAR_SWS_DCM.pdf </p>
<p>V3.0.0 </p>
<p>[2] </p>
<p> </p>
<p>AUTOSAR_SWS_DET.pdf </p>
<p>V2.2.0 </p>
<p>[3] </p>
<p> </p>
<p>AUTOSAR_SWS_DEM.pdf </p>
<p>V2.1.1 </p>
<p>V2.2.1 </p>
<p>[4] </p>
<p> </p>
<p>AUTOSAR_BasicSoftwareModules.pdf </p>
<p>V1.0.0 </p>
<p>[5] </p>
<p> </p>
<p>ISO 14229-1 UDS </p>
<p>2010 </p>
<p>[6] </p>
<p> </p>
<p>ISO 15765-4 Requirements for emissions-related systems </p>
<p>2004 </p>
<p>[7] </p>
<p> </p>
<p>ISO 15031-5 Emissions-related diagnostic services </p>
<p>2004 </p>
<p>[8] </p>
<p> </p>
<p>Application Note AN-ISC-8-1118 – MICROSAR BSW Compatibility Check </p>
<p>V1.0.0 </p>
<p>[9] </p>
<p> </p>
<p>ISO 27145-2 WWH-OBD CDD Emissions </p>
<p>2009 </p>
<p>[10]  </p>
<p>ISO 27145-3 WWH-OBD CMD </p>
<p>2009 </p>
<p>Table 1-2  </p>
<p>Reference documents </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>Please note </b></p>
<p>We have configured the programs in accordance with your specifications in the </p>
<p>questionnaire. Whereas the programs do support other configurations than the one </p>
<p>specified in your questionnaire, Vector’s release of the programs delivered to your </p>
<p>company is expressly restricted to the configuration you have specified in the </p>
<p>questionnaire. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>7 / 163 </p>
<p><b>Contents </b></p>
<p><b>1</b></p>
<p> </p>
<p><b>Document Information ................................................................................................... 2</b></p>
<p> </p>
<p>1.1</p>
<p> </p>
<p>History ............................................................................................................. 2</p>
<p> </p>
<p>1.2</p>
<p> </p>
<p>Reference Documents ..................................................................................... 6</p>
<p> </p>
<p><b>2</b></p>
<p> </p>
<p><b>Introduction .................................................................................................................. 21</b></p>
<p> </p>
<p>2.1</p>
<p> </p>
<p>Architecture Overview ................................................................................... 22</p>
<p> </p>
<p><b>3</b></p>
<p> </p>
<p><b>Functional Description ................................................................................................ 24</b></p>
<p> </p>
<p>3.1</p>
<p> </p>
<p>Features ........................................................................................................ 24</p>
<p> </p>
<p>3.2</p>
<p> </p>
<p>Initialization ................................................................................................... 24</p>
<p> </p>
<p>3.3</p>
<p> </p>
<p>VSG Configuration Set Pre-Selection ............................................................ 25</p>
<p> </p>
<p>3.4</p>
<p> </p>
<p>States ............................................................................................................ 27</p>
<p> </p>
<p>3.5</p>
<p> </p>
<p>Main Functions .............................................................................................. 27</p>
<p> </p>
<p>3.5.1</p>
<p> </p>
<p>Split task functions ........................................................................................ 27</p>
<p> </p>
<p>3.5.1.1</p>
<p> </p>
<p>Dcm_TimerTask ............................................................................................ 28</p>
<p> </p>
<p>3.5.1.2</p>
<p> </p>
<p>Dcm_StateTask ............................................................................................. 29</p>
<p> </p>
<p>3.6</p>
<p> </p>
<p>Error Handling ............................................................................................... 29</p>
<p> </p>
<p>3.6.1</p>
<p> </p>
<p>Development Error Reporting ........................................................................ 29</p>
<p> </p>
<p>3.6.2</p>
<p> </p>
<p>Production Code Error Reporting .................................................................. 30</p>
<p> </p>
<p><b>4</b></p>
<p> </p>
<p><b>Integration .................................................................................................................... 31</b></p>
<p> </p>
<p>4.1</p>
<p> </p>
<p>Scope of Delivery .......................................................................................... 31</p>
<p> </p>
<p>4.1.1</p>
<p> </p>
<p>Static Files ..................................................................................................... 31</p>
<p> </p>
<p>4.1.2</p>
<p> </p>
<p>Dynamic Files................................................................................................ 31</p>
<p> </p>
<p>4.2</p>
<p> </p>
<p>Include Structure ........................................................................................... 32</p>
<p> </p>
<p>4.2.1</p>
<p> </p>
<p>For DCM versions older than 3.15.00 ............................................................ 32</p>
<p> </p>
<p>4.2.2</p>
<p> </p>
<p>For DCM version 3.15.00 and newer ............................................................. 33</p>
<p> </p>
<p>4.3</p>
<p> </p>
<p>Compiler Abstraction and Memory Mapping .................................................. 33</p>
<p> </p>
<p>4.4</p>
<p> </p>
<p>Critical Sections ............................................................................................ 34</p>
<p> </p>
<p>4.5</p>
<p> </p>
<p>Considerations Using Request- and ResponseData Pointers in a Call-</p>
<p>back .............................................................................................................. 35</p>
<p> </p>
<p><b>5</b></p>
<p> </p>
<p><b>Diagnostic Service Implementation ............................................................................ 36</b></p>
<p> </p>
<p>5.1</p>
<p> </p>
<p>RequestCurrentPowertrainDiagnosticData ($01) ........................................... 36</p>
<p> </p>
<p>5.1.1</p>
<p> </p>
<p>Functionality .................................................................................................. 36</p>
<p> </p>
<p>5.1.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 36</p>
<p> </p>
<p>5.1.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 36</p>
<p> </p>
<p>5.1.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 36</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>8 / 163 </p>
<p>5.1.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 36</p>
<p> </p>
<p>5.2</p>
<p> </p>
<p>RequestPowertrainFreezeFrameData ($02) .................................................. 36</p>
<p> </p>
<p>5.2.1</p>
<p> </p>
<p>Functionality .................................................................................................. 36</p>
<p> </p>
<p>5.2.2</p>
<p> </p>
<p>Implementation Specifics ............................................................................... 37</p>
<p> </p>
<p>5.2.3</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 38</p>
<p> </p>
<p>5.2.4</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 38</p>
<p> </p>
<p>5.2.4.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 38</p>
<p> </p>
<p>5.2.4.2</p>
<p> </p>
<p>GENy ............................................................................................................ 38</p>
<p> </p>
<p>5.3</p>
<p> </p>
<p>RequestEmissionRelatedDTC ($03) .............................................................. 38</p>
<p> </p>
<p>5.3.1</p>
<p> </p>
<p>Functionality .................................................................................................. 38</p>
<p> </p>
<p>5.3.2</p>
<p> </p>
<p>Implementation Specifics ............................................................................... 38</p>
<p> </p>
<p>5.3.3</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 40</p>
<p> </p>
<p>5.3.4</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 40</p>
<p> </p>
<p>5.3.4.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 40</p>
<p> </p>
<p>5.3.4.2</p>
<p> </p>
<p>GENy ............................................................................................................ 41</p>
<p> </p>
<p>5.4</p>
<p> </p>
<p>ClearEmissionRelatedDTC ($04) .................................................................. 41</p>
<p> </p>
<p>5.4.1</p>
<p> </p>
<p>Functionality .................................................................................................. 41</p>
<p> </p>
<p>5.4.2</p>
<p> </p>
<p>Implementation Specifics ............................................................................... 41</p>
<p> </p>
<p>5.4.3</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 41</p>
<p> </p>
<p>5.4.4</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 41</p>
<p> </p>
<p>5.4.4.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 41</p>
<p> </p>
<p>5.4.4.2</p>
<p> </p>
<p>GENy ............................................................................................................ 41</p>
<p> </p>
<p>5.5</p>
<p> </p>
<p>RequestOnBoardMonitorTestResults ($06) ................................................... 41</p>
<p> </p>
<p>5.5.1</p>
<p> </p>
<p>Functionality .................................................................................................. 41</p>
<p> </p>
<p>5.5.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 42</p>
<p> </p>
<p>5.5.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 42</p>
<p> </p>
<p>5.5.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 42</p>
<p> </p>
<p>5.5.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 46</p>
<p> </p>
<p>5.6</p>
<p> </p>
<p>RequestEmissionRelatedDTCsDetectedDuringCurrentOrLastDrivingCycle </p>
<p>($07) ............................................................................................................. 46</p>
<p> </p>
<p>5.6.1</p>
<p> </p>
<p>Functionality .................................................................................................. 46</p>
<p> </p>
<p>5.6.2</p>
<p> </p>
<p>Implementation Specifics ............................................................................... 46</p>
<p> </p>
<p>5.6.3</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 46</p>
<p> </p>
<p>5.6.4</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 47</p>
<p> </p>
<p>5.6.4.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 47</p>
<p> </p>
<p>5.6.4.2</p>
<p> </p>
<p>GENy ............................................................................................................ 47</p>
<p> </p>
<p>5.7</p>
<p> </p>
<p>RequestControlOfOnBoardSystemTestOrComponent ($08) .......................... 47</p>
<p> </p>
<p>5.7.1</p>
<p> </p>
<p>Functionality .................................................................................................. 47</p>
<p> </p>
<p>5.7.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 47</p>
<p> </p>
<p>5.7.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 47</p>
<p> </p>
<p>5.7.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 47</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>9 / 163 </p>
<p>5.7.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 47</p>
<p> </p>
<p>5.8</p>
<p> </p>
<p>RequestVehicleInformation ($09) .................................................................. 47</p>
<p> </p>
<p>5.8.1</p>
<p> </p>
<p>Functionality .................................................................................................. 47</p>
<p> </p>
<p>5.8.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 48</p>
<p> </p>
<p>5.8.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 48</p>
<p> </p>
<p>5.8.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 48</p>
<p> </p>
<p>5.8.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 48</p>
<p> </p>
<p>5.9</p>
<p> </p>
<p>RequestEmissionRelatedDTCsWithPermanentStatus ($0A) ......................... 48</p>
<p> </p>
<p>5.9.1</p>
<p> </p>
<p>Functionality .................................................................................................. 48</p>
<p> </p>
<p>5.9.2</p>
<p> </p>
<p>Implementation Specifics ............................................................................... 48</p>
<p> </p>
<p>5.9.3</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 48</p>
<p> </p>
<p>5.9.4</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 48</p>
<p> </p>
<p>5.9.4.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 48</p>
<p> </p>
<p>5.9.4.2</p>
<p> </p>
<p>GENy ............................................................................................................ 48</p>
<p> </p>
<p>5.10</p>
<p> </p>
<p>DiagnosticSessionControl ($10) .................................................................... 49</p>
<p> </p>
<p>5.10.1</p>
<p> </p>
<p>Functionality .................................................................................................. 49</p>
<p> </p>
<p>5.10.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 49</p>
<p> </p>
<p>5.10.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 49</p>
<p> </p>
<p>5.10.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 49</p>
<p> </p>
<p>5.10.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 51</p>
<p> </p>
<p>5.11</p>
<p> </p>
<p>EcuReset ($11) ............................................................................................. 53</p>
<p> </p>
<p>5.11.1</p>
<p> </p>
<p>Functionality .................................................................................................. 53</p>
<p> </p>
<p>5.11.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 53</p>
<p> </p>
<p>5.11.2.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 53</p>
<p> </p>
<p>5.11.2.2</p>
<p> </p>
<p>GENy ............................................................................................................ 53</p>
<p> </p>
<p>5.12</p>
<p> </p>
<p>ClearDiagnosticInformation ($14) .................................................................. 54</p>
<p> </p>
<p>5.12.1</p>
<p> </p>
<p>Functionality .................................................................................................. 54</p>
<p> </p>
<p>5.12.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 54</p>
<p> </p>
<p>5.12.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 54</p>
<p> </p>
<p>5.12.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 54</p>
<p> </p>
<p>5.12.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 54</p>
<p> </p>
<p>5.13</p>
<p> </p>
<p>ReadDiagnosticInformation ($19) .................................................................. 55</p>
<p> </p>
<p>5.13.1</p>
<p> </p>
<p>Functionality .................................................................................................. 55</p>
<p> </p>
<p>5.13.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 55</p>
<p> </p>
<p>5.13.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 55</p>
<p> </p>
<p>5.13.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 55</p>
<p> </p>
<p>5.13.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 55</p>
<p> </p>
<p>5.14</p>
<p> </p>
<p>ReadDataByIdentifier ($22) ........................................................................... 56</p>
<p> </p>
<p>5.14.1</p>
<p> </p>
<p>Functionality .................................................................................................. 56</p>
<p> </p>
<p>5.14.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 56</p>
<p> </p>
<p>5.14.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 56</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>10 / 163 </p>
<p>5.14.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 56</p>
<p> </p>
<p>5.14.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 57</p>
<p> </p>
<p>5.15</p>
<p> </p>
<p>ReadMemoryByAddress ($23) ...................................................................... 58</p>
<p> </p>
<p>5.15.1</p>
<p> </p>
<p>Functionality .................................................................................................. 58</p>
<p> </p>
<p>5.15.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 58</p>
<p> </p>
<p>5.15.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 58</p>
<p> </p>
<p>5.15.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 58</p>
<p> </p>
<p>5.15.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 58</p>
<p> </p>
<p>5.16</p>
<p> </p>
<p>SecurityAccess ($27) .................................................................................... 59</p>
<p> </p>
<p>5.16.1</p>
<p> </p>
<p>Functionality .................................................................................................. 59</p>
<p> </p>
<p>5.16.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 59</p>
<p> </p>
<p>5.16.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 59</p>
<p> </p>
<p>5.16.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 59</p>
<p> </p>
<p>5.16.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 61</p>
<p> </p>
<p>5.17</p>
<p> </p>
<p>CommunicationControl ($28) ......................................................................... 62</p>
<p> </p>
<p>5.17.1</p>
<p> </p>
<p>Functionality .................................................................................................. 62</p>
<p> </p>
<p>5.17.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 62</p>
<p> </p>
<p>5.17.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 62</p>
<p> </p>
<p>5.17.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 62</p>
<p> </p>
<p>5.17.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 63</p>
<p> </p>
<p>5.18</p>
<p> </p>
<p>ReadDataByPeriodicIdentifier ($2A) .............................................................. 64</p>
<p> </p>
<p>5.18.1</p>
<p> </p>
<p>Functionality .................................................................................................. 64</p>
<p> </p>
<p>5.18.1.1</p>
<p> </p>
<p>Difference between single and multiple UUDT message transmission .......... 64</p>
<p> </p>
<p>5.18.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 68</p>
<p> </p>
<p>5.18.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 68</p>
<p> </p>
<p>5.18.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 68</p>
<p> </p>
<p>5.18.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 69</p>
<p> </p>
<p>5.19</p>
<p> </p>
<p>DynamicallyDefineDataIdentifier ($2C) .......................................................... 70</p>
<p> </p>
<p>5.19.1</p>
<p> </p>
<p>Functionality .................................................................................................. 70</p>
<p> </p>
<p>5.19.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 70</p>
<p> </p>
<p>5.19.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 70</p>
<p> </p>
<p>5.19.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 70</p>
<p> </p>
<p>5.19.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 71</p>
<p> </p>
<p>5.20</p>
<p> </p>
<p>WriteDataByIdentifier ($2E) ........................................................................... 72</p>
<p> </p>
<p>5.20.1</p>
<p> </p>
<p>Functionality .................................................................................................. 72</p>
<p> </p>
<p>5.20.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 72</p>
<p> </p>
<p>5.20.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 72</p>
<p> </p>
<p>5.20.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 72</p>
<p> </p>
<p>5.20.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 72</p>
<p> </p>
<p>5.21</p>
<p> </p>
<p>IoControlByIdentifier ($2F) ............................................................................ 73</p>
<p> </p>
<p>5.21.1</p>
<p> </p>
<p>Functionality .................................................................................................. 73</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>11 / 163 </p>
<p>5.21.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 73</p>
<p> </p>
<p>5.21.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 73</p>
<p> </p>
<p>5.21.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 73</p>
<p> </p>
<p>5.21.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 73</p>
<p> </p>
<p>5.22</p>
<p> </p>
<p>RoutineControlByIdentifier ($31) ................................................................... 74</p>
<p> </p>
<p>5.22.1</p>
<p> </p>
<p>Functionality .................................................................................................. 74</p>
<p> </p>
<p>5.22.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 74</p>
<p> </p>
<p>5.22.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 74</p>
<p> </p>
<p>5.22.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 74</p>
<p> </p>
<p>5.22.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 74</p>
<p> </p>
<p>5.23</p>
<p> </p>
<p>WriteMemoryByAddress ($3D) ...................................................................... 75</p>
<p> </p>
<p>5.23.1</p>
<p> </p>
<p>Functionality .................................................................................................. 75</p>
<p> </p>
<p>5.23.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 75</p>
<p> </p>
<p>5.23.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 75</p>
<p> </p>
<p>5.23.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 75</p>
<p> </p>
<p>5.23.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 75</p>
<p> </p>
<p>5.24</p>
<p> </p>
<p>TesterPresent ($3E) ...................................................................................... 76</p>
<p> </p>
<p>5.24.1</p>
<p> </p>
<p>Functionality .................................................................................................. 76</p>
<p> </p>
<p>5.24.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 76</p>
<p> </p>
<p>5.24.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 76</p>
<p> </p>
<p>5.24.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 76</p>
<p> </p>
<p>5.24.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 76</p>
<p> </p>
<p>5.25</p>
<p> </p>
<p>ControlDTCSetting ($85) ............................................................................... 77</p>
<p> </p>
<p>5.25.1</p>
<p> </p>
<p>Functionality .................................................................................................. 77</p>
<p> </p>
<p>5.25.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 77</p>
<p> </p>
<p>5.25.3</p>
<p> </p>
<p>Configuration Aspects ................................................................................... 77</p>
<p> </p>
<p>5.25.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 77</p>
<p> </p>
<p>5.25.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 77</p>
<p> </p>
<p><b>6</b></p>
<p> </p>
<p><b>Additional features beyond AUTOSAR DCM 3.0 ........................................................ 78</b></p>
<p> </p>
<p>6.1</p>
<p> </p>
<p>Direct Memory Access ................................................................................... 78</p>
<p> </p>
<p>6.1.1</p>
<p> </p>
<p>Functionality .................................................................................................. 78</p>
<p> </p>
<p>6.1.1.1</p>
<p> </p>
<p>AR 4.0 Like Memory Access Interface ........................................................... 78</p>
<p> </p>
<p>6.1.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 78</p>
<p> </p>
<p>6.1.3</p>
<p> </p>
<p>Configuration ................................................................................................. 78</p>
<p> </p>
<p>6.1.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 78</p>
<p> </p>
<p>6.1.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 79</p>
<p> </p>
<p>6.2</p>
<p> </p>
<p>(WWH-)OBD Support .................................................................................... 80</p>
<p> </p>
<p>6.2.1</p>
<p> </p>
<p>Functionality .................................................................................................. 80</p>
<p> </p>
<p>6.2.2</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 80</p>
<p> </p>
<p>6.2.2.1</p>
<p> </p>
<p>Client Type and Service Group to Service Processor Unit Mapping .............. 80</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>12 / 163 </p>
<p>6.2.2.2</p>
<p> </p>
<p>Parallel service execution .............................................................................. 81</p>
<p> </p>
<p>6.2.2.3</p>
<p> </p>
<p>Supported WWH-OBD services..................................................................... 84</p>
<p> </p>
<p>6.2.2.4</p>
<p> </p>
<p>Alternative OBD Interfaces to the DEM ......................................................... 85</p>
<p> </p>
<p>6.2.3</p>
<p> </p>
<p>Configuration ................................................................................................. 86</p>
<p> </p>
<p>6.2.3.1</p>
<p> </p>
<p>CANdela ........................................................................................................ 86</p>
<p> </p>
<p>6.2.3.2</p>
<p> </p>
<p>GENy ............................................................................................................ 87</p>
<p> </p>
<p>6.3</p>
<p> </p>
<p>Multi-Identity Support .................................................................................... 88</p>
<p> </p>
<p>6.3.1</p>
<p> </p>
<p>Functionality .................................................................................................. 88</p>
<p> </p>
<p>6.3.2</p>
<p> </p>
<p>Single Identity Mode ...................................................................................... 88</p>
<p> </p>
<p>6.3.2.1</p>
<p> </p>
<p>Configuration in CANdela .............................................................................. 88</p>
<p> </p>
<p>6.3.2.2</p>
<p> </p>
<p>Configuration in GENy ................................................................................... 88</p>
<p> </p>
<p>6.3.3</p>
<p> </p>
<p>VSG Mode .................................................................................................... 89</p>
<p> </p>
<p>6.3.3.1</p>
<p> </p>
<p>Implementation Limitations ............................................................................ 89</p>
<p> </p>
<p>6.3.3.2</p>
<p> </p>
<p>Configuration in CANdela .............................................................................. 90</p>
<p> </p>
<p>6.3.3.3</p>
<p> </p>
<p>Configuration in GENy ................................................................................... 91</p>
<p> </p>
<p>6.4</p>
<p> </p>
<p>Code Template .............................................................................................. 92</p>
<p> </p>
<p>6.4.1</p>
<p> </p>
<p>Code Template File Structure ........................................................................ 92</p>
<p> </p>
<p>6.4.2</p>
<p> </p>
<p>Editing and Merging of the Code Template .................................................... 93</p>
<p> </p>
<p>6.4.3</p>
<p> </p>
<p>Template (Pseudo-) Implementations of Callback Functions ......................... 93</p>
<p> </p>
<p>6.5</p>
<p> </p>
<p>Support of Unspecified Services.................................................................... 94</p>
<p> </p>
<p>6.5.1</p>
<p> </p>
<p>Functionality .................................................................................................. 94</p>
<p> </p>
<p>6.5.2</p>
<p> </p>
<p>Implementation Specifics and Limitations ...................................................... 97</p>
<p> </p>
<p>6.5.3</p>
<p> </p>
<p>Configuration in CANdela .............................................................................. 97</p>
<p> </p>
<p>6.5.4</p>
<p> </p>
<p>Configuration in GENy ................................................................................... 97</p>
<p> </p>
<p><b>7</b></p>
<p> </p>
<p><b>Overview of all Services handled by DCM .................................................................. 98</b></p>
<p> </p>
<p>7.1</p>
<p> </p>
<p>Implemented PIDs of ServiceId $01 .............................................................. 98</p>
<p> </p>
<p>7.2</p>
<p> </p>
<p>Implemented MIDs of ServiceId $06 .............................................................. 99</p>
<p> </p>
<p>7.3</p>
<p> </p>
<p>Implemented TIDs of ServiceId $08 .............................................................. 99</p>
<p> </p>
<p>7.4</p>
<p> </p>
<p>Implemented VIDs of ServiceId $09 .............................................................. 99</p>
<p> </p>
<p>7.5</p>
<p> </p>
<p>Implemented DIDs of ServiceId $22 ............................................................ 100</p>
<p> </p>
<p>7.6</p>
<p> </p>
<p>Implemented RIDs of ServiceId $31 ............................................................ 100</p>
<p> </p>
<p><b>8</b></p>
<p> </p>
<p><b>API Description .......................................................................................................... 101</b></p>
<p> </p>
<p>8.1</p>
<p> </p>
<p>Interfaces Overview..................................................................................... 101</p>
<p> </p>
<p>8.2</p>
<p> </p>
<p>Services Provided by DCM .......................................................................... 102</p>
<p> </p>
<p>8.2.1</p>
<p> </p>
<p>Dcm_GetSesCtrlType .................................................................................. 102</p>
<p> </p>
<p>8.2.2</p>
<p> </p>
<p>Dcm_GetSecurityLevel ................................................................................ 102</p>
<p> </p>
<p>8.3</p>
<p> </p>
<p>Services Used by DCM ............................................................................... 103</p>
<p> </p>
<p>8.3.1</p>
<p> </p>
<p>Direct Memory Access ................................................................................. 104</p>
<p> </p>
<p>8.3.1.1</p>
<p> </p>
<p>Dcm_CheckMemory .................................................................................... 105</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>13 / 163 </p>
<p>8.3.1.2</p>
<p> </p>
<p>Dcm_ReadMemory ..................................................................................... 107</p>
<p> </p>
<p>8.3.1.3</p>
<p> </p>
<p>Dcm_WriteMemory ...................................................................................... 108</p>
<p> </p>
<p>8.3.2</p>
<p> </p>
<p>Unspecified Service Handling ...................................................................... 108</p>
<p> </p>
<p>8.3.2.1</p>
<p> </p>
<p>Dcm_CheckUnspecifiedService .................................................................. 109</p>
<p> </p>
<p>8.3.2.2</p>
<p> </p>
<p>Dcm_HandleUnspecifiedService ................................................................. 110</p>
<p> </p>
<p>8.3.2.3</p>
<p> </p>
<p>Dcm_PostHandleUnspecifiedService ........................................................... 111</p>
<p> </p>
<p>8.3.3</p>
<p> </p>
<p>Jump To/From FBL ....................................................................................... 111</p>
<p> </p>
<p>8.3.3.1</p>
<p> </p>
<p>Dcm_SetProgConditions ............................................................................. 112</p>
<p> </p>
<p>8.3.3.2</p>
<p> </p>
<p>Dcm_GetProgConditions ............................................................................. 113</p>
<p> </p>
<p>8.3.3.3</p>
<p> </p>
<p>Dcm_EcuStartModeType ............................................................................. 114</p>
<p> </p>
<p>8.3.3.4</p>
<p> </p>
<p>Dcm_ProgConditionsType ........................................................................... 114</p>
<p> </p>
<p>8.4</p>
<p> </p>
<p>Callback Functions ...................................................................................... 115</p>
<p> </p>
<p>8.4.1</p>
<p> </p>
<p>ComManager Callbacks .............................................................................. 115</p>
<p> </p>
<p>8.4.1.1</p>
<p> </p>
<p>Dcm_ComM_NoComModeEntered ............................................................. 115</p>
<p> </p>
<p>8.4.1.2</p>
<p> </p>
<p>Dcm_ComM_SilentComModeEntered ......................................................... 115</p>
<p> </p>
<p>8.4.1.3</p>
<p> </p>
<p>Dcm_ComM_FullComModeEntered ............................................................ 116</p>
<p> </p>
<p>8.4.2</p>
<p> </p>
<p>PduRouter Callbacks ................................................................................... 116</p>
<p> </p>
<p>8.4.2.1</p>
<p> </p>
<p>Dcm_ProvideRxBuffer ................................................................................. 116</p>
<p> </p>
<p>8.4.2.2</p>
<p> </p>
<p>Dcm_RxIndication ....................................................................................... 117</p>
<p> </p>
<p>8.4.2.3</p>
<p> </p>
<p>Dcm_ProvideTxBuffer ................................................................................. 117</p>
<p> </p>
<p>8.4.2.4</p>
<p> </p>
<p>Dcm_TxConfirmation ................................................................................... 118</p>
<p> </p>
<p>8.5</p>
<p> </p>
<p>Service Ports ............................................................................................... 119</p>
<p> </p>
<p>8.5.1</p>
<p> </p>
<p>Client Server Interface ................................................................................. 119</p>
<p> </p>
<p>8.5.1.1</p>
<p> </p>
<p>Provide Ports ............................................................................................... 119</p>
<p> </p>
<p>8.5.1.2</p>
<p> </p>
<p>Require Ports .............................................................................................. 120</p>
<p> </p>
<p>8.5.1.2.1</p>
<p> </p>
<p>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission ................................... 122</p>
<p> </p>
<p>8.5.1.2.2</p>
<p> </p>
<p>&lt;CallPrefix&gt;SessionControl_ChangeIndication ........................................... 123</p>
<p> </p>
<p>8.5.1.2.3</p>
<p> </p>
<p>&lt;CallPrefix&gt;SessionControl_ConfirmationRespPending ............................. 124</p>
<p> </p>
<p>8.5.1.2.4</p>
<p> </p>
<p>&lt;CallPrefix&gt;ComControl_CheckCondition ................................................... 125</p>
<p> </p>
<p>8.5.1.2.5</p>
<p> </p>
<p>&lt;CallPrefix&gt;ResetService_EcuReset .......................................................... 126</p>
<p> </p>
<p>8.5.1.2.6</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckRead .............................. 127</p>
<p> </p>
<p>8.5.1.2.7</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLength ..................................... 127</p>
<p> </p>
<p>8.5.1.2.8</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData ................................................ 128</p>
<p> </p>
<p>8.5.1.2.9</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckWrite............................... 129</p>
<p> </p>
<p>8.5.1.2.10</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteData ................................................ 130</p>
<p> </p>
<p>8.5.1.2.11</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnControlToECU .............................. 131</p>
<p> </p>
<p>8.5.1.2.12</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ResetToDefault ....................................... 132</p>
<p> </p>
<p>8.5.1.2.13</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_FreezeCurrentState ................................. 133</p>
<p> </p>
<p>8.5.1.2.14</p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ShortTermAdjustment .............................. 134</p>
<p> </p>
<p>8.5.1.2.15</p>
<p> </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Start ................................................. 135</p>
<p> </p>
<p>8.5.1.2.16</p>
<p> </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Stop .................................................. 136</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>14 / 163 </p>
<p>8.5.1.2.17</p>
<p> </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_RequestResults ................................ 137</p>
<p> </p>
<p>8.5.1.2.18</p>
<p> </p>
<p>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_GetSeed ....................................... 138</p>
<p> </p>
<p>8.5.1.2.19</p>
<p> </p>
<p>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_CompareKey ................................. 139</p>
<p> </p>
<p>8.5.1.2.20</p>
<p> </p>
<p>&lt;CallPrefix&gt;PidServices_&lt;PID&gt;_GetPIDValue ............................................ 140</p>
<p> </p>
<p>8.5.1.2.21</p>
<p> </p>
<p>&lt;CallPrefix&gt;DTRServices_&lt;MIDTID&gt;_GetDTRValue .................................. 141</p>
<p> </p>
<p>8.5.1.2.22</p>
<p> </p>
<p>&lt;CallPrefix&gt;RequestControlServices_&lt;TID&gt;_RequestControl .................... 142</p>
<p> </p>
<p>8.5.1.2.23</p>
<p> </p>
<p>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_GetInfoTypeValue ........................ 143</p>
<p> </p>
<p>8.5.1.2.24</p>
<p> </p>
<p>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_ReadDataLength .......................... 144</p>
<p> </p>
<p>8.5.1.3</p>
<p> </p>
<p>Implementation Hints for Port Usage ........................................................... 144</p>
<p> </p>
<p><b>9</b></p>
<p> </p>
<p><b>Configuration.............................................................................................................. 146</b></p>
<p> </p>
<p>9.1</p>
<p> </p>
<p>Configuration in DBC File ............................................................................ 146</p>
<p> </p>
<p>9.2</p>
<p> </p>
<p>Configuration with GENy ............................................................................. 147</p>
<p> </p>
<p>9.2.1</p>
<p> </p>
<p>Common GENy usage hints ........................................................................ 147</p>
<p> </p>
<p>9.2.1.1</p>
<p> </p>
<p>Path placeholders ....................................................................................... 147</p>
<p> </p>
<p>9.2.2</p>
<p> </p>
<p>General DCM options .................................................................................. 147</p>
<p> </p>
<p>9.2.3</p>
<p> </p>
<p>CANdelaDiagnosticDocument import options .............................................. 153</p>
<p> </p>
<p>9.2.4</p>
<p> </p>
<p>Diagnostic Protocol Configuration ............................................................... 153</p>
<p> </p>
<p>9.2.5</p>
<p> </p>
<p>Diagnostic Connection Configuration .......................................................... 154</p>
<p> </p>
<p>9.2.6</p>
<p> </p>
<p>Channel Configuration ................................................................................. 155</p>
<p> </p>
<p><b>10</b></p>
<p> </p>
<p><b>AUTOSAR Standard Compliance .............................................................................. 156</b></p>
<p> </p>
<p>10.1</p>
<p> </p>
<p>Deviations ................................................................................................... 156</p>
<p> </p>
<p>10.1.1</p>
<p> </p>
<p>Multiple Protocol Support ............................................................................ 156</p>
<p> </p>
<p>10.1.2</p>
<p> </p>
<p>Compiler abstraction ................................................................................... 156</p>
<p> </p>
<p>10.1.2.1</p>
<p> </p>
<p>Static and Inline Functions........................................................................... 156</p>
<p> </p>
<p>10.2</p>
<p> </p>
<p>Additions/ Extensions .................................................................................. 156</p>
<p> </p>
<p>10.2.1</p>
<p> </p>
<p>Diagnostic Configuration ............................................................................. 156</p>
<p> </p>
<p>10.2.2</p>
<p> </p>
<p>Service $28 Support .................................................................................... 157</p>
<p> </p>
<p>10.2.3</p>
<p> </p>
<p>Multiple UUDT Message Transmission Support .......................................... 157</p>
<p> </p>
<p>10.2.4</p>
<p> </p>
<p>DEM Interface Compatibility ........................................................................ 157</p>
<p> </p>
<p>10.2.5</p>
<p> </p>
<p>Jump into FBL on Request “Programming Session” ($10 $02) .................... 157</p>
<p> </p>
<p>10.2.5.1</p>
<p> </p>
<p>Application implemented activation ............................................................. 157</p>
<p> </p>
<p>10.2.5.2</p>
<p> </p>
<p>AR 4.0 like Jump to/from the FBL ................................................................ 157</p>
<p> </p>
<p>10.3</p>
<p> </p>
<p>Limitations ................................................................................................... 160</p>
<p> </p>
<p><b>11</b></p>
<p> </p>
<p><b>Glossary and Abbreviations ...................................................................................... 161</b></p>
<p> </p>
<p>11.1</p>
<p> </p>
<p>Glossary ...................................................................................................... 161</p>
<p> </p>
<p>11.2</p>
<p> </p>
<p>Abbreviations .............................................................................................. 161</p>
<p> </p>
<p><b>12</b></p>
<p> </p>
<p><b>Contact ........................................................................................................................ 163</b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>15 / 163 </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>16 / 163 </p>
<p>Illustrations </p>
<p>Figure 2-1</p>
<p> </p>
<p>AUTOSAR architecture ............................................................................. 22</p>
<p> </p>
<p>Figure 2-2</p>
<p> </p>
<p>Interfaces to adjacent modules of the DCM .............................................. 23</p>
<p> </p>
<p>Figure 4-1</p>
<p> </p>
<p>Include structure DCM older than version 3.15.00 .................................... 32</p>
<p> </p>
<p>Figure 4-2</p>
<p> </p>
<p>Include structure DCM version 3.15.00 and newer ................................... 33</p>
<p> </p>
<p>Figure 5-1</p>
<p> </p>
<p>Defining an UASID data type .................................................................... 43</p>
<p> </p>
<p>Figure 5-2</p>
<p> </p>
<p>Defining a MIDTID data type ..................................................................... 44</p>
<p> </p>
<p>Figure 5-3</p>
<p> </p>
<p>Defining a MID data type .......................................................................... 45</p>
<p> </p>
<p>Figure 5-4</p>
<p> </p>
<p>Define a MID specific service .................................................................... 46</p>
<p> </p>
<p>Figure 5-5</p>
<p> </p>
<p>CANdelaStudio session timings configuration ........................................... 50</p>
<p> </p>
<p>Figure 5-6</p>
<p> </p>
<p>Session state transitions ........................................................................... 51</p>
<p> </p>
<p>Figure 5-7</p>
<p> </p>
<p>GENy session timing parameters .............................................................. 52</p>
<p> </p>
<p>Figure 5-8</p>
<p> </p>
<p>CANdelaStudio maximum number of DIDs in single request </p>
<p>configuration ............................................................................................. 57</p>
<p> </p>
<p>Figure 5-9</p>
<p> </p>
<p>Security access state transitions ............................................................... 60</p>
<p> </p>
<p>Figure 5-10</p>
<p> </p>
<p>CANdelaStudio security access state configuration .................................. 60</p>
<p> </p>
<p>Figure 5-11</p>
<p> </p>
<p>CANdelaStudio security access level properties configuration .................. 61</p>
<p> </p>
<p>Figure 5-12</p>
<p> </p>
<p>CANdelaStudio: CommunicationControl with fixed communication type </p>
<p>parameter ................................................................................................. 62</p>
<p> </p>
<p>Figure 5-13</p>
<p> </p>
<p>CANdelaStudio: CommunicationControl with fixed communication type </p>
<p>parameter ................................................................................................. 63</p>
<p> </p>
<p>Figure 5-14</p>
<p> </p>
<p>Single UUDT message normal transmission ............................................. 65</p>
<p> </p>
<p>Figure 5-15</p>
<p> </p>
<p>Single UUDT message scheduler overflow ............................................... 66</p>
<p> </p>
<p>Figure 5-16</p>
<p> </p>
<p>Multiple UUDT messages with scheduler overflow .................................... 67</p>
<p> </p>
<p>Figure 5-17</p>
<p> </p>
<p>CANdelaStudio maximum number of DIDs that can be scheduled at the </p>
<p>same time ................................................................................................. 69</p>
<p> </p>
<p>Figure 5-18</p>
<p> </p>
<p>CANdelaStudio maximum number of DynDID reference items ................. 71</p>
<p> </p>
<p>Figure 6-1</p>
<p> </p>
<p>DCM single identity mode ......................................................................... 88</p>
<p> </p>
<p>Figure 6-2</p>
<p> </p>
<p>DCM VSG mode ....................................................................................... 89</p>
<p> </p>
<p>Figure 6-3</p>
<p> </p>
<p>Defining VSGs in CANdelaStudio ............................................................. 90</p>
<p> </p>
<p>Figure 6-4</p>
<p> </p>
<p>Setting a VSG for service in CANdelaStudio ............................................. 91</p>
<p> </p>
<p>Figure 6-5</p>
<p> </p>
<p>Switching DCM in GENy to VSG mode ..................................................... 92</p>
<p> </p>
<p>Figure 6-6</p>
<p> </p>
<p>Unspecified service not supported by the application ................................ 95</p>
<p> </p>
<p>Figure 6-7</p>
<p> </p>
<p>Processing of a supported unspecified service ......................................... 96</p>
<p> </p>
<p>Figure 8-1</p>
<p> </p>
<p>DCM interactions with other BSWs ......................................................... 101</p>
<p> </p>
<p>Figure 9-1</p>
<p> </p>
<p>GENy tool bar – activating generation path dialog .................................. 147</p>
<p> </p>
<p>Figure 9-2</p>
<p> </p>
<p>General configuration ............................................................................. 148</p>
<p> </p>
<p>Figure 9-3</p>
<p> </p>
<p>Diagnostic options configuration ............................................................. 153</p>
<p> </p>
<p>Figure 9-4</p>
<p> </p>
<p>Diagnostic connection configuration ....................................................... 154</p>
<p> </p>
<p>Figure 10-1</p>
<p> </p>
<p>Transition from DCM to FBL ................................................................... 158</p>
<p> </p>
<p>Figure 10-2</p>
<p> </p>
<p>ECU startup sequence (after reprogramming or normal boot) ................. 159</p>
<p> </p>
<p><b> </b></p>
<p><b>Tables </b></p>
<p>Table 1-1 </p>
<p> </p>
<p>History of the document .............................................................................. 6</p>
<p> </p>
<p>Table 1-2 </p>
<p> </p>
<p>Reference documents ................................................................................. 6</p>
<p> </p>
<p>Table 1-3 </p>
<p> </p>
<p>Component history.................................................................................... 20</p>
<p> </p>
<p>Table 3-1 </p>
<p> </p>
<p>Supported SWS features .......................................................................... 24</p>
<p> </p>
<p>Table 3-2 </p>
<p> </p>
<p>Not supported SWS features .................................................................... 24</p>
<p> </p>
<p>Table 3-3 </p>
<p> </p>
<p>Dcm_Init ................................................................................................... 25</p>
<p> </p>
<p>Table 3-4 </p>
<p> </p>
<p>Dcm_InitDiagnosticVariant ........................................................................ 27</p>
<p> </p>
<p>Table 3-5 </p>
<p> </p>
<p>Dcm_TimerTask ........................................................................................ 28</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>17 / 163 </p>
<p>Table 3-6 </p>
<p> </p>
<p>Dcm_StateTask ......................................................................................... 29</p>
<p> </p>
<p>Table 3-7 </p>
<p> </p>
<p>Mapping of service IDs to services ........................................................... 29</p>
<p> </p>
<p>Table 3-8 </p>
<p> </p>
<p>Additionally reported errors to DET ........................................................... 30</p>
<p> </p>
<p>Table 4-1 </p>
<p> </p>
<p>Static files ................................................................................................. 31</p>
<p> </p>
<p>Table 4-2 </p>
<p> </p>
<p>Generated files ......................................................................................... 31</p>
<p> </p>
<p>Table 4-3 </p>
<p> </p>
<p>Compiler abstraction and memory mapping .............................................. 34</p>
<p> </p>
<p>Table 5-1</p>
<p> </p>
<p>Service $01 used service ports ................................................................. 36</p>
<p> </p>
<p>Table 5-2</p>
<p> </p>
<p>Service $02 used DEM APIs ..................................................................... 37</p>
<p> </p>
<p>Table 5-3</p>
<p> </p>
<p>Service $03 used DEM APIs ..................................................................... 38</p>
<p> </p>
<p>Table 5-4</p>
<p> </p>
<p>Service $04 used DEM APIs ..................................................................... 41</p>
<p> </p>
<p>Table 5-5 </p>
<p> </p>
<p>Service $06 used service ports ................................................................. 42</p>
<p> </p>
<p>Table 5-6</p>
<p> </p>
<p>Service $07 used DEM APIs ..................................................................... 46</p>
<p> </p>
<p>Table 5-7</p>
<p> </p>
<p>Service $08 used service ports ................................................................. 47</p>
<p> </p>
<p>Table 5-8</p>
<p> </p>
<p>Service $09 used service ports ................................................................. 48</p>
<p> </p>
<p>Table 5-9</p>
<p> </p>
<p>Service $0A used DEM APIs ..................................................................... 48</p>
<p> </p>
<p>Table 5-10</p>
<p> </p>
<p>Service $10 used service ports ................................................................. 49</p>
<p> </p>
<p>Table 5-11 </p>
<p> </p>
<p>Service $11 used service ports or call-outs ............................................... 53</p>
<p> </p>
<p>Table 5-12 </p>
<p> </p>
<p>Service $11 supported sub-functions ........................................................ 53</p>
<p> </p>
<p>Table 5-13</p>
<p> </p>
<p>Service $14 used DEM APIs ..................................................................... 54</p>
<p> </p>
<p>Table 5-14</p>
<p> </p>
<p>Service $19 used DEM APIs ..................................................................... 55</p>
<p> </p>
<p>Table 5-15</p>
<p> </p>
<p>Service $22 used service ports ................................................................. 56</p>
<p> </p>
<p>Table 5-16</p>
<p> </p>
<p>Service $23 used call-out ports ................................................................. 58</p>
<p> </p>
<p>Table 5-17</p>
<p> </p>
<p>Service $27 used service ports ................................................................. 59</p>
<p> </p>
<p>Table 5-18 </p>
<p> </p>
<p> Security Access Attributes in CANdela ..................................................... 61</p>
<p> </p>
<p>Table 5-19</p>
<p> </p>
<p>Service $28 used service ports ................................................................. 62</p>
<p> </p>
<p>Table 5-20</p>
<p> </p>
<p>Service $2A used service ports ................................................................. 68</p>
<p> </p>
<p>Table 5-21</p>
<p> </p>
<p>Service $2C used call-out ports ................................................................ 70</p>
<p> </p>
<p>Table 5-22</p>
<p> </p>
<p>Service $2E used service ports ................................................................. 72</p>
<p> </p>
<p>Table 5-23</p>
<p> </p>
<p>Service $2F used service ports ................................................................. 73</p>
<p> </p>
<p>Table 5-24</p>
<p> </p>
<p>Service $31 used service ports ................................................................. 74</p>
<p> </p>
<p>Table 5-25</p>
<p> </p>
<p>Service $3D used call-out ports ................................................................ 75</p>
<p> </p>
<p>Table 5-26</p>
<p> </p>
<p>Service $85 used DEM APIs ..................................................................... 77</p>
<p> </p>
<p>Table 6-1 </p>
<p> </p>
<p>Diagnostic protocol firewalling and diagnostic processor unit </p>
<p>assignement ............................................................................................. 81</p>
<p> </p>
<p>Table 6-2 </p>
<p> </p>
<p>(WWH-)OBD and UDS service collision matrix ......................................... 83</p>
<p> </p>
<p>Table 6-3 </p>
<p> </p>
<p>Standard and OBD addon DEM API mapping ........................................... 86</p>
<p> </p>
<p>Table 6-4 </p>
<p> </p>
<p>DCM application code template files ......................................................... 93</p>
<p> </p>
<p>Table 7-1 </p>
<p> </p>
<p>Service $01 internally handled PIDs ......................................................... 98</p>
<p> </p>
<p>Table 7-2 </p>
<p> </p>
<p>Service $06 internally handled MIDs ......................................................... 99</p>
<p> </p>
<p>Table 7-3 </p>
<p> </p>
<p>Service $08 internally handled TIDs ......................................................... 99</p>
<p> </p>
<p>Table 7-4 </p>
<p> </p>
<p>Service $09 internally handled VIDs ......................................................... 99</p>
<p> </p>
<p>Table 7-5 </p>
<p> </p>
<p>Service $22 internally handled DIDs ....................................................... 100</p>
<p> </p>
<p>Table 7-6 </p>
<p> </p>
<p>Service $31 internally handled RIDs ....................................................... 100</p>
<p> </p>
<p>Table 8-1 </p>
<p> </p>
<p>Dcm_SessionCtrlType ............................................................................ 102</p>
<p> </p>
<p>Table 8-2 </p>
<p> </p>
<p>Dcm_GetSecurityLevel ........................................................................... 102</p>
<p> </p>
<p>Table 8-3 </p>
<p> </p>
<p>Services used by the DCM ..................................................................... 104</p>
<p> </p>
<p>Table 8-4 </p>
<p> </p>
<p>Services beyond AUTOSAR used by the DCM ....................................... 104</p>
<p> </p>
<p>Table 8-5 </p>
<p> </p>
<p>Dcm_CheckMemory ............................................................................... 106</p>
<p> </p>
<p>Table 8-6 </p>
<p> </p>
<p>Dcm_ReadMemory ................................................................................. 107</p>
<p> </p>
<p>Table 8-7 </p>
<p> </p>
<p>Dcm_WriteMemory ................................................................................. 108</p>
<p> </p>
<p>Table 8-8 </p>
<p> </p>
<p>Dcm_CheckUnspecifiedService .............................................................. 109</p>
<p> </p>
<p>Table 8-9 </p>
<p> </p>
<p>Dcm_HandleUnspecifiedService.............................................................. 111</p>
<p> </p>
<p>Table 8-10 </p>
<p> </p>
<p>Dcm_PostHandleUnspecifiedService ...................................................... 111</p>
<p> </p>
<p>Table 8-11 </p>
<p> </p>
<p>Dcm_SetProgConditions ........................................................................ 112</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>18 / 163 </p>
<p>Table 8-12 </p>
<p> </p>
<p>Dcm_GetProgConditions ........................................................................ 113</p>
<p> </p>
<p>Table 8-13 </p>
<p> </p>
<p>Dcm_EcuStartModeType ........................................................................ 114</p>
<p> </p>
<p>Table 8-14 </p>
<p> </p>
<p>Dcm_ProgConditionsType ...................................................................... 114</p>
<p> </p>
<p>Table 8-15 </p>
<p> </p>
<p>Dcm_ComM_NoComModeEntered ........................................................ 115</p>
<p> </p>
<p>Table 8-16 </p>
<p> </p>
<p>Dcm_ComM_SilentComModeEntered .................................................... 115</p>
<p> </p>
<p>Table 8-17 </p>
<p> </p>
<p>Dcm_ComM_FullComModeEntered ....................................................... 116</p>
<p> </p>
<p>Table 8-18 </p>
<p> </p>
<p>Dcm_ProvideRxBuffer ............................................................................ 116</p>
<p> </p>
<p>Table 8-19 </p>
<p> </p>
<p>Dcm_RxIndication .................................................................................. 117</p>
<p> </p>
<p>Table 8-20 </p>
<p> </p>
<p>Dcm_ProvideTxBuffer ............................................................................. 117</p>
<p> </p>
<p>Table 8-21 </p>
<p> </p>
<p>Dcm_TxConfirmation .............................................................................. 118</p>
<p> </p>
<p>Table 8-22 </p>
<p> </p>
<p>Provide Ports on BSW module side ........................................................ 119</p>
<p> </p>
<p>Table 8-23 </p>
<p> </p>
<p>Require Ports on BSW module side ........................................................ 120</p>
<p> </p>
<p>Table 8-24 </p>
<p> </p>
<p>Require Ports beyond AUTOSAR on BSW module side, ComControl ..... 121</p>
<p> </p>
<p>Table 8-25 </p>
<p> </p>
<p>Require Ports beyond AUTOSAR on BSW module side, OBD ................ 121</p>
<p> </p>
<p>Table 8-26 </p>
<p> </p>
<p>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission .............................. 122</p>
<p> </p>
<p>Table 8-27 </p>
<p> </p>
<p>&lt;CallPrefix&gt;SessionControl_ChangeIndication ....................................... 123</p>
<p> </p>
<p>Table 8-28 </p>
<p> </p>
<p>&lt;CallPrefix&gt;SessionControl_ConfirmationRespPending ......................... 124</p>
<p> </p>
<p>Table 8-29 </p>
<p> </p>
<p>&lt;CallPrefix&gt;ComControl_CheckCondition .............................................. 125</p>
<p> </p>
<p>Table 8-30 </p>
<p> </p>
<p>&lt;CallPrefix&gt;ResetService_EcuReset ...................................................... 126</p>
<p> </p>
<p>Table 8-31 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckRead .......................... 127</p>
<p> </p>
<p>Table 8-32 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLength ................................ 127</p>
<p> </p>
<p>Table 8-33 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData ........................................... 128</p>
<p> </p>
<p>Table 8-34 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckWrite .......................... 129</p>
<p> </p>
<p>Table 8-35 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteData ........................................... 130</p>
<p> </p>
<p>Table 8-36 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnControlToECU .......................... 131</p>
<p> </p>
<p>Table 8-37 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ResetToDefault ................................... 132</p>
<p> </p>
<p>Table 8-38 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_FreezeCurrentState ............................ 133</p>
<p> </p>
<p>Table 8-39 </p>
<p> </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ShortTermAdjustment ......................... 134</p>
<p> </p>
<p>Table 8-40 </p>
<p> </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Start ............................................. 135</p>
<p> </p>
<p>Table 8-41 </p>
<p> </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Stop ............................................. 136</p>
<p> </p>
<p>Table 8-42 </p>
<p> </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_RequestResults ........................... 137</p>
<p> </p>
<p>Table 8-43</p>
<p> </p>
<p>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_GetSeed ................................... 138</p>
<p> </p>
<p>Table 8-44</p>
<p> </p>
<p>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_CompareKey ............................ 139</p>
<p> </p>
<p>Table 8-45 </p>
<p> </p>
<p>&lt;CallPrefix&gt;PidServices_&lt;PID&gt;_GetPIDValue ....................................... 140</p>
<p> </p>
<p>Table 8-46 </p>
<p> </p>
<p>&lt;CallPrefix&gt;PidServices_&lt;MIDTID&gt;_GetDTRValue ............................... 141</p>
<p> </p>
<p>Table 8-47</p>
<p> </p>
<p>&lt;CallPrefix&gt;RequestControlServices_&lt;TID&gt;_RequestControl ................ 142</p>
<p> </p>
<p>Table 8-48 </p>
<p> </p>
<p>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_GetInfoTypeValue .................... 143</p>
<p> </p>
<p>Table 8-49 </p>
<p> </p>
<p>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_ReadDataLength ..................... 144</p>
<p> </p>
<p>Table 9-1 </p>
<p> </p>
<p>Data base attributes ................................................................................ 146</p>
<p> </p>
<p>Table 11-1 </p>
<p> </p>
<p>Glossary ................................................................................................. 161</p>
<p> </p>
<p>Table 11-2 </p>
<p> </p>
<p>Abbreviations .......................................................................................... 162</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>19 / 163 </p>
<p>Component History </p>
<p><b>Component </b></p>
<p><b>Version </b></p>
<p><b>New Features </b></p>
<p>3.00 </p>
<p>Creation. </p>
<p>3.01 </p>
<p>RAM/ROM optimizations and new configuration structure. </p>
<p>3.02 </p>
<p>RAM/ROM optimizations and new configuration structure. </p>
<p>3.03 </p>
<p>Full Link-time support, improvements, new features (see component header </p>
<p>file history) </p>
<p>3.04 </p>
<p>Support for NvM, IoHwAb, FBL, and VPM modules. </p>
<p>3.05 </p>
<p>Direct access to constants and A2L imported symbols. </p>
<p>3.06 </p>
<p>Direct access to fingerprint data. </p>
<p>Multi-tester environment parallel request support. </p>
<p>3.07 </p>
<p>Minor changes and fixes only </p>
<p>3.08 </p>
<p>Security access delay time with NVRAM storage </p>
<p>Support for service $A0 (PassiveMode) </p>
<p>3.09 </p>
<p>Automatic fingerprint and meta data OEM specific DID detection. </p>
<p>Allow reduction of the CPU load by limitation of the DEM API iterations for </p>
<p>sub-functions $02, $0A and $0F. </p>
<p>Call-back name for services: $22, $27, $2A, $2E, $2F and $31 are </p>
<p>configurable </p>
<p>All service port prefixes are now depended on the RTE availability in the </p>
<p>system. </p>
<p>3.10 </p>
<p>Support for fingerprint write-operation. </p>
<p>Support of delayed ECU reset operation. </p>
<p>Introducing new compiler abstraction keyword “STATIC_INLINE”. </p>
<p>3.11 </p>
<p>Improved memory access service optimization support by memory block </p>
<p>combination, skipping irrelevant in between gap space. </p>
<p>“STATIC_INLINE” renamed to “LOCAL_INLINE” as proposed by AR 4.0. </p>
<p>3.12 </p>
<p>Support for legislated OBD services. </p>
<p>Support for multi-configuration variants. </p>
<p>DirectMemoryAccess (services $23 and $3D) interfaces as proposed in AR </p>
<p>4.0). </p>
<p>3.15 </p>
<p>Service $31 (RoutineControl) service port extended to support dynamic </p>
<p>response length. </p>
<p>4.00 </p>
<p>Support for ISO14229-1 2009 </p>
<p>Generic memory access (without range check in DCM) </p>
<p>4.01 </p>
<p>Support for WWH-OBD (ISO 27145–2 and -3) </p>
<p>Support for multi variant handling on WWH-OBD/OBD2 and their sub-</p>
<p>services. </p>
<p>4.02 </p>
<p>Support for OBD DEM add-on. </p>
<p>4.03 </p>
<p>Support user-defined services. </p>
<p>Support unspecified services. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>20 / 163 </p>
<p><b>Component </b></p>
<p><b>Version </b></p>
<p><b>New Features </b></p>
<p>Support ECU reset user defined sub-functions. </p>
<p>4.04 </p>
<p>Support for periodic responses type 1 (USDT). </p>
<p>Minor run-time and code optimizations. </p>
<p>4.05 </p>
<p>Real split task concept. </p>
<p>FBL interaction as proposed in AR 4.0. </p>
<p>BswM interaction as proposed in AR 3.2 </p>
<p>4.06 </p>
<p>Update to comply with newest ISO 14229-1 04-2010 specification </p>
<p>Table 1-3  </p>
<p>Component history </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>21 / 163 </p>
<p><b>2 </b></p>
<p><b>Introduction </b></p>
<p>This document describes the functionality, API and configuration of the AUTOSAR BSW </p>
<p>module DCM as specified in [1].  </p>
<p> </p>
<p><b>Supported AUTOSAR Release*: </b></p>
<p>3 </p>
<p><b>Supported Configuration Variants: </b></p>
<p>pre-compile and link-time </p>
<p><b>Vendor ID: </b></p>
<p>DCM_VENDOR_ID </p>
<p>30 decimal </p>
<p>(= </p>
<p>Vector-Informatik, </p>
<p>according to HIS) </p>
<p><b>Module ID: </b></p>
<p>DCM_MODULE_ID   </p>
<p>$35 </p>
<p>(according to ref. [4]) </p>
<p>* For the precise AUTOSAR Release 3.x please see the release specific documentation.  </p>
<p> </p>
<p>Autosar DCM is a software component that handles: </p>
<p>- </p>
<p>the diagnostic communication between the tester and the ECUs application; </p>
<p>- </p>
<p>analyzes and interprets the diagnostic communication protocol UDS based on ISO </p>
<p>14229 ([5]); </p>
<p>- </p>
<p>implements the handling of all UDS service, providing abstract interface to the </p>
<p>application by hiding all protocol specifics; </p>
<p>- </p>
<p>analyzes and interprets the diagnostic communication protocol OBD based on ISO </p>
<p>15765-4 ([6]) and ISO 15031-5 ([7]); </p>
<p>- </p>
<p>implements the handling of all OBD service, providing abstract interface to the </p>
<p>application by hiding all protocol specifics; </p>
<p>- </p>
<p>provides a built in handling of the fault memory manager (DEM) data acquisition; </p>
<p>- </p>
<p>provides service execution precondition validation and state management (i.e. </p>
<p>diagnostic sessions and security access); </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>All <i>Italic </i>symbols are hyperlinks to the locally described API section. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>22 / 163 </p>
<p><b>2.1 </b></p>
<p><b>Architecture Overview </b></p>
<p>The following figure shows where the DCM is located in the AUTOSAR architecture. </p>
<p> </p>
<p> </p>
<p>Figure 2-1 </p>
<p>AUTOSAR architecture </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>23 / 163 </p>
<p>The next figure shows the interfaces to adjacent modules of the  DCM. These interfaces </p>
<p>are described in chapter 7.1.  </p>
<p>FR </p>
<p>CAN IF</p>
<p>FR IF</p>
<p>LIN IF</p>
<p>LI TP</p>
<p>CAN TP</p>
<p>DCM</p>
<p>FR TP</p>
<p>LIN TP</p>
<p>RTE</p>
<p>DEM</p>
<p>CAN IF</p>
<p>FR IF</p>
<p>LIN IF</p>
<p>PDU R</p>
<p> </p>
<p>Figure 2-2 </p>
<p>Interfaces to adjacent modules of the DCM </p>
<p>Applications do not access the services of the BSW modules directly. They use the service </p>
<p>ports provided by the BSW modules via the RTE. The service ports provided by the DCM </p>
<p>are listed in chapter 8.5 and are defined in [1]. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>24 / 163 </p>
<p><b>3 </b></p>
<p><b>Functional Description </b></p>
<p><b>3.1 </b></p>
<p><b>Features </b></p>
<p>The features listed in this chapter cover the complete functionality specified in [1]. </p>
<p>The  &quot;supported&quot; and  &quot;not  supported&quot; features  are  presented  in  the  following  two  tables. </p>
<p>For further information of not supported features also see chapter 10. </p>
<p> </p>
<p>The following features described in [1] are supported: </p>
<p><b>Feature </b></p>
<p>UDS service dispatching and execution (for more details see chapter 5). </p>
<p>Session and security access state management. </p>
<p>Communication activity management. </p>
<p>OBD service dispatching and execution (for more details see chapter 5). </p>
<p>DEM interfaces regarding OBD </p>
<p>Table 3-1  </p>
<p>Supported SWS features </p>
<p>The following features described in [1] are not supported: </p>
<p><b>Feature </b></p>
<p>Limited multiple diagnostic protocols support (i.e. fully parallel handling of OBD, with interruption </p>
<p>only over the DEM interface). </p>
<p>Table 3-2  </p>
<p>Not supported SWS features </p>
<p><b>3.2 </b></p>
<p><b>Initialization </b></p>
<p>At ECU power-on boot (or any reset situation) DCM must be initialized by calling the API </p>
<p>Dcm_Init.  </p>
<p><b>Prototype </b></p>
<p>Single Identity Mode </p>
<p>void <b>Dcm_Init  </b>( void ) </p>
<p>Multi Identity Mode </p>
<p>void <b>Dcm_Init </b>( const Dcm_ConfigType * pConfigPtr ) </p>
<p><b>Parameter </b></p>
<p>pConfigPtr </p>
<p> Pointer to one of the ConfigSets located in Dcm_Lcfg.c. </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>25 / 163 </p>
<p><b>Functional Description </b></p>
<p>If multiple configuration variants are supported, a concrete configuration variant parameter is expected by </p>
<p>this API. The variant objects are located in the Dcm_Lcfg.c file. </p>
<p> </p>
<p>The multi identity or VSG mode are active only if the switch DCM_MULTI_ID_ENABLED in Dcm_Cfg.h is </p>
<p>set to STD_ON. </p>
<p> </p>
<p>If multi identity or VSG mode is active, this API must be called with one of the generated ConfigSets </p>
<p>located in Dcm_Lcfg.c file. </p>
<p><b>Particularities and Limitations </b></p>
<p> </p>
<p>Call context </p>
<p><b>&gt; </b></p>
<p>Only within disabled global interrupt call context. </p>
<p>Table 3-3  </p>
<p>Dcm_Init </p>
<p><b>3.3 </b></p>
<p><b>VSG Configuration Set Pre-Selection </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_InitDiagnosticVariant </b>(Dcm_CfgVariantMaskType VariantMask) </p>
<p><b>Parameter </b></p>
<p>VariantMask</p>
<p> </p>
<p> A bit-mapped value where each bit set represents an active diagnostic </p>
<p>configuration. </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>26 / 163 </p>
<p><b>Functional Description </b></p>
<p>If a combination of multiple diagnostic configurations is supported, the application can activate, additionally </p>
<p>to the base variant, any combination of the other diagnostic configurations that are available.  </p>
<p>Concrete configuration variant parameter values are located in the Dcm_Cfg.h file, with the following </p>
<p>naming convention: DCM_ CFG_VARIANT_&lt;VARIANT_QUALIFIER&gt;. If you use a CDD file for the DCM </p>
<p>configuration, then the variant qualifiers are the qualifier of the vehicle system groups defined in the CDD </p>
<p>file. </p>
<p> </p>
<p>The combination of multiple configuration modes is active only if the switch </p>
<p>DCM_CFG_MULTI_ID_INC_ENABLED in Dcm_Cfg.h is set to STD_ON. </p>
<p> </p>
<p>Note:  </p>
<p><b>If the base variant only shall be supported, this API must be called with a zero VariantMask value. </b></p>
<p><b>DCM always sets the base variant (contains all of the services that do not belong to a concrete </b></p>
<p><b>variant) later, when the Dcm_Init is called. </b></p>
<p><b>Usage Example: </b></p>
<p>void SysInitPowerOn(void) </p>
<p>{ </p>
<p>  /* Compose supported diagnostic configurations */ </p>
<p>  Dcm_CfgVariantMaskType dcmInitMask = 0;  </p>
<p> </p>
<p>  if(&lt;EcuFeatureA_enabled&gt;) </p>
<p>  { </p>
<p>    dcmInitMask |= DCM_CFG_VARIANT_&lt;CDD_VSG_FEATUREA&gt;; </p>
<p>  } </p>
<p> </p>
<p>  if(&lt;EcuFeatureB_enabled&gt;) </p>
<p>  { </p>
<p>    dcmInitMask |= DCM_CFG_VARIANT_&lt;CDD_VSG_FEATUREB&gt;; </p>
<p>  } </p>
<p> </p>
<p>  <b>Dcm_InitDiagnosticVariant</b>(dcmInitMask); </p>
<p> </p>
<p>  /* Init DCM now */ </p>
<p>  <b>Dcm_Init</b>(&amp;&lt;ConfigSet from Dcm_Lcfg.c&gt;); </p>
<p>}</p>
<p><b> </b></p>
<p><b>Particularities and Limitations </b></p>
<p><b>&gt; </b></p>
<p>Must be called only prior the Dcm_Init (ConfigStructPtr) API. </p>
<p><b>&gt; </b></p>
<p>Must be called even if only the base variant shall be supported. </p>
<p>Call context </p>
<p><b>&gt; </b></p>
<p>Only within disabled global interrupt call context. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>27 / 163 </p>
<p>Table 3-4  </p>
<p>Dcm_InitDiagnosticVariant </p>
<p><b>3.4 </b></p>
<p><b>States </b></p>
<p>DCM manages currently the following state machines: </p>
<p>- </p>
<p>Diagnostic session states (managed by service “DiagnosticSessionControl” $10) </p>
<p>- </p>
<p>Security access states (managed by service “SecurityAccess“ $27) </p>
<p>- </p>
<p>Communication activity (managed by the ComManager) </p>
<p><b>3.5 </b></p>
<p><b>Main Functions </b></p>
<p>In  order  to  function  properly,  the  DCM  main-function  (Dcm_MainFunction  [1])  must  be </p>
<p>called periodically in the configured time period (see chapter 9.2) </p>
<p><b>3.5.1 </b></p>
<p><b>Split task functions </b></p>
<p>Dcm_MainFunction is only a container function to calls the two functions  </p>
<p>Dcm_TimerTask  (see chapter 0) and <i>Dcm_StateTask </i>(see chapter 3.5.1.2). Of these two, </p>
<p>only the Dcm_TimerTask depends on a stable cycle time. If you find it difficult to run the </p>
<p>Dcm_MainFunction on a high priority task to ensure the timing behavior, you can optionally </p>
<p>call these two functions instead of Dcm_MainFunction. </p>
<p>This enables you to run the Dcm_TimerTask on a higher priority task to better guarantee </p>
<p>the UDS timing requirements e.g. sending of NRC ‘ResponsePending’. </p>
<p>Please  note,  both  the  Dcm_StateTask  and  Dcm_TimerTask  are  optimized  for  short  run </p>
<p>time, so this option is usually not necessary. </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p><b>&gt; </b></p>
<p>Do <b>not </b>call the Dcm_StateTask on a higher priority task than the Dcm_TimerTask, especially </p>
<p>not if you OS supports task preemption.  </p>
<p><b>&gt; </b></p>
<p>Do <b>not </b>mix calls to Dcm_MainFunction and Dcm_TimerTask / Dcm_StateTask. </p>
<p><b>&gt; </b></p>
<p>You need to call <b>both </b>Dcm_StateTask and Dcm_TimerTask (unless you call </p>
<p>Dcm_MainFunction). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>28 / 163 </p>
<p><b>3.5.1.1 </b></p>
<p><b>Dcm_TimerTask </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_TimerTask </b>(void) </p>
<p><b>Parameter </b></p>
<p>- </p>
<p>- </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>This function drives all time dependent actions of the Dcm: </p>
<p><b>&gt; </b></p>
<p>Tester timeout </p>
<p><b>&gt; </b></p>
<p>P2 / P2* timeout </p>
<p><b>&gt; </b></p>
<p>Timeouts for service implementation </p>
<p><b>Particularities and Limitations </b></p>
<p><b>&gt; </b></p>
<p>Usually, do not call this function directly. Call Dcm_MainFunction instead. </p>
<p><b>&gt; </b></p>
<p>In case of severe runtime constraints, it is possible to call this function (instead of Dcm_MainFunction) </p>
<p>from a higher priority task. To do so will help to keep correct timing behavior e.g. transmission of NRC </p>
<p>‘ResponsePending’. </p>
<p><b>&gt; </b></p>
<p>This function must be called periodically with exactly the configured DcmTaskTime. If you use </p>
<p>Dcm_MainFunction, this is always the case if you call Dcm_MainFunction with proper timing. </p>
<p><b>&gt; </b></p>
<p>This function may not be interrupted by Dcm_StateTask. If you use Dcm_MainFunction, this is always </p>
<p>the case. </p>
<p>Call context </p>
<p><b>&gt; </b></p>
<p>Task context only. Do not call from an interrupt handler. </p>
<p>Table 3-5  </p>
<p>Dcm_TimerTask </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>29 / 163 </p>
<p><b>3.5.1.2 </b></p>
<p><b>Dcm_StateTask </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_StateTask </b>(void) </p>
<p><b>Parameter </b></p>
<p>- </p>
<p>- </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>This function drives the diagnostic service processing. </p>
<p><b>Particularities and Limitations </b></p>
<p><b>&gt; </b></p>
<p>Usually, do not call this function directly. Call Dcm_MainFunction instead. </p>
<p><b>&gt; </b></p>
<p>In case of severe runtime constraints, it is possible to call this function (instead of Dcm_MainFunction) </p>
<p>from a lower priority task. To do so will not increase processing speed of diagnostic requests, but helps </p>
<p>to meet timing constraints. </p>
<p>Call context </p>
<p><b>&gt; </b></p>
<p>Task context only. Do not call from an interrupt handler. </p>
<p>Table 3-6  </p>
<p>Dcm_StateTask </p>
<p><b>3.6 </b></p>
<p><b>Error Handling </b></p>
<p><b>3.6.1 </b></p>
<p><b>Development Error Reporting </b></p>
<p>Development errors are reported to DET using the service Det_ReportError(), (specified in </p>
<p>[2]), if the pre-compile parameter DCM_DEV_ERROR_DETECT == STD_ON. </p>
<p>The reported DCM ID is $35. </p>
<p>The  reported  service  IDs  identify  the  services  which  are  described  in  [1].  The  following </p>
<p>table presents the service IDs and the related services that were additionally integrated: </p>
<p><b>Service ID </b></p>
<p><b>Service </b></p>
<p>$50 </p>
<p>DcmServiceId_DsdDispatcher </p>
<p>$51 </p>
<p>DcmServiceId_SendResponsePending </p>
<p>$52 </p>
<p>DcmServiceId_ProcessActivity </p>
<p>$53 </p>
<p>DcmServiceId_TriggerTransmit </p>
<p>$54 </p>
<p>DcmServiceId_SendResponse </p>
<p>$55 </p>
<p>DcmServiceId_SendSpontaneousResponse </p>
<p>$56 </p>
<p>DcmServiceId_ReleaseResource </p>
<p>$57 </p>
<p>DcmServiceId_AllocateResource </p>
<p>$58 </p>
<p>DcmServiceId_LockDcm </p>
<p>$59 </p>
<p>DcmServiceId_UnLockDcm </p>
<p>Table 3-7  </p>
<p>Mapping of service IDs to services </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>30 / 163 </p>
<p>Additionally to the error codes, specified in AUTOSAR for DCM, Vector’s implementation of </p>
<p>DCM monitors also the below listed errors: </p>
<p><b>Error Code </b></p>
<p><b>Description </b></p>
<p>$80 </p>
<p>DCM_E_ILLEGAL_STATE_REACHED</p>
<p> </p>
<p>Indicates that an internal state-machine has </p>
<p>reached a non specified state. </p>
<p>$81 </p>
<p>DCM_E_INTERFACE_ILLEGALLY_USED</p>
<p> </p>
<p>Indicates that a service is used under wrong </p>
<p>condition. </p>
<p>$82 </p>
<p>DCM_E_LIB_CONFIG_MISMATCH </p>
<p>Indicates that the component library has been </p>
<p>created with another data type of the </p>
<p>configuration. </p>
<p>Table 3-8  </p>
<p>Additionally reported errors to DET </p>
<p> </p>
<p><b>3.6.2 </b></p>
<p><b>Production Code Error Reporting </b></p>
<p>Production code related errors are not supported by DCM. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>31 / 163 </p>
<p><b>4 </b></p>
<p><b>Integration </b></p>
<p>This chapter gives necessary information for the integration of the MICROSAR DCM into </p>
<p>an application environment of an ECU. </p>
<p><b>4.1 </b></p>
<p><b>Scope of Delivery </b></p>
<p>The delivery of the DCM contains the files which are described in the chapters 4.1.1 and </p>
<p>4.1.2. </p>
<p><b>4.1.1 </b></p>
<p><b>Static Files </b></p>
<p><b>File Name </b></p>
<p><b>Description </b></p>
<p>Dcm.c </p>
<p>This is the implementation source file of the DCM (delivered only for the “pre-</p>
<p>compile” variant).</p>
<p> </p>
<p>Dcm.h </p>
<p>This is the header file containing the APIs of DCM. </p>
<p>Dcm_Cbk.h </p>
<p>This file contains all function prototypes of APIs called by other BSW-C (i.e. Pdu-</p>
<p>R, ComM, etc.).</p>
<p> </p>
<p>Dcm_Types.h </p>
<p>This file contains all data types that shall be visible to the other components </p>
<p>interacting with DCM.</p>
<p> </p>
<p>Dcm.lib </p>
<p>This is the library of DCM (delivered only for the non-“pre-compile” variants e.g. </p>
<p>link-time).</p>
<p> </p>
<p>Table 4-1  </p>
<p>Static files </p>
<p> </p>
<p><b>4.1.2 </b></p>
<p><b>Dynamic Files </b></p>
<p>The dynamic files are generated by the configuration tool GENy. </p>
<p><b>File Name </b></p>
<p><b>Description </b></p>
<p>Dcm_Cfg.h </p>
<p>This file contains all pre-compile configuration settings of DCM (e.g. switches, </p>
<p>constants, etc.). </p>
<p>Dcm_Lcfg.c </p>
<p>This file contains the link-time parameterization of DCM. </p>
<p>Dcm_Lcfg.h </p>
<p>This file contains all link-time parameters declarations and type definitions. </p>
<p>Appl_Dcm.h </p>
<p>Available from DCM 3.15.00, </p>
<p>This file will be generated only if no RTE is available in the system to assure best </p>
<p>compatibility for your system. </p>
<p>Appl_Dcm.c </p>
<p>Available from DCM 3.15.00, </p>
<p>This file will be generated only if no RTE is available in the system to assure best </p>
<p>compatibility for your system. </p>
<p>Rte_Dcm.h </p>
<p>Used until DCM 3.14.00.  </p>
<p>This file will be generated only if no RTE is available in the system to assure best </p>
<p>compatibility for your system. </p>
<p>Table 4-2  </p>
<p>Generated files </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>32 / 163 </p>
<p> </p>
<p><b>4.2 </b></p>
<p><b>Include Structure </b></p>
<p><b>4.2.1 </b></p>
<p><b>For DCM versions older than 3.15.00 </b></p>
<p><b>object Header File Structure</b></p>
<p>BSW</p>
<p>RTE</p>
<p>DCM</p>
<p>DCM Config</p>
<p><b>Dcm.c</b></p>
<p><b>Dem.h</b></p>
<p><b>Det.h</b></p>
<p><b>Dcm.h</b></p>
<p><b>Dcm_Cfg.h</b></p>
<p><b>SchM_Dcm.h</b></p>
<p><b>Dcm_Cbk.h</b></p>
<p><b>ComM_Dcm.h</b></p>
<p><b>Dcm_Lcfg.h</b></p>
<p><b>Rte_Dcm.h</b></p>
<p><b>PduR_Dcm.h</b></p>
<p><b>ComStack_Types.h</b></p>
<p><b>Mcu.h</b></p>
<p><b>Rte_Type.h</b></p>
<p><b>Dcm_Lcfg.c</b></p>
<p><b>Dcm_Types.h</b></p>
<p>«include»</p>
<p>«include»</p>
<p>RTE</p>
<p>available</p>
<p>«include»</p>
<p>RTE NOT</p>
<p>available</p>
<p>«include»</p>
<p>RTE</p>
<p>available</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>RTE</p>
<p>available</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p> </p>
<p>Figure 4-1 </p>
<p>Include structure DCM older than version 3.15.00 </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>33 / 163 </p>
<p><b>4.2.2 </b></p>
<p><b>For DCM version 3.15.00 and newer </b></p>
<p><b>object Header File Structure</b></p>
<p>Without RTE</p>
<p>BSW</p>
<p>With RTE</p>
<p>DCM</p>
<p>DCM Config</p>
<p><b>Dcm.c</b></p>
<p><b>Dem.h</b></p>
<p><b>Det.h</b></p>
<p><b>Dcm.h</b></p>
<p><b>Dcm_Cfg.h</b></p>
<p><b>SchM_Dcm.h</b></p>
<p><b>Dcm_Cbk.h</b></p>
<p><b>ComM_Dcm.h</b></p>
<p><b>Dcm_Lcfg.h</b></p>
<p><b>Rte_Dcm.h</b></p>
<p><b>PduR_Dcm.h</b></p>
<p><b>ComStack_Types.h</b></p>
<p><b>Mcu.h</b></p>
<p><b>Rte_Type.h</b></p>
<p><b>Dcm_Lcfg.c</b></p>
<p><b>Dcm_Types.h</b></p>
<p><b>Appl_Dcm.h</b></p>
<p><b>Appl_Dcm.c</b></p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p>«include»</p>
<p> </p>
<p>Figure 4-2 </p>
<p>Include structure DCM version 3.15.00 and newer </p>
<p>The include structure of DCM is dependent on the availability of RTE in the system. The </p>
<p>affected includes are respectively marked in the figure above. </p>
<p><b>4.3 </b></p>
<p><b>Compiler Abstraction and Memory Mapping  </b></p>
<p>The  objects  (e.g.  variables,  functions,  constants)  are  declared  by  compiler  independent </p>
<p>definitions  –  the  compiler  abstraction  definitions.  Each  compiler  abstraction  definition  is </p>
<p>assigned to a memory section. </p>
<p>The  following  table  contains  the  memory  section  names  and  the  compiler  abstraction </p>
<p>definitions specified for the DCM; and illustrates their assignment among each other. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>34 / 163 </p>
<p><b>Compiler Abstraction </b></p>
<p><b>Definitions </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Memory Mapping </b></p>
<p><b>Sections </b></p>
<p>DCM_CONST </p>
<p>DCM_CODE </p>
<p>DCM_VAR </p>
<p>DCM_START_SEC_CONST_8BIT </p>
<p>DCM_STOP_SEC_CONST_8BIT </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CONST_16BIT </p>
<p>DCM_STOP_SEC_CONST_16BIT </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CONST_32BIT </p>
<p>DCM_STOP_SEC_CONST_32BIT </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM_START_SEC_CONST_UNSPECIFIED </p>
<p>DCM_STOP_SEC_CONST_UNSPECIFIED </p>
<p></p>
<p> </p>
<p> </p>
<p> </p>
<p>START_SEC_VAR_NOINIT_8BIT </p>
<p>STOP_SEC_VAR_NOINIT_8BIT </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>START_SEC_VAR_NOINIT_16BIT </p>
<p>STOP_SEC_VAR_NOINIT_16BIT </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>START_SEC_VAR_NOINIT_32BIT </p>
<p>STOP_SEC_VAR_NOINIT_32BIT </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>START_SEC_VAR_NOINIT_UNSPECIFIED </p>
<p>STOP_SEC_VAR_NOINIT_UNSPECIFIED </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>START_SEC_CODE </p>
<p>STOP_SEC_CODE </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>Table 4-3  </p>
<p>Compiler abstraction and memory mapping </p>
<p><b>4.4 </b></p>
<p><b>Critical Sections </b></p>
<p>To protect internal data structures against unwanted modification, the  DCM uses “Critical </p>
<p>Sections” for blocking concurrent access, such as from lower transport layer and from the </p>
<p>Dcm_MainFunction.  </p>
<p>Dcm_EnterCritical()</p>
<p>marks </p>
<p>the </p>
<p>start </p>
<p>of </p>
<p>a </p>
<p>critical </p>
<p>part </p>
<p>of </p>
<p>the </p>
<p>control </p>
<p>flow, </p>
<p>Dcm_LeaveCritical()</p>
<p>marks the end.  </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>35 / 163 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>It is possible that DCM executes nested internal routines and some or all of them enter </p>
<p>into the critical section again (section nesting). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>Depending on your questionnaire, the delivery you’ve received uses one of the following </p>
<p>methods to handle the critical sections. Look in file Dcm.c section “INCLUDES” for your </p>
<p>chosen solution. </p>
<p><b>&gt; </b> Vector standard library (vstdlib.h is included) </p>
<p><b>&gt; </b> AUTOSAR Schedule Manager (SchM_Dcm.h is included) </p>
<p><b>&gt; </b> Disable interrupts in CAN-Driver (Can.h is included) </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>You must take special care that the component implementing the critical section (e.g. </p>
<p>AUTOSAR Schedule Manager) is already started before the Dcm is run. </p>
<p><b> </b></p>
<p><b> </b></p>
<p>In case of AUTOSAR Schedule Manager, you have to map the DCM critical sections to the </p>
<p>appropriate resource locking method.  DCM supports only the </p>
<p><b>DCM_EXCLUSIVE_AREA_0</b></p>
<p> </p>
<p>and it shall be always mapped to global interrupt disabling, since DCM has always very </p>
<p>short time critical sections. The real critical section duration depends on the performance </p>
<p>of the controller used in your system, but the DCM critical section design restricts the code </p>
<p>within  to  very  few  instructions  and  in  very  rear  cases  contains  (internal)  function  calls, </p>
<p>which usually are inlined. </p>
<p> </p>
<p><b>4.5 </b></p>
<p><b>Considerations Using Request- and ResponseData Pointers in a Call-back </b></p>
<p>DCM is a half-duplex communication module and for memory usage optimization a single </p>
<p>buffer  is  used  for  both  request  and  response  data.  Therefore  if  a  call-back  function </p>
<p>contains  both  “ResponseData”  and  “RequestData”  pointers,  they  may  point  to  different </p>
<p>addresses, but these are still memory locations within the same diagnostic buffer. So if you </p>
<p>start writing the response data, you probably will overwrite the request data. If the request </p>
<p>data is still needed, while writing the response data, you will have to store it into temporary </p>
<p>RAM location in your application software, before starting the write process. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>36 / 163 </p>
<p><b>5 </b></p>
<p><b>Diagnostic Service Implementation </b></p>
<p>The main goal of DCM is to handle the diagnostic protocol services, defined by [5]. The </p>
<p>only task the application has is to provide the required data, to write new data into its </p>
<p>memory, access IO ports, etc. All these application tasks are really ECU specific and have </p>
<p>no dependency to the used diagnostic protocol.  </p>
<p> </p>
<p>The following chapters describe each diagnostic service that DCM handles and the </p>
<p>implementation limitations. </p>
<p><b>5.1 </b></p>
<p><b>RequestCurrentPowertrainDiagnosticData ($01) </b></p>
<p><b>5.1.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers some current values of ECU parameters. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;PidServices_&lt;PID&gt;_GetPIDValue </i></p>
<p>Table 5-1 </p>
<p>Service $01 used service ports </p>
<p><b>5.1.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The  protocol  handling  of  this  service  is  fully  implemented  by  DCM. The  data,  each  PID </p>
<p>reports, will be provided by the application via service calls. </p>
<p>Some of the PIDs are handled within DCM. Refer to chapter <i> 7 Overview of all Services </i></p>
<p><i>handled by DCM </i>for information about if any and which PIDs are handled by DCM for you. </p>
<p><b>5.1.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.1.3.1 </b></p>
<p><b>CANdela </b></p>
<p>The  CDD  file  created  by  CANdelaStudio  shall  contain  all  required  PIDs  (except  the </p>
<p>“supported PID” PIDs). </p>
<p><b>5.1.3.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.2 </b></p>
<p><b>RequestPowertrainFreezeFrameData ($02) </b></p>
<p><b>5.2.1 </b></p>
<p><b>Functionality </b></p>
<p>This  is  a  legislated  OBD  service  that  delivers  any  stored  by  the  fault  memory  module </p>
<p>values of ECU parameters. </p>
<p><b>Used DEM APIs </b></p>
<p>Dem_GetDTCOfFreezeFrameRecord </p>
<p>Dem_GetOBDFreezeFrameData </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>37 / 163 </p>
<p>Table 5-2 </p>
<p>Service $02 used DEM APIs </p>
<p><b>5.2.2 </b></p>
<p><b>Implementation Specifics </b></p>
<p><b>PID $02 </b></p>
<p>For  PID  $02,  DCM  calls  the  DEM  API  Dem_GetDTCOfFreezeFrameRecord,  with  the </p>
<p>following parameters:  </p>
<p><b>&gt; </b> freezeFrameNumber = $00 </p>
<p><b>&gt; </b> DTCorigin = DEM_DTC_ORIGIN_PRIMARY_MEMORY; </p>
<p><b>&gt; </b> DTCkind = DEM_DTC_KIND_EMISSION_REL_DTCS; </p>
<p><b>&gt; </b> DTCpointer = address of the DTC variable in DCM where the result will be stored by the </p>
<p>DEM. </p>
<p>The return value expected by DCM is always DEM_GET_DTCOFFF_OK.  </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The DTC expected by DCM is in the usual 3 byte format as this API returns for the </p>
<p>service $19. DCM extracts by itself the two MSBs. </p>
<p> </p>
<p>Even if no freeze-frame data is stored, the returned DTC must be set by DEM to </p>
<p>$0000. </p>
<p> </p>
<p>A return value other than DEM_GET_DTCOFFF_OK, will invoke NRC $31 </p>
<p>(RequestOutOfRange) or if send together with other PIDs – to a positive response </p>
<p>without the PID $02 data. </p>
<p><b> </b></p>
<p> </p>
<p><b>“Supported PID” PID and data PID </b></p>
<p>If DCM receives a PID other than $02, the availability of the PID and reading of its corresponding </p>
<p>data will be performed by calling the DEM API Dem_GetOBDFreezeFrameData with the following </p>
<p>parameter: </p>
<p><b>&gt; </b> PID = the PID from the request; </p>
<p><b>&gt; </b> ResDataPtr = address to the response buffer of DCM where the PID data shall be </p>
<p>located; </p>
<p><b>&gt; </b> BufferSize = currently available DCM response buffer free space. </p>
<p>The return value expected by DCM is E_OK, if: </p>
<p><b>&gt; </b> the PID is supported by the DEM configuration </p>
<p><b>&gt; </b> the data could be read successfully. </p>
<p>For each successful execution of this API, the BufferSize parameter shall return the real PID data </p>
<p>length written by DEM. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>38 / 163 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>For the “supported PID” PID, the DEM shall return E_OK only for those PIDs that have </p>
<p>at least one bit set in the response data! </p>
<p>A return value other than E_OK is interpreted by DCM as unsupported PID or data </p>
<p>reading failure. In both cases NRC $31 (RequestOutOfRange) will be invoked or if at </p>
<p>least one PID returns OK, a positive response without the E_NOT_OK PIDs will be </p>
<p>sent. </p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>5.2.3 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.2.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.2.4.1 </b></p>
<p><b>CANdela </b></p>
<p>The  CDD  file  created  by  CANdelaStudio  shall  contain  all  required  PIDs  (except  the </p>
<p>“supported PID” PIDs). </p>
<p><b>5.2.4.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.3 </b></p>
<p><b>RequestEmissionRelatedDTC ($03) </b></p>
<p><b>5.3.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers all DTCs with set “confirmed” bit. </p>
<p><b>Used DEM APIs </b></p>
<p>Dem_SetDTCFilter </p>
<p>Dem_GetNumberOfFilteredDTC </p>
<p>Dem_GetNextFilteredDTC </p>
<p>Table 5-3 </p>
<p>Service $03 used DEM APIs </p>
<p><b>5.3.2 </b></p>
<p><b>Implementation Specifics </b></p>
<p>All of the “read DTC by status mask“ OBD services (<i>RequestEmissionRelatedDTC ($03), </i></p>
<p><i>RequestEmissionRelatedDTCsDetectedDuringCurrentOrLastDrivingCycle </i></p>
<p><i>($07), </i></p>
<p><i>RequestEmissionRelatedDTCsWithPermanentStatus ($0A)</i>) are implemented following the </p>
<p>processing flow below: </p>
<p><b>Disabling the record update </b></p>
<p>At the very beginning of the service processing, DCM tries to disable the DTC changes </p>
<p>during the iteration process, by calling the API Dem_DisableDTCRecordUpdate. </p>
<p>The return value expected by DCM is always E_OK. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>39 / 163 </p>
<p>If DEM returns anything else than E_OK, DCM will reject the service execution with NRC </p>
<p>$22 (ConditionsNotCorrect). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>If there is an ongoing processing of service $19 (in parallel), this DEM API will not be </p>
<p>called, for the OBD service again. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Setting the DTC filter for the report </b></p>
<p>DCM sets the DTC filter in DEM calling the DEM API Dem_SetDTCFilter with the following </p>
<p>parameters: </p>
<p><b>&gt; </b> StatusMask =  </p>
<p><b>&gt; </b> $08 - set confirmed bit (for service $03),  </p>
<p><b>&gt; </b> $04 - set pending bit (for service $07)  </p>
<p><b>&gt; </b> $00 – ignore bits (for service $0A), </p>
<p><b>&gt; </b> DTCkind = DEM_DTC_KIND_EMISSION_REL_DTCS; </p>
<p><b>&gt; </b> DTCorigin =  </p>
<p><b>&gt; </b> DEM_DTC_ORIGIN_PRIMARY_MEMORY (for services $03 and $07),  </p>
<p><b>&gt; </b> DEM_DTC_ORIGIN_PERMANENT (for service $0A) </p>
<p><b>&gt; </b> FilterWithSeverity = DEM_FILTER_WITH_SEVERITY_NO; </p>
<p><b>&gt; </b> DTCseverity = DEM_SEVERITY_NO_SEVERITY; </p>
<p><b>&gt; </b> FilterForFDC = DEM_FILTER_FOR_FDC_NO. </p>
<p> </p>
<p>The return value expected by DCM is always DEM_FILTER_ACCEPTED. </p>
<p>If DEM returns anything else than DEM_FILTER_ACCEPTED, DCM will reject the service </p>
<p>execution with NRC $22 (ConditionsNotCorrect). </p>
<p><b>Getting the number of DTCs to be reported </b></p>
<p>Once the concrete DTC filter is set DCM must calculate the expected response length, by </p>
<p>calling the DEM API Dem_GetNumberOfFilteredDTC. </p>
<p>The return value expected by DCM is always E_OK. </p>
<p>If DEM returns anything else than E_OK, DCM will reject the service execution with NRC </p>
<p>$22 (ConditionsNotCorrect). </p>
<p>Since the OBD standard expects to report up to 255 DTCs (only one byte is defined that </p>
<p>contains the number of reported DTCs), DCM will respond negatively with NRC $22 </p>
<p>(ConditionsNotCorrect) if the reported number of DTC returned by DEM exceeds 255. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>40 / 163 </p>
<p>In case the designed diagnostic buffer can not handle the whole response data (only in </p>
<p>case paged-buffer support is not active); DCM will respond negatively with NRC $22 </p>
<p>(ConditionsNotCorrect). </p>
<p><b>Getting the DTCs to be reported </b></p>
<p>Once the concrete DTC filter is set DCM starts to iterate over the DTCs calling the DEM </p>
<p>API Dem_GetNextFilteredDTC for each DTC with the following parameters: </p>
<p><b>&gt; </b> DTC = address of a DCM variable to store the next DTC number into. </p>
<p><b>&gt; </b> DTCstatus = address of a DCM variable to store the DTC’s status. The returned value </p>
<p>for this parameter will not be used by DCM since the response does not contain the </p>
<p>DTC status, but it is kept due to the DEM API standardization. </p>
<p>The return value expected by DCM is DEM_FILTERED_OK and only for the end of </p>
<p>iteration signal - DEM_FILTERED_NO_MATCHING_DTC. </p>
<p>If DEM returns anything else than DEM_FILTERED_OK or </p>
<p>DEM_FILTERED_NO_MATCHING_DTC, DCM will reject the service execution with NRC </p>
<p>$22 (ConditionsNotCorrect) if the paged-buffer option is not used. In case of ongoing </p>
<p>paged-buffer response transmission, DCM will interrupt the transmission. </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The DTC expected by DCM is in the usual 3 byte format as this API returns for the </p>
<p>service $19. DCM extracts by itself the two MSBs. </p>
<p><b> </b></p>
<p> </p>
<p><b>Enabling the record update </b></p>
<p>At the end of the service processing (with positive or negative response, or no response), </p>
<p>DCM </p>
<p>tries </p>
<p>to </p>
<p>enable </p>
<p>the </p>
<p>DTC </p>
<p>changes </p>
<p>again, </p>
<p>by </p>
<p>calling </p>
<p>the </p>
<p>API </p>
<p>Dem_EnableDTCRecordUpdate. </p>
<p>The return value expected by DCM is always E_OK. </p>
<p>DEM shall never return anything else than E_OK, since DCM will not be able to send a </p>
<p>negative response to the tester at this point of time. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>If there is an ongoing processing of service $19 (in parallel), this DEM API will not be </p>
<p>called, for the OBD service in order to avoid record updates during the running DEM </p>
<p>iterations for service $19. </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>5.3.3 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.3.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.3.4.1 </b></p>
<p><b>CANdela </b></p>
<p>The CDD file enables/disables the support of this service. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>41 / 163 </p>
<p><b>5.3.4.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.4 </b></p>
<p><b>ClearEmissionRelatedDTC ($04) </b></p>
<p><b>5.4.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that clears all emission related DTCs. </p>
<p><b>Used DEM APIs </b></p>
<p>Dem_ClearDTC </p>
<p>Table 5-4 </p>
<p>Service $04 used DEM APIs </p>
<p><b>5.4.2 </b></p>
<p><b>Implementation Specifics </b></p>
<p>To  clear  the  OBD  DTCs,  DCM  calls  the  DEM  API  Dem_ClearDTC  with  the  following </p>
<p>parameters: </p>
<p><b>&gt; </b> DTC = $FFFFFF; </p>
<p><b>&gt; </b> DTCkind = DEM_DTC_KIND_ALL_DTCS; </p>
<p><b>&gt; </b> DTCorigin = DEM_DTC_ORIGIN_PRIMARY_MEMORY </p>
<p> </p>
<p>The return value expected by DCM is DEM_CLEAR_OK and only in case the clear </p>
<p>operation takes longer time - DEM_DTC_PENDING. </p>
<p>If DEM returns anything else than DEM_CLEAR_OK or DEM_DTC_PENDING, DCM will </p>
<p>reject the service execution with NRC $22 (ConditionsNotCorrect). </p>
<p> </p>
<p><b>5.4.3 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.4.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.4.4.1 </b></p>
<p><b>CANdela </b></p>
<p>The CDD file enables/disables the support of this service. </p>
<p><b>5.4.4.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.5 </b></p>
<p><b>RequestOnBoardMonitorTestResults ($06) </b></p>
<p><b>5.5.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers monitor specific test results. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>42 / 163 </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;DTRServices_&lt;MIDTID&gt;_GetDTRValue </i></p>
<p>Table 5-5  </p>
<p>Service $06 used service ports </p>
<p><b>5.5.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The protocol handling  of  this  service  is fully  implemented  by  DCM. The  data, each  MID </p>
<p>reports, will be provided by the application via service calls. </p>
<p>Some of the MIDs are handled within DCM. Refer to chapter <i>7 Overview of all Services </i></p>
<p><i>handled by DCM </i>for information about if any and which MIDs are handled by DCM for you. </p>
<p><b>5.5.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.5.3.1 </b></p>
<p><b>CANdela </b></p>
<p>The CDD file completely describes: </p>
<p>- </p>
<p>all available monitor identifier (MID); </p>
<p>- </p>
<p>all available test identifier (MIDTID); </p>
<p>- </p>
<p>the relation between a MID and its MIDTIDs. </p>
<p>GENy reconstructs the above relations using the service $06 response data structure. In </p>
<p>order to be sure that the above information will be correctly interpreted from the CDD file, </p>
<p>please follow the configuration instructions below. </p>
<p><b>Preparation </b></p>
<p>What  is the  content of  a  MID? According to  [6]  each  MID  consists  of  a  list  of  MIDTIDs. </p>
<p>Each MIDTID brings the following information: unit and scaling identifier (UASID) and three </p>
<p>data objects each of two byte in size for: test value, minimum and maximum test limit. </p>
<p>In order to describe the above information in the CDD file the bottom-up approach shall be </p>
<p>taken. Most of the below steps are already performed in the CDDT file. </p>
<p><b>&gt; </b> Define all UASID items you need by defining a packet data type in CANdelaStudio that </p>
<p>contains: </p>
<p><b>&gt; </b> the UASID information byte that must have a constant value (the ID); </p>
<p><b>&gt; </b> the three two byte data objects for the test value, minimum and maximum limit.  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>43 / 163 </p>
<p> </p>
<p>Figure 5-1 </p>
<p>Defining an UASID data type </p>
<p>You  can  optionally  use  also  dedicated  data  types  for  the  three  test  values  (like  shown </p>
<p>above), but DCM will not evaluate their properties, so a simple “hex dump 2 byte” would be </p>
<p>enough. </p>
<p><b>&gt; </b> Define all MIDTID items you need by defining a packet data type in CANdelaStudio that </p>
<p>contains: </p>
<p><b>&gt; </b> the MIDTID data object that must have a constant value (the ID); </p>
<p><b>&gt; </b> a data object of type UASID packet defined in the previous step.  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>44 / 163 </p>
<p> </p>
<p>Figure 5-2 </p>
<p>Defining a MIDTID data type </p>
<p><b>&gt; </b> From the last step you have created all required MIDTIDs for your ECU. Now the MID </p>
<p>specific lists must be defined. To do this define all MID items you need by defining a </p>
<p>packet data type in CANdelaStudio that contains a list of the following data object pairs:  </p>
<p><b>&gt; </b> the MID byte  </p>
<p><b>&gt; </b> The first MID is required to be placed only if it is not already available in </p>
<p>the protocol services like this: </p>
<p>. If the MID is already located in the </p>
<p>protocol service, like this </p>
<p>, skip this step for the first MID. </p>
<p><b>&gt; </b> It is not required that the MID shall have a constant value, but if available </p>
<p>GENy will check if it corresponds to the service specific MID in which the </p>
<p>MID packet is used); </p>
<p><b>&gt; </b> a data object of type MIDTID created above </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>45 / 163 </p>
<p> </p>
<p>Figure 5-3 </p>
<p>Defining a MID data type </p>
<p><b>Service configuration </b></p>
<p>After  the  preparation  steps  are  completed,  you  can  start  with  the  service  definitions  in </p>
<p>CANdelaStudio. Each OBD $06 service is located in a diagnostic instance that specifies </p>
<p>the MID: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>46 / 163 </p>
<p> </p>
<p>Figure 5-4 </p>
<p>Define a MID specific service </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The response shall contain the correct MID data type, corresponding to the MID of the </p>
<p>service. Otherwise DCM will get wrong configuration.  </p>
<p><b> </b></p>
<p> </p>
<p><b>5.5.3.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.6 </b></p>
<p><b>RequestEmissionRelatedDTCsDetectedDuringCurrentOrLastDrivingCycle ($07) </b></p>
<p><b>5.6.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers all DTCs with set “pending” status bit. </p>
<p><b>Used DEM APIs </b></p>
<p>Dem_SetDTCFilter </p>
<p>Dem_GetNextFilteredDTC </p>
<p>Table 5-6 </p>
<p>Service $07 used DEM APIs </p>
<p><b>5.6.2 </b></p>
<p><b>Implementation Specifics </b></p>
<p>Please refer to chapter <i>5.3.2 Implementation Specifics</i>. </p>
<p><b>5.6.3 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>47 / 163 </p>
<p><b>5.6.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.6.4.1 </b></p>
<p><b>CANdela </b></p>
<p>The CDD file enables/disables the support of this service. </p>
<p><b>5.6.4.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.7 </b></p>
<p><b>RequestControlOfOnBoardSystemTestOrComponent ($08) </b></p>
<p><b>5.7.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that starts a routine within the ECU. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;RequestControlServices_&lt;TID&gt;_RequestControl</i></p>
<p> </p>
<p> </p>
<p>Table 5-7 </p>
<p>Service $08 used service ports </p>
<p><b>5.7.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The  protocol  handling  of  this  service  is  fully  implemented  by  DCM.  The  data,  each TID </p>
<p>reports, will be provided by the application via service calls. </p>
<p>Some of the TIDs are handled within DCM. Refer to chapter <i> 7 Overview of all Services </i></p>
<p><i>handled by DCM </i>for information about if any and which TIDs are handled by DCM for you. </p>
<p><b>5.7.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.7.3.1 </b></p>
<p><b>CANdela </b></p>
<p>The  CDD  file  created  by  CANdelaStudio  shall  contain  all  required  TIDs  (except  the </p>
<p>“supported TID” TIDs). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>DCM does not support any request and response data for this service (except for the </p>
<p>“supported TID” TIDs). </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>5.7.3.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.8 </b></p>
<p><b>RequestVehicleInformation ($09) </b></p>
<p><b>5.8.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers some vehicle identification information. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_GetInfoTypeValue </i></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>48 / 163 </p>
<p>Table 5-8 </p>
<p>Service $09 used service ports </p>
<p> </p>
<p><b>5.8.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The  protocol  handling  of  this  service  is  fully  implemented  by  DCM. The  data,  each  VID </p>
<p>reports, will be provided by the application via service calls. </p>
<p>Some of the VIDs are handled within DCM. Refer to chapter <i> 7 Overview of all Services </i></p>
<p><i>handled by DCM </i>for information about if any and which VIDs are handled by DCM for you. </p>
<p><b>5.8.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.8.3.1 </b></p>
<p><b>CANdela </b></p>
<p>The  CDD  file  created  by  CANdelaStudio  shall  contain  all  required  VIDs  (except  the </p>
<p>“supported VID” VIDs). </p>
<p><b>5.8.3.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<p><b>5.9 </b></p>
<p><b>RequestEmissionRelatedDTCsWithPermanentStatus ($0A) </b></p>
<p><b>5.9.1 </b></p>
<p><b>Functionality </b></p>
<p>This is a legislated OBD service that delivers all DTCs with permanent origin. </p>
<p><b>Used DEM APIs </b></p>
<p>Dem_SetDTCFilter </p>
<p>Dem_GetNextFilteredDTC </p>
<p>Table 5-9 </p>
<p>Service $0A used DEM APIs </p>
<p><b>5.9.2 </b></p>
<p><b>Implementation Specifics </b></p>
<p>Please refer to chapter <i>5.3.2 Implementation Specifics</i>. </p>
<p><b>5.9.3 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.9.4 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.9.4.1 </b></p>
<p><b>CANdela </b></p>
<p>The CDD file enables/disables the support of this service. </p>
<p><b>5.9.4.2 </b></p>
<p><b>GENy </b></p>
<p>GENy imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>49 / 163 </p>
<p><b>5.10 DiagnosticSessionControl ($10) </b></p>
<p><b>5.10.1 </b></p>
<p><b>Functionality </b></p>
<p>This service manages the diagnostic session state in the ECU. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission </i></p>
<p><i>&lt;CallPrefix&gt;SessionControl_ChangeIndication </i></p>
<p><i>&lt;CallPrefix&gt;SessionControl_ConfirmationRespPending </i></p>
<p>Table 5-10 </p>
<p>Service $10 used service ports </p>
<p><b>5.10.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.10.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.10.3.1  CANdela </b></p>
<p>The  CDD  file  created  by  CANdelaStudio  shall  contain  all  required  sub-functions  and </p>
<p>session states that represent each diagnostic session. </p>
<p> </p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ</b> </p>
<p>Please, use the built in “Session wizard” in CANdelaStudio to create additional </p>
<p>sessions. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ</b> </p>
<p>Each service shall provide a session transition from all other session states to its own </p>
<p>state. </p>
<p><b> </b></p>
<p> </p>
<p>To  specify  the  session  specific  timings  in  CANdelaStudio,  the  description  fields  of  each </p>
<p>session state shall contain the timing values as shown below (before “{“ and after “}” there </p>
<p>can be any additional text). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>50 / 163 </p>
<p><b> </b></p>
<p>Figure 5-5 </p>
<p>CANdelaStudio session timings configuration </p>
<p>The state group session shall fulfill the following rules: </p>
<p>- </p>
<p>The very first state shall always be the state that represents the “default session” </p>
<p>state. </p>
<p>- </p>
<p>For each state in this group, there shall be exactly one service 0x10 that executes a </p>
<p>state transition into this state. </p>
<p>- </p>
<p>There  shall  be  always  self-state  transitions  definitions  (e.g.  Default-&gt;Default)  in </p>
<p>order to fulfill the session management requirements in [5]. </p>
<p>- </p>
<p>The </p>
<p>state </p>
<p>group </p>
<p>assigned </p>
<p>NRC </p>
<p>shall </p>
<p>always </p>
<p>be </p>
<p>0x7E </p>
<p>(SubFunctioNotSupportedInActiveSession). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>51 / 163 </p>
<p> </p>
<p>Figure 5-6 </p>
<p>Session state transitions </p>
<p>Figure 5-6 shows an example implementation of the rules listed above. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>There shall be exactly one state group defined with semantic “session”. Otherwise the </p>
<p>CDD import in GENy will not be possible. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>5.10.3.2  GENy </b></p>
<p>GENy imports the CDD file content but additionally the session specific timing parameters </p>
<p>will  be  shown.  Usually  these  parameters  are  read-only  but  it  depends  on  the  OEM </p>
<p>configuration requirements and could be also editable: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>52 / 163 </p>
<p> </p>
<p>Figure 5-7 </p>
<p>GENy session timing parameters </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>53 / 163 </p>
<p><b>5.11 EcuReset ($11) </b></p>
<p><b>5.11.1 </b></p>
<p><b>Functionality </b></p>
<p>This service implementation provides the ECU reset functionality within the ECU. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;ResetService_EcuReset </i></p>
<p>Table 5-11  </p>
<p>Service $11 used service ports or call-outs </p>
<p><b>5.11.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The following sub-functions are only supported and completely implemented by DCM. </p>
<p><b>Sub-function Id </b></p>
<p><b>Sub-function Name </b></p>
<p>$01 </p>
<p>HardReset </p>
<p>Table 5-12  </p>
<p>Service $11 supported sub-functions </p>
<p><b>5.11.2.1  CANdela </b></p>
<p>This service shall be available in the CDD file in order to be supported by DCM. </p>
<p> </p>
<p><b>5.11.2.2  GENy </b></p>
<p>GENy  just  imports  the  CDD  file  content.  The  optional  delayed  reset  execution  can  be </p>
<p>configured here (refer to chapter <i>9.2.2General DCM options </i>for more information). If this </p>
<p>setting is not possible, then the OEM does not require it. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>54 / 163 </p>
<p><b>5.12 ClearDiagnosticInformation ($14) </b></p>
<p><b>5.12.1 </b></p>
<p><b>Functionality </b></p>
<p>This service clears the stored fault memory content. </p>
<p><b>Used DEM APIs </b></p>
<p>Dem_ClearDTC </p>
<p>Table 5-13 </p>
<p>Service $14 used DEM APIs  </p>
<p><b>5.12.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.12.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.12.3.1  CANdela </b></p>
<p>This service shall be available in the CDD file in order to be supported by DCM. </p>
<p><b> </b></p>
<p> </p>
<p><b>Caution </b></p>
<p>This service is required, when services $19 and $85 are enabled in order to get a </p>
<p>consistent configuration for the fault-memory support by DCM. </p>
<p><b> </b></p>
<p><b>5.12.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>55 / 163 </p>
<p><b>5.13 ReadDiagnosticInformation ($19) </b></p>
<p><b>5.13.1 </b></p>
<p><b>Functionality </b></p>
<p>This service reads the stored fault memory information using the DEM data access API. </p>
<p><b>Used DEM APIs </b></p>
<p>Refer to chapter <i>8.3 Services Used by DCM </i></p>
<p>Table 5-14 </p>
<p>Service $19 used DEM APIs </p>
<p><b>5.13.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>Currently only the following sub-functions are supported: $01-$15. </p>
<p><b> </b></p>
<p> </p>
<p>Info </p>
<p>Sub-service $05 (ReportDTCSnapshotByRecordNumber) supports only record </p>
<p>number $00 since it is the only one allowed by the legislated OBD standard [6].</p>
<p> </p>
<p><b> </b></p>
<p><b>5.13.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.13.3.1  CANdela </b></p>
<p>This corresponding sub-function shall be available in the CDD file in order to be supported </p>
<p>by DCM. </p>
<p><b> </b></p>
<p> </p>
<p><b>Caution </b></p>
<p>If this service is enabled, services $14 and $85 must be activated too in order to get a </p>
<p>consistent configuration for the fault-memory support by DCM. </p>
<p><b> </b></p>
<p> </p>
<p><b>5.13.3.2  GENy </b></p>
<p>GENy  just  imports  the  CDD  file  content  to  configure  the  sub-function  availability  and </p>
<p>access conditions. </p>
<p>If the ECU has performance issues due to the time consuming service request processing, </p>
<p>you can reduce the CPU load by specifying or reducing the maximum number of DEM API </p>
<p>iterations per Dcm_MainFunction activation. Please refer to chapter <i>9.2.2 </i>for configuration </p>
<p>details. </p>
<p><b> </b></p>
<p> </p>
<p><b>Info</b> </p>
<p>Currently DCM supports both DEM specification versions 2.1.1 and 2.2.1. The adaption </p>
<p>of the module is performed automatically depending on the DEM version available in </p>
<p>your system. </p>
<p><b> </b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>56 / 163 </p>
<p><b>5.14 ReadDataByIdentifier ($22) </b></p>
<p><b>5.14.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  provides  read  access  to  preconfigured  and  marked  by  an  identifier  data </p>
<p>structures within the ECU.  </p>
<p>The  tester may  simultaneously  access  multiple  DIDs  in  a  single  request. The maximum </p>
<p>allowed  DID  list  length  is  configurable  (refer  to <i> 5.14.3  Configuration  Aspects </i> for  more </p>
<p>details). </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckRead</i></p>
<p> </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLength</i></p>
<p> </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData</i></p>
<p> </p>
<p>Table 5-15 </p>
<p>Service $22 used service ports </p>
<p><b>5.14.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The  protocol handling  of this service  is fully  implemented by  DCM. The  data,  each  DID </p>
<p>reports, will be provided by the application via service calls. </p>
<p>In some configurations and OEMs there are DIDs that are handled within DCM. Refer to </p>
<p>the  chapter <i> 6 Additional  features  beyond AUTOSAR DCM  3.0  </i> to  learn more  about this </p>
<p>service  implementation  features  and  to  chapter <i> 7  Overview  of  all  Services  handled  by </i></p>
<p><i>DCM </i>for information about if any and which DIDs are handled by DCM for you. </p>
<p><b>5.14.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.14.3.1  CANdela </b></p>
<p>The data structures and their identifier shall be defined in the CDD file.  </p>
<p>The maximum number of simultaneously accessible DIDs is also located in the CDD file as </p>
<p>shown below: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>57 / 163 </p>
<p> </p>
<p>Figure 5-8 </p>
<p>CANdelaStudio maximum number of DIDs in single request configuration </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If WWH-OBD shall be supported, you have to specify at least 6 DIDs for simultaneous </p>
<p>reading in order to fulfill the corresponding requirement in [10]. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>In case a (WWH-)OBD MID DID shall be defined, please follow the MID definition steps, </p>
<p>described in <i>5.5.3.1 CANdela, </i>with one major difference: no MID shall be placed within the </p>
<p>data packet, just the TIDs and their parameter data objects (e.g. UASID, etc.). </p>
<p> </p>
<p><b>5.14.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>58 / 163 </p>
<p><b>5.15 </b></p>
<p><b>ReadMemoryByAddress ($23) </b></p>
<p><b>5.15.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides read access to preconfigured memory area within the ECU. </p>
<p><b>Used Call-Out Ports </b></p>
<p><i>Dcm_CheckMemory </i>(only if no memory range check is performed by DCM) </p>
<p><i>Dcm_ReadMemory </i>(only if AR 4.0 interface is supported) </p>
<p>Table 5-16 </p>
<p>Service $23 used call-out ports </p>
<p><b>5.15.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM.  </p>
<p>Please refer to chapter <i>6.1.2 Implementation Limitations </i>to get more information about the </p>
<p>direct memory access service. </p>
<p> </p>
<p><b>5.15.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.15.3.1  CANdela </b></p>
<p>Please  refer  to  chapter <i> 6.1.3.1  CANdela </i> to  get  information  about  the  direct  memory </p>
<p>access service. </p>
<p><b>5.15.3.2  GENy </b></p>
<p>Please refer to chapter <i>6.1.3.2 GENy </i>to get information about the direct memory access </p>
<p>service. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>59 / 163 </p>
<p><b>5.16 SecurityAccess ($27) </b></p>
<p><b>5.16.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  manages  the  security  level  of  the  ECU  used  to  constrain  the  diagnostic </p>
<p>access to critical services like writing data in restricted areas. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_GetSeed </i></p>
<p><i>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_CompareKey </i></p>
<p>Table 5-17 </p>
<p>Service $27 used service ports </p>
<p><b>5.16.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM with the following limitations: </p>
<p>If the ECU shall support “power on delay time”, this is not supported for all OEMs due to </p>
<p>missing NVRAM interface for storing the last unlock attempt state. OEM specific solution </p>
<p>for storing the last delay state is available on demand.  </p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ</b> </p>
<p>If the delay state flag can not be read at ECU power on (e.g. corrupt EEPROM) and the </p>
<p>configured value “DelayOnPowerOn” is non-zero, DCM will start the timer to provide </p>
<p>best security protection.  </p>
<p><b> </b></p>
<p><b>5.16.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.16.3.1  CANdela </b></p>
<p>All security levels are defined by their corresponding service sub-function pairs (always a </p>
<p>seed-key pairs) and state definitions in the CDD file. </p>
<p>The state group security access shall fulfill the following rules: </p>
<p>- </p>
<p>The very first state shall always be the state that represents the “locked” state. </p>
<p>- </p>
<p>For each unlocked level state in this group, there shall be exactly one seed-key pair </p>
<p>services </p>
<p>- </p>
<p>The “SendKey” services shall always perform a state transition from any other level </p>
<p>including “locked”) to its own level state. </p>
<p>- </p>
<p>No self-transitions are allowed (LevelX -&gt;LevelX). </p>
<p>- </p>
<p>Any available service 0x10 shall perform a state transition from any unlocked level </p>
<p>to the locked state of the state group security access. </p>
<p>- </p>
<p>The state group assigned NRC shall always be 0x33 (AccessDenied). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>60 / 163 </p>
<p> </p>
<p>Figure 5-9 </p>
<p>Security access state transitions </p>
<p>Figure 5-9 shows an example implementation of the rules listed above. </p>
<p> </p>
<p> </p>
<p>Figure 5-10 </p>
<p>CANdelaStudio security access state configuration </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>There shall be exactly one state group defined with semantic “security”. Otherwise the </p>
<p>CDD import in GENy will not be possible. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>Additionally the level specific properties are configurable by service attributes located on </p>
<p>the corresponding “SendKey” service for the level to be configured: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>61 / 163 </p>
<p> </p>
<p>Figure 5-11 </p>
<p>CANdelaStudio security access level properties configuration </p>
<p> </p>
<p><b>Attribute </b></p>
<p><b>Description </b></p>
<p>MaxAttemptsToDelay </p>
<p>Number of wrong keys until the </p>
<p>&quot;DelayTimeMs&quot; will be activated. </p>
<p>MaxAttemptsToLock </p>
<p>Number of wrong keys after which the ECU </p>
<p>will be locked for ever (is not supported yet). </p>
<p>DelayTimeMs </p>
<p>The time where the ECU will not accept any </p>
<p>request 0x27 (NRC 0x37) </p>
<p>DelayTimeOnPowerOnMs </p>
<p>The time after each power on cycle, where the </p>
<p>ECU will not accept any request 0x27 (NRC </p>
<p>0x37). Will be activated only if prior the </p>
<p>reset/power-down event, the </p>
<p>&quot;MaxAttemptsToDelay&quot; has been reached. </p>
<p>Table 5-18  </p>
<p> Security Access Attributes in CANdela </p>
<p> </p>
<p><b>5.16.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>62 / 163 </p>
<p><b>5.17 CommunicationControl ($28) </b></p>
<p><b>5.17.1 </b></p>
<p><b>Functionality </b></p>
<p>This service manages the communication state of both reception and transmission paths </p>
<p>of the ECU. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;ComControl_CheckCondition </i></p>
<p>Table 5-19 </p>
<p>Service $28 used service ports </p>
<p><b>5.17.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM with the following limitations: </p>
<p>For </p>
<p>the </p>
<p>sub-network </p>
<p>id </p>
<p>parameter </p>
<p>only </p>
<p>the </p>
<p>values </p>
<p>“CurrentSubNetwork” </p>
<p>and </p>
<p>“AllSubNetworks”  are  supported,  because  the  third  type:  “SpecificSubNetworkId”  is  not </p>
<p>possible to be mapped to a physical communication channel. </p>
<p><b>5.17.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.17.3.1  CANdela </b></p>
<p>There </p>
<p>are </p>
<p>two </p>
<p>different </p>
<p>ways </p>
<p>to </p>
<p>describe </p>
<p>the </p>
<p>communication </p>
<p>control </p>
<p>service </p>
<p>in </p>
<p>CANdelaStudio: </p>
<p><b>CommunicationControl with fixed communication type parameter </b></p>
<p> </p>
<p>Figure 5-12 </p>
<p>CANdelaStudio: CommunicationControl with fixed communication type parameter </p>
<p>In the above shown configuration use case DCM will accept only the specified in the CDD </p>
<p>file communication types (contained within the service request). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>63 / 163 </p>
<p><b>CommunicationControl with dynamic communication type parameter </b></p>
<p> </p>
<p>Figure 5-13 </p>
<p>CANdelaStudio: CommunicationControl with fixed communication type parameter </p>
<p>In </p>
<p>the </p>
<p>above </p>
<p>shown </p>
<p>configuration </p>
<p>use </p>
<p>case </p>
<p>DCM </p>
<p>will </p>
<p>accept </p>
<p>any </p>
<p>specified </p>
<p>by </p>
<p>[5] </p>
<p>communication type parameter in the service request, since the CDD file does not contain </p>
<p>any concrete value(s). </p>
<p> </p>
<p><b> </b></p>
<p> </p>
<p><b>Info</b> </p>
<p>Please refer the chapter <i>5.17.2 </i>for the communication type limitations. </p>
<p><b> </b></p>
<p> </p>
<p><b>5.17.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>64 / 163 </p>
<p><b>5.18 ReadDataByPeriodicIdentifier ($2A) </b></p>
<p><b>5.18.1 </b></p>
<p><b>Functionality </b></p>
<p>This service manages the time-scheduler with up to three speeds (slow, medium and fast) </p>
<p>that periodically sends the data identifiers’ content on the communication bus.  </p>
<p>According to the [5] there are two types of response transmission: </p>
<p>- </p>
<p>Type 1: Transmission using a single frame USDT message. </p>
<p>- </p>
<p>Type 2: Transmission using a UUDT message-frame. </p>
<p>The time-scheduler monitors the transmission period of each DID entered by the service </p>
<p>$2A. Once a timeout has been detected a read operation of the corresponding DID will be </p>
<p>executed.  When  the  data  is  completely  written,  a  message  transmission  of  the  above </p>
<p>defined  types  will  be  initiated  and  the  DID  timer  will  be  reloaded  again.  In  some  cases </p>
<p>depending on the CPU load, communication bus load, data access speed, etc. there can </p>
<p>be </p>
<p>multiple </p>
<p>DIDs </p>
<p>waiting </p>
<p>for </p>
<p>data </p>
<p>transmission </p>
<p>unit </p>
<p>to </p>
<p>get </p>
<p>free. </p>
<p>This </p>
<p>will </p>
<p>lead </p>
<p>to </p>
<p>transmission </p>
<p>delays </p>
<p>of </p>
<p>those </p>
<p>DIDs’ </p>
<p>data  content </p>
<p>and </p>
<p>the </p>
<p>periodic </p>
<p>timings </p>
<p>will </p>
<p>shift </p>
<p>(scheduler overflow).  </p>
<p>In case of  transmission type 2, there can be multiple UUDT messages specified for the </p>
<p>periodic transmissions. These will be used as a data queue in case of scheduler overflow </p>
<p>since  there  are  more  data  buffers  available.  The  advantage  of  this  configuration  will  be </p>
<p>noticeable while a buffer is in use (the transmission of the lower network layer is pending): </p>
<p>the  next  waiting  DID  read  operation  can  be  invoked  using  a  buffer  of  another  UUDT </p>
<p>message. </p>
<p><b> </b></p>
<p> </p>
<p><b>Info</b> </p>
<p>If the scheduler executes a read operation on a DID that needs long time to be </p>
<p>processed; no other waiting DID can be processed (read) in parallel even if there is </p>
<p>free buffer for its data. </p>
<p><b> </b></p>
<p><b>5.18.1.1 </b></p>
<p><b>Difference between single and multiple UUDT message transmission </b></p>
<p>The sequence diagrams below depict the main difference using single and multiple UUDT </p>
<p>messages  for  service  $2A  –  the  ECU  response  performance.  If  the  scheduler  (ECU </p>
<p>processing speed) is fast enough to keep the periodic rates without having multiple timeout </p>
<p>events in pending, there will be no difference  in the behavior between ECUs with single </p>
<p>and a with multiple UUDT message. But once the communication message transmission </p>
<p>becomes  the bottleneck  of  the periodic  processing,  the multi-UUDT message  usage  will </p>
<p>have the advantage. </p>
<p>To  simplify  the  examples,  the  DCM  Main-Function  time-period  has  been  selected  to  be </p>
<p>5ms. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>65 / 163 </p>
<p><b>Single UUDT message </b></p>
<p>Let’s assume for the example below the following conditions are met: </p>
<p>- </p>
<p>The ECU has only one DID scheduled </p>
<p>- </p>
<p>The transmission time is shorter than the periodic rate (40ms). </p>
<p>The diagram below depicts the ECU behavior in this case: </p>
<p><b>sd Single UUDT transmission (normal)</b></p>
<p><b>Schedule r</b></p>
<p><b>ReloadTimer</b></p>
<p><b>SendRespons e</b></p>
<p><b>ReadData</b></p>
<p><b>WaitForBuffer</b></p>
<p><b>Timeout</b></p>
<p><b>Monitor</b></p>
<p><b>UUDT transmission</b></p>
<p><b>Activ e</b></p>
<p><b>Idl e</b></p>
<p>ms</p>
<p>0</p>
<p>5</p>
<p>10</p>
<p>15</p>
<p>20</p>
<p>25</p>
<p>30</p>
<p>35</p>
<p>40</p>
<p>45</p>
<p>50</p>
<p>55</p>
<p>60</p>
<p>65</p>
<p>70</p>
<p>75</p>
<p>80</p>
<p>85</p>
<p>90</p>
<p>95100</p>
<p><b>Schedule r</b></p>
<p><b>ReloadTimer</b></p>
<p><b>SendRespons e</b></p>
<p><b>ReadData</b></p>
<p><b>WaitForBuffer</b></p>
<p><b>Timeout</b></p>
<p><b>Monitor</b></p>
<p><b>UUDT transmission</b></p>
<p><b>Activ e</b></p>
<p><b>Idl e</b></p>
<p> </p>
<p>Figure 5-14 </p>
<p>Single UUDT message normal transmission </p>
<p>As you can see there is enough time until the same DID must be read again (the scheduler </p>
<p>has idle state where just the timeout monitoring runs).  </p>
<p>Now let’s see what will happen if there would be another DID, scheduled at the same rate: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>66 / 163 </p>
<p> </p>
<p>Figure 5-15 </p>
<p>Single UUDT message scheduler overflow </p>
<p>In this case immediately after processing the first timeout event the scheduler has found </p>
<p>that the second DID shall be sent too. Since there is no resource (data buffer) to start the </p>
<p>data  reading,  the  scheduler  waits  until  the  current  transmission  is  finished.  Once  this </p>
<p>happens, the second DID can be processed and its response can be sent out. Meanwhile </p>
<p>the  first  DID  time  has  been  expired  and  its  processing  must  now  wait  until  the  pending </p>
<p>transmission is finished. These wait states affect the ECU data report timing. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>67 / 163 </p>
<p><b>Multiple UUDT messages </b></p>
<p>The normal transmission situation (no scheduler overflow) is the same as in case having </p>
<p>only one UUDT message (see Figure 5-14 Single  UUDT  message  normal  transmission). </p>
<p>That is why here will be shown the case where a scheduler overflow occurs. </p>
<p>Let’s assume for this example the following conditions are met: </p>
<p>- </p>
<p>The ECU has three DIDs scheduled at the same time with the same rate </p>
<p>- </p>
<p>The transmission time is shorter than the periodic rate (40ms). </p>
<p>- </p>
<p>The DCM configuration has two UUDT messages for the periodic transmission. </p>
<p>The diagram below depicts the ECU behavior in this case: </p>
<p> </p>
<p>Figure 5-16 </p>
<p>Multiple UUDT messages with scheduler overflow </p>
<p>Here the scheduler detects a timeout for all three DIDs. It starts with the first one, reserving </p>
<p>a  transmission  resource  (data  buffer  and  message).  Once  the  first  DID  processing  is </p>
<p>finished, the scheduler tries to allocate again a transmission resource for the second DID </p>
<p>since  its  time  has expired  too. The  ECU  has  been  configured  to have  two  transmission </p>
<p>resources, so the read operation of the second DID can be immediately executed.  </p>
<p>Now while both UUDT message are still on transmission, the scheduler detects that the </p>
<p>third DID has to be processed too. In this case the scheduler must wait until at least one </p>
<p>UUDT message will get free again (in this case the UUDT_0) before proceeding with the </p>
<p>third DID reading.  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>68 / 163 </p>
<p><b> </b></p>
<p> </p>
<p><b>Caution </b></p>
<p>The order of the UUDT message can vary. It depends on the transmission ability of the </p>
<p>lower layer. DCM uses always the first UUDT message found to be free for the periodic </p>
<p>transmission. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ</b> </p>
<p>- Multiple UUDT message (depending on their count) can improve the service $2A </p>
<p>performance, but can not avoid to 100% the delays of the periodic reading. </p>
<p>- Both static (8 byte) and dynamic (DID data length dependent) UUDT message DLC is </p>
<p>supported by DCM. The type is not configurable, but already pre-set for the concrete </p>
<p>OEM. If static DLC is used, the unused data bytes will be padded with the 0xAA </p>
<p>pattern, to avoid bit stuffing on CAN. </p>
<p><b> </b></p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckRead</i></p>
<p> </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLength</i></p>
<p> </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData</i></p>
<p> </p>
<p>Table 5-20 </p>
<p>Service $2A used service ports </p>
<p><b>5.18.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM with the following limitations: </p>
<p>- </p>
<p>If a UUDT transmission has not been sent (due to a high bus load), the built in DCM </p>
<p>transmission  unit  will  cancel  the  transmission,  but  not  in  the  corresponding  bus </p>
<p>driver (e.g. CanIf). As a result the message still can be sent some time later. </p>
<p>- </p>
<p>The UUDT TTL (time to live) is currently not configurable and set to 100 ms. </p>
<p>- </p>
<p>The transmission type has to be selected at compile time (not link-time capable). </p>
<p>- </p>
<p>A concrete ECU may support either type 1 or type 2 but not both of them within the </p>
<p>same setup. </p>
<p><b>5.18.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.18.3.1  CANdela </b></p>
<p>The data structures and their identifier shall be defined in the CDD file.  </p>
<p>The  maximum  number  of  simultaneously  accessible  DIDs  is  located  in  the  CDD  file  as </p>
<p>shown below: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>69 / 163 </p>
<p> </p>
<p>Figure 5-17 </p>
<p>CANdelaStudio maximum number of DIDs that can be scheduled at the same time </p>
<p><b>5.18.3.2  GENy </b></p>
<p>GENy does import the CDD file content and allows you to configure the scheduler timing </p>
<p>parameters (for fast, medium and slow transmissions) and the periodic transmission type. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>Usually each OEM chooses exactly one of the transmission types, so your GENy </p>
<p>configuration is already preset to use the appropriate transmission type for your ECU. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>70 / 163 </p>
<p><b>5.19 DynamicallyDefineDataIdentifier ($2C) </b></p>
<p><b>5.19.1 </b></p>
<p><b>Functionality </b></p>
<p>This service defines a DID content at run-time, referencing other statically defined DIDs’ </p>
<p>data (or parts of it) and/or memory blocks. </p>
<p> </p>
<p><b>Used Call-Out Ports </b></p>
<p><i>Dcm_CheckMemory </i>(only if no memory range check is performed by DCM and sub-function $02 of service </p>
<p>$2C is supported) </p>
<p>Table 5-21 </p>
<p>Service $2C used call-out ports </p>
<p> </p>
<p><b>5.19.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.19.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.19.3.1  CANdela </b></p>
<p>All dynamically define-able DIDs shall be defined by creating a service $2C instance. </p>
<p>In order to store the referenced items, a definition table will be created in DCM. Its size </p>
<p>shall be configured in the CDD file using the ECU specific attribute as shown below: </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>71 / 163 </p>
<p> </p>
<p>Figure 5-18 </p>
<p>CANdelaStudio maximum number of DynDID reference items </p>
<p>The above example specifies that a dynamically define-able DID can hold up to 5 DID data </p>
<p>references and/or memory ranges. </p>
<p><b>5.19.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>72 / 163 </p>
<p><b>5.20 WriteDataByIdentifier ($2E) </b></p>
<p><b>5.20.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides write access to predefined and marked by identifier data structures </p>
<p>within the ECU. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckWrite</i></p>
<p> </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteData</i></p>
<p> </p>
<p>Table 5-22 </p>
<p>Service $2E used service ports </p>
<p><b>5.20.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The  protocol handling  of this  service  is  fully  implemented by  DCM. The  data,  each  DID </p>
<p>reports, will be provided to the application via service calls. </p>
<p>In some configurations and OEMs there are DIDs that are handled within DCM. Refer to </p>
<p>the  chapter <i> 6 Additional  features  beyond AUTOSAR DCM  3.0  </i> to  learn more  about this </p>
<p>service  implementation  features  and  to  chapter <i> 7  Overview  of  all  Services  handled  by </i></p>
<p><i>DCM  </i>for information about if any and which DIDs are handled by DCM for you. </p>
<p><b>5.20.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.20.3.1  CANdela </b></p>
<p>The data structures and their identifier shall be defined in the CDD file. </p>
<p><b>5.20.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>73 / 163 </p>
<p><b>5.21 IoControlByIdentifier ($2F) </b></p>
<p><b>5.21.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides direct access to the ECUs periphery. </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnControlToECU</i></p>
<p> </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ResetToDefault </i></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_FreezeCurrentState </i></p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ShortTermAdjustment </i></p>
<p>Table 5-23 </p>
<p>Service $2F used service ports </p>
<p><b>5.21.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>According to [5], the parameter definition list contains a parameter availability mask, used </p>
<p>to specify only which parameter(s) of the requested list shall be taken into account. This </p>
<p>feature is currently not supported by DCM and all parameters contained in the request will </p>
<p>be forwarded to the application. </p>
<p>In some configurations and OEMs there are DIDs that are handled within DCM. Refer to </p>
<p>chapter <i>7 Overview of all Services handled by DCM </i>for information about if any and which </p>
<p>DIDs are handled by DCM for you. </p>
<p><b>5.21.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.21.3.1  CANdela </b></p>
<p>The supported control options and data structures with their identifier  shall be defined in </p>
<p>the CDD file. </p>
<p><b>5.21.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>74 / 163 </p>
<p><b>5.22 RoutineControlByIdentifier ($31) </b></p>
<p><b>5.22.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides direct access to routines within the ECUs (e.g. self-test, control of </p>
<p>peripheries, etc.). </p>
<p><b>Used Service Ports </b></p>
<p><i>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Start </i></p>
<p><i>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Stop </i></p>
<p><i>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_RequestResults </i></p>
<p>Table 5-24 </p>
<p>Service $31 used service ports </p>
<p><b>5.22.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The protocol handling of this service is fully implemented by DCM, except the sub-function </p>
<p>execution sequence validation (e.g. prior executing “stop” or “request results” there shall </p>
<p>be send a “start” command). Those sequence rules may not apply to all routines. Instead </p>
<p>the application can implement an own state machine to model the running state of each </p>
<p>routine. If the service execution order is not correct, the appropriate NRC (i.e. 0x24) can </p>
<p>be returned back from the corresponding service port, implemented by the application. </p>
<p>In some configurations and OEMs there are RIDs that are handled within DCM. Refer to </p>
<p>chapter <i>7 Overview of all Services handled by DCM </i>for information about if any and which </p>
<p>RIDs are handled by DCM for you. </p>
<p><b>5.22.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.22.3.1  CANdela </b></p>
<p>The  supported  routine  structures  and  their  identifier,  as  well  the  routine  specific  sub-</p>
<p>functions, shall be defined in the CDD file. </p>
<p><b>5.22.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>75 / 163 </p>
<p><b>5.23 WriteMemoryByAddress ($3D) </b></p>
<p><b>5.23.1 </b></p>
<p><b>Functionality </b></p>
<p>This service provides write access to preconfigured memory area within the ECU. </p>
<p><b>Used Call-Out Ports </b></p>
<p><i>Dcm_CheckMemory </i>(only if no memory range check is performed by DCM) </p>
<p><i>Dcm_WriteMemory </i>(only if AR 4.0 interface is supported) </p>
<p>Table 5-25 </p>
<p>Service $3D used call-out ports </p>
<p><b>5.23.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM.  </p>
<p>Please refer to chapter <i>6.1.2 Implementation Limitations </i>to get more information about the </p>
<p>direct memory access service. </p>
<p>In some configurations and OEMs there are memory ranges that are handled within DCM. </p>
<p>Refer to chapter <i>7 Overview of all Services handled by DCM </i>for information about if any </p>
<p>and which memory ranges are handled by DCM for you. </p>
<p><b>5.23.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.23.3.1  CANdela </b></p>
<p>Please refer to chapter <i> 6.1.3.1 CANdela </i>to get the information about the direct memory </p>
<p>access service. </p>
<p> </p>
<p><b>5.23.3.2  GENy </b></p>
<p>Please refer to chapter <i>6.1.3.2 GENy </i>to get information about the direct memory access </p>
<p>service. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>76 / 163 </p>
<p><b>5.24 TesterPresent ($3E) </b></p>
<p><b>5.24.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  is  only  used  for  keeping  the  current  diagnostic  state  in  the  ECU  active. </p>
<p>Otherwise on lack of diagnostic communication, the ECU will reset all temporary activated </p>
<p>states and functionalities (e.g. diagnostic session, security access, routine execution, etc.) </p>
<p><b>5.24.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is fully implemented by DCM. </p>
<p><b>5.24.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.24.3.1  CANdela </b></p>
<p>This service shall be available in the CDD file. </p>
<p><b>5.24.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>77 / 163 </p>
<p><b>5.25 ControlDTCSetting ($85) </b></p>
<p><b>5.25.1 </b></p>
<p><b>Functionality </b></p>
<p>This  service  manipulates  the  setting  of  the  DTC  in  the  ECU  to  avoid  unnecessary  fault </p>
<p>memory entries (i.e. while the communication is disabled). </p>
<p><b>5.25.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>This service is completely implemented by DCM. </p>
<p><b>Used DEM APIs </b></p>
<p>Dem_DisableDTCStorage </p>
<p>Dem_EnableDTCStorage </p>
<p>Table 5-26 </p>
<p>Service $85 used DEM APIs </p>
<p><b>5.25.3 </b></p>
<p><b>Configuration Aspects </b></p>
<p><b>5.25.3.1  CANdela </b></p>
<p>This service shall be available in the CDD file in order to be supported by DCM. </p>
<p><b> </b></p>
<p> </p>
<p><b>Caution </b></p>
<p>This service is required, when services $19 and $14 are enabled in order to get a </p>
<p>consistent configuration for the fault-memory support by DCM. </p>
<p><b> </b></p>
<p><b>5.25.3.2  GENy </b></p>
<p>GENy just imports the CDD file content. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>78 / 163 </p>
<p><b>6 </b></p>
<p><b>Additional features beyond AUTOSAR DCM 3.0 </b></p>
<p>If </p>
<p>required, </p>
<p>DCM </p>
<p>can </p>
<p>extend </p>
<p>the </p>
<p>application </p>
<p>support </p>
<p>by </p>
<p>implementing </p>
<p>even </p>
<p>more </p>
<p>application tasks. The following chapters describe these extensions. </p>
<p><b>6.1 </b></p>
<p><b>Direct Memory Access </b></p>
<p><b>6.1.1 </b></p>
<p><b>Functionality </b></p>
<p>Even AUTOSAR 3.0 does not support the direct memory access functionality; this  DCM </p>
<p>provides </p>
<p>in </p>
<p>advance </p>
<p>an </p>
<p>implementation </p>
<p>of </p>
<p>the </p>
<p>corresponding </p>
<p>UDS </p>
<p>services </p>
<p>(<i>ReadMemoryByAddress </i></p>
<p><i>($23)</i>, </p>
<p><i>DynamicallyDefineDataIdentifier </i></p>
<p><i>($2C) </i></p>
<p>and </p>
<p><i>WriteMemoryByAddress ($3D)</i>). </p>
<p> </p>
<p>The availability of this feature is OEM specific.  </p>
<p> </p>
<p>DCM </p>
<p>supports </p>
<p>the </p>
<p>following </p>
<p>kind </p>
<p>of </p>
<p>direct </p>
<p>memory </p>
<p>access </p>
<p>interfaces </p>
<p>and </p>
<p>their </p>
<p>implementations: </p>
<p> </p>
<p><b>6.1.1.1 </b></p>
<p><b>AR 4.0 Like Memory Access Interface </b></p>
<p>In some cases, the ECU uses an operating system with virtual address space. This makes </p>
<p>the above described DCM build in memory access not applicable. Therefore DCM offers </p>
<p>an alternative mechanism that gives the application the flexibility to provide the requested </p>
<p>data at certain memory location, resp. to write the requested data to the specified location. </p>
<p>Please refer to the corresponding memory access API description for more details about </p>
<p>the specifics of the interface in chapter <i>8.3.1 Direct Memory Access</i>. </p>
<p> </p>
<p><b>6.1.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>The  valid  format  identifier  bytes  (FID)  are  defined  for  the  ECU,  independently  of  its </p>
<p>memory access services. In other words service $23, $3D and $2C will support the same </p>
<p>FIDs. </p>
<p>If  multiple  configuration  support  is  activated,  the  memory  blocks  will  be  split  down  into </p>
<p>smaller  blocks  that  belong  to  the  same  configuration.  This  leads  to  different  request </p>
<p>acceptance behavior depending on the configuration variant(s) currently active in the ECU. </p>
<p> </p>
<p><b>6.1.3 </b></p>
<p><b>Configuration </b></p>
<p><b>6.1.3.1 </b></p>
<p><b>CANdela </b></p>
<p>The corresponding memory services ($23 and/or $3D) shall be activated. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>79 / 163 </p>
<p><b>6.1.3.2 </b></p>
<p><b>GENy </b></p>
<p>No additional GENy configuration is required. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>80 / 163 </p>
<p><b>6.2 </b></p>
<p><b>(WWH-)OBD Support </b></p>
<p><b>6.2.1 </b></p>
<p><b>Functionality </b></p>
<p>The DCM (WWH-)OBD support features the following important characteristics: </p>
<p>- </p>
<p>Supports all services described in [7] for [6] to be implemented for legislated OBD </p>
<p>(please refer to chapter <i>5 Diagnostic Service Implementation </i>for details about which </p>
<p>services are supported and their implementation specifics). </p>
<p>- </p>
<p>If  the  WWH-OBD  support  is  required,  DCM  implements  all  services  and  their </p>
<p>parameters as described in [5], [9], [10]. </p>
<p>- </p>
<p>Fulfills the requirements specified in [5] regarding OBD too – the reception of any </p>
<p>OBD service id, puts the ECU automatically back into the default session. In case of </p>
<p>WWH-OBD  request  is  received,  it  depends  on  the  tester  type  (i.e.  UDS,  OBD  or </p>
<p>UDS-OBD) whether the requested service will be treated as a WWH-OBD or just </p>
<p>normal  UDS  one  (refer  to <i> 6.2.2.1  Client  Type  and  Service  Group  to  Service </i></p>
<p><i>Processor </i></p>
<p><i>Unit </i></p>
<p><i>Mapping </i></p>
<p>to </p>
<p>get </p>
<p>information </p>
<p>about </p>
<p>the </p>
<p>client </p>
<p>specific </p>
<p>protocol </p>
<p>assignement). </p>
<p>- </p>
<p>Supports parallel execution of (WWH-)OBD and UDS services where possible (see </p>
<p>details below). </p>
<p>- </p>
<p>Supports service execution prioritization where possible (see details below). </p>
<p>- </p>
<p>Automatically  links  the  available  emission  related  (WWH-OBD)  UDS  services  to </p>
<p>their available OBD equivalents (see details below). </p>
<p>- </p>
<p>Diagnostic client specific protocol firewalling – DCM can distinguish between “OBD-</p>
<p>only”,  “UDS-only”  and  “OBD  and  UDS”  connections  (see  configuration  aspect </p>
<p>below). In such a way it can be avoided that  the OBD client would execute UDS </p>
<p>services,  and  at  the  same  time  to  allow  the  service  tool  to  request  both  (WWH-</p>
<p>)OBD and UDS services. </p>
<p>- </p>
<p>Automatic generation of the “availability IDs” (i.e. “supported PID” PID, “supported </p>
<p>MID”  MID,  etc.)  service  port  implementation  with  the  appropriate  response  data, </p>
<p>according to the available service specific identifiers. </p>
<p>- </p>
<p>Faultmemory related PIDs/DIDs are automatically delegated to DEM. </p>
<p>- </p>
<p>Negative response handling according to the [6]. </p>
<p> </p>
<p><b>6.2.2 </b></p>
<p><b>Implementation Limitations </b></p>
<p>DCM  provides  a  powerfull  support  for  (WWH)-OBD  applications,  but  there  are  some </p>
<p>considerations </p>
<p>that </p>
<p>shall </p>
<p>be </p>
<p>taken </p>
<p>into </p>
<p>accout </p>
<p>while </p>
<p>configuring </p>
<p>and </p>
<p>testing </p>
<p>this </p>
<p>functionality. </p>
<p><b>6.2.2.1 </b></p>
<p><b>Client Type and Service Group to Service Processor Unit Mapping  </b></p>
<p>DCM  decides  how  to  proceed  with  an  incomming  diagnostic  request  depending  on  its </p>
<p>service identifier and the client type that sends it. The client types are assigned to each </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>81 / 163 </p>
<p>DCM  connection  in  GENy  (refer  to <i> 9.2.5  Diagnostic  Connection  Configuration </i> for  more </p>
<p>information) </p>
<p>The following mapping will apply: </p>
<p> </p>
<p><b>Client Type </b></p>
<p> </p>
<p><b>Service Group </b></p>
<p><b>(service Id range) </b></p>
<p>UDS </p>
<p>OBD </p>
<p>UDS + OBD </p>
<p>OBD  </p>
<p>(SID in [0x00 – 0x0F]) </p>
<p>No response  </p>
<p>Process as </p>
<p>OBD </p>
<p>Process as </p>
<p>OBD </p>
<p>WWH-OBD </p>
<p>1)</p>
<p> </p>
<p>(SID in [0x14, 0x19, 0x22, 0x31]) </p>
<p>Process as </p>
<p>UDS </p>
<p>Process as </p>
<p>WWH-OBD </p>
<p>Process as </p>
<p>UDS </p>
<p>UDS  </p>
<p>(SID in [any valid UDS SID, </p>
<p>except the WWH-OBD ones]) </p>
<p>Process as </p>
<p>UDS </p>
<p>No response </p>
<p>Process as </p>
<p>UDS </p>
<p>Table 6-1  </p>
<p>Diagnostic protocol firewalling and diagnostic processor unit assignement </p>
<p>1) </p>
<p>This  group  shall  be considered only  if WWH-OBD support  is enabled  (refer to <i> 6.2.3.1 </i></p>
<p><i>CANdela </i>for OBD type detection specifics). If WWH-OBD is not supported, all services of </p>
<p>this group are treated as services of the UDS service group. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Please note that an UDS client, which may request also OBD requests, will not be </p>
<p>promoted to execute WWH-OBD request with high priority like an OBD tester! In other </p>
<p>words such a tester will be interrupted by a connection that was initiated by a pure </p>
<p>OBD tester. But if an “UDS+OBD” tester has requested an OBD service, DCM will not </p>
<p>be able to interrupt it when the pure OBD client tries to request any service to the ECU. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>6.2.2.2 </b></p>
<p><b>Parallel service execution </b></p>
<p>As already mentioned in 6.2.1, DCM supports parallel service execution as well as service </p>
<p>execution prioritization.  </p>
<p>For  the  diagnostic  application  there  are  no  additional  considerations  of  the  parallel  port </p>
<p>execution (i.e. reentrancy or nested call-back iterations) required. </p>
<p> </p>
<p>The matrix below depicts the service dependencies and the DCM handling with respect to </p>
<p>the diagnostic protocol. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>82 / 163 </p>
<p><b>OBD </b></p>
<p><b>(WWH-OBD) </b></p>
<p> </p>
<p> </p>
<p><b>UDS </b></p>
<p>$01 $XX ($22 $F4XX) </p>
<p>($22 $F5XX) </p>
<p>$02 $XX ($19 $05 $00) </p>
<p>$03 ($19 $02) </p>
<p>$04 </p>
<p>($14) </p>
<p>$06 $XX ($22 $F6XX) </p>
<p>($22 $F7XX) </p>
<p>$07 ($19 $02) </p>
<p>$08 $XX ($31 $01 $E0XX) </p>
<p>($31 $01 $E1XX) </p>
<p>$09 $XX ($22 $F8XX) </p>
<p>$0A ($19 $15) </p>
<p>($19 $41) </p>
<p>($19 $42) </p>
<p>$10 [any] </p>
<p></p>
<p>4)</p>
<p>  </p>
<p></p>
<p>4)</p>
<p>  </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p></p>
<p>4)</p>
<p> </p>
<p>$11 [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$14 [any] </p>
<p> </p>
<p> </p>
<p></p>
<p>8)</p>
<p> </p>
<p></p>
<p>7)</p>
<p> </p>
<p></p>
<p>7)</p>
<p> </p>
<p></p>
<p>8)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>7)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>7)</p>
<p> </p>
<p></p>
<p>8)</p>
<p> </p>
<p></p>
<p>8)</p>
<p> </p>
<p>$19 $01 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p>$19 $02 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $03 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $04 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $05 </p>
<p> </p>
<p> </p>
<p></p>
<p>1)</p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $06 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $07 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p>$19 $08 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $09 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $0A </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $0B </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $0C </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $0D </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $0E </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $0F </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $10 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$19 $11 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p>$19 $12 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p></p>
<p>6)</p>
<p> </p>
<p>$19 $13 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $14 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $15 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $41 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$19 $42 </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p></p>
<p>3)</p>
<p> </p>
<p>$22 $F4XX </p>
<p></p>
<p>1)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$22 $F5XX </p>
<p> </p>
<p></p>
<p>1)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$22 $F6XX </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>1)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$22 $F7XX </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>1)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$22 $F8XX </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>5)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>83 / 163 </p>
<p><b>OBD </b></p>
<p><b>(WWH-OBD) </b></p>
<p> </p>
<p> </p>
<p><b>UDS </b></p>
<p>$01 $XX ($22 $F4XX) </p>
<p>($22 $F5XX) </p>
<p>$02 $XX ($19 $05 $00) </p>
<p>$03 ($19 $02) </p>
<p>$04 </p>
<p>($14) </p>
<p>$06 $XX ($22 $F6XX) </p>
<p>($22 $F7XX) </p>
<p>$07 ($19 $02) </p>
<p>$08 $XX ($31 $01 $E0XX) </p>
<p>($31 $01 $E1XX) </p>
<p>$09 $XX ($22 $F8XX) </p>
<p>$0A ($19 $15) </p>
<p>($19 $41) </p>
<p>($19 $42) </p>
<p>$22 [other] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$23 [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$24 [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$27 [any] </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p>$28 [any] </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p>$2A [any] </p>
<p></p>
<p>1) </p>
<p>2) 9)</p>
<p> </p>
<p></p>
<p>1) </p>
<p>2) 9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>1) </p>
<p>2) 9)</p>
<p> </p>
<p></p>
<p>1) </p>
<p>2) 9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>1) </p>
<p>2) 9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p></p>
<p>9)</p>
<p> </p>
<p>$2C [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$2E [any] </p>
<p>N/A </p>
<p>N/A </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>N/A </p>
<p>N/A </p>
<p> </p>
<p> </p>
<p> </p>
<p>N/A </p>
<p> </p>
<p> </p>
<p> </p>
<p>$2F [any] </p>
<p>N/A </p>
<p>N/A </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>N/A </p>
<p>N/A </p>
<p> </p>
<p> </p>
<p> </p>
<p>N/A </p>
<p> </p>
<p> </p>
<p> </p>
<p>$31 $01 $E0XX </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>1)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$31 $01 $E1XX </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p></p>
<p>1)</p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$31 $ZZ [other] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$34 [any] </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>$35 [any] </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>$36 [any] </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>$37 [any] </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>$3D [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$3E [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$84 [any] </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>$85 [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>$86 [any] </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>N/A </p>
<p>$87 [any] </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>Table 6-2  </p>
<p>(WWH-)OBD and UDS service collision matrix </p>
<p>1) </p>
<p>There is no real collision since the corresponding service ports are only allowed to be </p>
<p>implemented as synchronous call-backs (i.e. no pending is allowed). Both UDS and OBD </p>
<p>parallel requests will be processed. </p>
<p>2) </p>
<p>Service $2A will be deactivated once a valid (WWH-)OBD request is received, so even a </p>
<p>dynamically  defined  periodic  DID  ($F2XX)  would  reference  an  OBD  DID  there  is  no </p>
<p>collision. </p>
<p>3) </p>
<p>DCM  gives  in  this  case  higher  priority  to  the  OBD  request:  if  an  OBD  request  is  in </p>
<p>processing, the UDS request will be rejected by NRC $21 (BusyRepeatRequest). But if the </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>84 / 163 </p>
<p>UDS service is already in progress, the OBD service execution will be allowed, interrupting </p>
<p>at the same time the currently running UDS service. As a result the UDS response may be </p>
<p>missing or incomplete.  </p>
<p>4) </p>
<p>If  a  (WWH-)OBD  request  is  received  from  an  OBD  client  while  the  UDS  service  $10 </p>
<p>(DiagnosticSessionControl) is in processing, and the UDS service processing is finished </p>
<p>before </p>
<p>the </p>
<p>(WWH-)OBD </p>
<p>one, </p>
<p>then </p>
<p>service </p>
<p>$10 </p>
<p>will </p>
<p>be </p>
<p>responded </p>
<p>with </p>
<p>NRC </p>
<p>$22 </p>
<p>(ConditionsNotCorrect),  because  the  (WWH-)OBD  request  has  put  the  ECU  into  the </p>
<p>default session already.  </p>
<p>Note: If the currently requested session in progress is the programming session, then the </p>
<p>(WWH-)OBD request may be not responded at all. The reasons are: </p>
<p><b>&gt; </b> According to [5], OBD requests shall not be responded during programming session,  </p>
<p><b>&gt; </b> DCM executes a reset on programming session request. </p>
<p>5) </p>
<p>A  real  collision  is  possible  since  the  service  ports  of  this  (WWH-)OBD  service  are </p>
<p>allowed to be implemented asynchronously (i.e. to return pending). If both clients collide </p>
<p>on such a service, the second client will get NRC $78 as long as the first one is processing </p>
<p>the service. </p>
<p>6) </p>
<p>DCM  gives  in  this  case  higher  priority  to  the  OBD  request:  if  an  OBD  request  is  in </p>
<p>processing,  the  UDS  request  will  be  rejected  by  NRC  $21  (BusyRepeatRequest).  But </p>
<p>since  the  UDS  service  execution  is  performed  synchronously,  the  OBD  service  will  be </p>
<p>executed in parallel. </p>
<p>7) </p>
<p>DCM  gives  in  this  case  higher  priority  to  the  OBD  request:  if  an  OBD  request  is  in </p>
<p>processing, the UDS request will be rejected by NRC $21 (BusyRepeatRequest). But if the </p>
<p>UDS service is already in progress, the OBD execution will be postponed until the UDS </p>
<p>service is finished. The OBD tester will get NRC $78 meanwhile. </p>
<p>8) </p>
<p>DCM  gives  in  this  case  higher  priority  to  the  (WWH-)OBD  request:  if  a  (WWH-)OBD </p>
<p>request </p>
<p>is </p>
<p>in </p>
<p>processing, </p>
<p>the </p>
<p>UDS </p>
<p>request </p>
<p>will </p>
<p>be </p>
<p>rejected </p>
<p>by </p>
<p>NRC </p>
<p>$21 </p>
<p>(BusyRepeatRequest).  But  if  the  UDS  service  is  already  in  progress,  the  (WWH-)OBD </p>
<p>execution will be rejected by NRC $21 too, since it is possible that the final (WWH-)OBD </p>
<p>response will be $31 (RequestOutOfRange) that must not be sent. To avoid situations like: </p>
<p>request, </p>
<p>RCR-RP, </p>
<p>no </p>
<p>response, </p>
<p>DCM </p>
<p>rejects </p>
<p>immediately </p>
<p>the </p>
<p>(WWH-)OBD </p>
<p>service </p>
<p>request. </p>
<p>9) </p>
<p>If an OBD service is received while an UDS service is still in processing (response is </p>
<p>pending), </p>
<p>the </p>
<p>UDS </p>
<p>service </p>
<p>will </p>
<p>end </p>
<p>up </p>
<p>with </p>
<p>negative </p>
<p>Response </p>
<p>$7F </p>
<p>(ServiceNotSupportedInActiveSession) (if the final response would be a positive one). This </p>
<p>is because the (WWH-)OBD request has reset the ECU to the default session and those </p>
<p>UDS services must be executed only while the ECU is in a non-default session.  </p>
<p>The  same  NRC  will  be  sent  also  if  the  UDS  service  is  received  after  the  OBD  request, </p>
<p>since the currently active diagnostic session is already the default one. </p>
<p><b>6.2.2.3 </b></p>
<p><b>Supported WWH-OBD services </b></p>
<p>DCM supports every service specified by [10]. According to [5] there are some additional </p>
<p>sub-functions </p>
<p>for </p>
<p>service </p>
<p>0x19, </p>
<p>but </p>
<p>they </p>
<p>are </p>
<p>not </p>
<p>supported </p>
<p>yet </p>
<p>by </p>
<p>DCM. </p>
<p>These </p>
<p>unsupported WWH-OBD sub-functions are: 0x16 and 0x55. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>85 / 163 </p>
<p><b>6.2.2.4 </b></p>
<p><b>Alternative OBD Interfaces to the DEM  </b></p>
<p>The </p>
<p>OBD </p>
<p>standard </p>
<p>specifies </p>
<p>diagnostic </p>
<p>services </p>
<p>which </p>
<p>have </p>
<p>access </p>
<p>to </p>
<p>the </p>
<p>ECUs </p>
<p>faultmemory  (e.g.  reading  active  DTCs,  reading  freeze  frame  data,  clearing  OBD  DTC, </p>
<p>etc.). In general DEM shall be able to handle the UDS as well as OBD related faultmemory </p>
<p>functionality. In some cases, where the standard DEM is not able to implement the OBD </p>
<p>requirements, DCM uses a DEM addon that  completes the missing OBD functionality of </p>
<p>the standard DEM.  </p>
<p>So  if  your  ECU  shall  support  at  least  one  of  the,  required  by  the  OBD  standard, </p>
<p>faultmemory related diagnostic services, and the DEM you have in your system is not OBD </p>
<p>capable, please read this chapter to the end to learn which requirements DCM addresses </p>
<p>to the DEM OBD addon you have to implement.  </p>
<p><b>Header file </b></p>
<p>DCM expects that a header file, that will contain all the interfaces for OBD DEM, already </p>
<p>exists  in  your  project.  The  name  of  the  file  that  DCM  includes  is <b> “DemObd.h”</b>.  If  you </p>
<p>already have an implemented OBD related DEM addon with another filename, please just </p>
<p>created a file with the mentioned name and make an include statement of your own file </p>
<p>inside it. </p>
<p>Example DemObd.h content: </p>
<p>#include “MyObdDem.h” </p>
<p><b>API Declarations and Implementations </b></p>
<p>Since  almost  all  OBD  diagnostic  service  related  DEM  APIs  are  the  same  as  the  one </p>
<p>already implemented in the standard DEM component, DCM uses another API namespace </p>
<p>in order to address the appropriate DEM. The overlapped APIs that shall be handled in the </p>
<p>DEM addon have a prefix “DemObd_” instead of the standard DEM API prefix “Dem_”. The </p>
<p>complete  list  of  the  addon  APIs  and  their  diagnostic  service  association  is  provided  in </p>
<p><i>Table 6-3  </i></p>
<p><i>Standard and OBD addon DEM API mapping</i>. </p>
<p> </p>
<p><b>DEM type </b></p>
<p> </p>
<p> </p>
<p> </p>
<p><b>Diagnostic </b></p>
<p><b>Service Identifier </b></p>
<p>Standard  </p>
<p>OBD  Addon </p>
<p>0x01 </p>
<p>- </p>
<p>Dem_DcmGetPIDXX </p>
<p>0x02 </p>
<p>Dem_GetDTCOfFreezeFrameRecord </p>
<p>Dem_GetOBDFreezeFrameData </p>
<p>Dem<b>Obd</b>_GetDTCOfFreezeFrameRecord </p>
<p>0x03 / 0x07 / 0x0A </p>
<p>Dem_SetDTCFilter </p>
<p>Dem_GetNumberOfFilteredDTC </p>
<p>Dem_GetNextFilteredDTC </p>
<p>Dem<b>Obd</b>_SetDTCFilter </p>
<p>Dem<b>Obd</b>_GetNumberOfFilteredDTC </p>
<p>Dem<b>Obd</b>_GetNextFilteredDTC </p>
<p>0x04 </p>
<p>Dem_ClearDTC </p>
<p>Dem<b>Obd</b>_ClearDTC </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>86 / 163 </p>
<p><b>DEM type </b></p>
<p> </p>
<p> </p>
<p> </p>
<p><b>Diagnostic </b></p>
<p><b>Service Identifier </b></p>
<p>Standard  </p>
<p>OBD  Addon </p>
<p>0x09 </p>
<p>- </p>
<p>Dem_GetInfoTypeValue_XX </p>
<p>0x14 </p>
<p>Dem_ClearDTC </p>
<p>- </p>
<p>0x19 </p>
<p>All standard DEM APIs, listed in <i>Table </i></p>
<p><i>8-3  Services used by the DCM</i>. </p>
<p>Note: Also OBD related sub-function </p>
<p>will be addressed in DEM. </p>
<p>- </p>
<p>Table 6-3  </p>
<p>Standard and OBD addon DEM API mapping </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The DEM OBD addon shall only provide the new function declarations and their </p>
<p>implementation. The shared data types (used for return values and formal parameters), </p>
<p>are the same from the standard DEM module. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>6.2.3 </b></p>
<p><b>Configuration </b></p>
<p><b>6.2.3.1 </b></p>
<p><b>CANdela </b></p>
<p>All of the (WWH-)OBD services that shall be supported must be available in the CDD file, </p>
<p>including  the  corresponding  “availability  IDs”.  The  data  content  of  the  “availability  ID” </p>
<p>services  will  not  be  considered  at  the  time  of  the  CDD  import  in  GENy,  since  DCM </p>
<p>automatically </p>
<p>generates </p>
<p>the </p>
<p>required </p>
<p>“availability </p>
<p>ID” </p>
<p>masks </p>
<p>and </p>
<p>their </p>
<p>data </p>
<p>content </p>
<p>considering the other (WWH-)OBD services.  </p>
<p>Some of the OBD services require special configuration process to be followed, therefore </p>
<p>please  refer  to  the  service  specific  configuration  chapter  to  the  corresponding  the  OBD </p>
<p>service. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>87 / 163 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>OBD support will be enabled upon detection of one of the following services: </p>
<p>0x01, 0x02, 0x03, 0x04, 0x06, 0x07, 0x08, 0x09 and 0x0A. </p>
<p>WWH-OBD support (available first in DCM version 4.01.00) will be enabled upon </p>
<p>detection of one of the following services: </p>
<p>0x19 0x16, 0x19 0x41, 0x19 0x42 and 0x19 0x55. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>6.2.3.2 </b></p>
<p><b>GENy </b></p>
<p>On  one  site,  GENy  imports  the  CDD  content  in  order  to  provide  the </p>
<p>(WWH-)OBD </p>
<p>configuration to the DCM module code generator. </p>
<p>On the other site, GENy also configures the communication connections for DCM where </p>
<p>as </p>
<p>in </p>
<p>case </p>
<p>of </p>
<p>(WWH-)OBD </p>
<p>support </p>
<p>in </p>
<p>DCM, </p>
<p>the </p>
<p>property </p>
<p>“protocol </p>
<p>type” </p>
<p>on </p>
<p>each </p>
<p>connection </p>
<p>plays </p>
<p>important </p>
<p>role </p>
<p>(refer </p>
<p>to </p>
<p>chapter </p>
<p><i>9.2.5 </i></p>
<p><i>Diagnostic </i></p>
<p><i>Connection </i></p>
<p><i>Configuration </i>for more details about this option). </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Since DCM supports the (WWH-)OBD services in parallel to the UDS ones, you have </p>
<p>to assure the following BSW components settings are set correctly (applies only in </p>
<p>case Vector BSWs are used): </p>
<p><b>&gt; </b> PDU-R: The PDU-R option “<b>Maximum TP Connection Number</b>” shall be </p>
<p>equal or greater to all possible parallel connections that DCM supports (DCM </p>
<p>setting “<b>Maximum Number of Parallel Requests</b>” </p>
<p>1)</p>
<p> <b>+ 2 </b>(for the UDS and </p>
<p>OBD connections)). For more details about the PDU-R setting, please refer </p>
<p>to its technical reference. </p>
<p><b>&gt; </b> CAN-TP: If CAN-TP is configured to “<b>Support dynamic channel </b></p>
<p><b>assignment</b>”, then the CAN-TP option “<b>Max. number of Rx/Tx channels</b>” </p>
<p>shall be equal or greater to all possible parallel connections that DCM </p>
<p>supports (DCM setting “<b>Maximum Number of Parallel Requests</b>”</p>
<p> 1) </p>
<p><b>+ 2 </b>(for </p>
<p>the UDS and OBD connection)). For more details about the CAN-TP settings, </p>
<p>please refer to its technical reference. </p>
<p><b>If the above configurations are not performed, DCM will not be able to </b></p>
<p><b>respond in parallel (there will be response transmission collisions), which </b></p>
<p><b>will lead to P2-timing violations! </b></p>
<p>1) </p>
<p>The “<b>Maximum Number of Parallel Requests</b>” option in DCM is not </p>
<p>necessary to be supported in order (WWH-)OBD to function properly, but if, it </p>
<p>shall be considered too! </p>
<p><b> </b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>88 / 163 </p>
<p><b>6.3 </b></p>
<p><b>Multi-Identity Support </b></p>
<p><b>6.3.1 </b></p>
<p><b>Functionality </b></p>
<p>Per </p>
<p>specification </p>
<p>the </p>
<p>DCM </p>
<p>has </p>
<p>a </p>
<p>static </p>
<p>configuration </p>
<p>set </p>
<p>– </p>
<p>once </p>
<p>all </p>
<p>services </p>
<p>and </p>
<p>communication connections are configured, and the program code is flashed into the ECU </p>
<p>there  are  no  more  configuration  changes  possible.  This  is  the  so  called  single  identity </p>
<p>mode. </p>
<p>The  DCM  module  developed  by  Vector  implements  additionally  dynamic  configuration </p>
<p>modes  that  allow  switching  among  the  available  configuration  sets  at  run-time  (without </p>
<p>need to reprogram the ECU). This requires that the superset of all variants must be pre-</p>
<p>enabled during the software compilation and link process. </p>
<p>All supported configuration sets are described in the following chapters. </p>
<p> </p>
<p><b>6.3.2 </b></p>
<p><b>Single Identity Mode </b></p>
<p>If the single-identity operation mode has been selected, DCM uses a statically assigned </p>
<p>configuration set which is linked at ECU compile and link time. </p>
<p>Figure 6-1 </p>
<p>DCM single identity mode </p>
<p>In this case DCM has only one diagnostic and communication configuration set. </p>
<p><b>6.3.2.1 </b></p>
<p><b>Configuration in CANdela  </b></p>
<p>You  need  just  to  prepare  the  corresponding  CDD  variant  for  your  ECU  configuration  in </p>
<p>CANdelaStudio. </p>
<p><b>6.3.2.2 </b></p>
<p><b>Configuration in GENy </b></p>
<p>Import  the  CDD  file  and  the  corresponding  variant  in  GENy  (refer  to  chapter </p>
<p><i>9.2.3 </i></p>
<p><i>CANdelaDiagnosticDocument import options </i>for details). </p>
<p> </p>
<p>DCM </p>
<p>PDU-R </p>
<p>DCM  </p>
<p>DIAG CFG </p>
<p> </p>
<p>DCM  </p>
<p>COM CFG </p>
<p> </p>
<p>DCM  </p>
<p>APPL </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>89 / 163 </p>
<p><b>6.3.3 </b></p>
<p><b>VSG Mode </b></p>
<p>The VSG mode has the following characteristics: </p>
<p><b>&gt; </b> Allows to support multiple diagnostic configuration variants – each variant reflects a </p>
<p>VSG from the imported CDD file, and additionally there is a base variant that contains </p>
<p>all services that does not belong to any VSG. </p>
<p><b>&gt; </b> One or several configuration variants can be simultaneously activated during the ECU </p>
<p>initialization. The base variant is always active. </p>
<p> </p>
<p>As in multi identity mode, here you can also have multiple communication sets, but you </p>
<p>can not select a separate VSG over a specific communication configuration. A VSG </p>
<p>configuration set is always treated as a single diagnostic configuration from GENy point of </p>
<p>view. In other words you can still have multiple ConfigSets, but only varying over different </p>
<p>connection sets (the diagnostic configuration set assigned to all ConfigSets is the base </p>
<p>configuration set). The concrete diagnostic configuration is assigned at run-time (refer to </p>
<p>chapter <i>3.3 VSG Configuration Set Pre-Selection</i>). </p>
<p> </p>
<p>Figure 6-2 </p>
<p>DCM VSG mode </p>
<p><b>6.3.3.1 </b></p>
<p><b>Implementation Limitations </b></p>
<p>In </p>
<p>order </p>
<p>to </p>
<p>generate </p>
<p>the </p>
<p>correct </p>
<p>NRC </p>
<p>for </p>
<p>a </p>
<p>requested </p>
<p>service </p>
<p>Id </p>
<p>(e.g. </p>
<p>$7F </p>
<p>(ServiceNotSupprtedInActiveSession),  DCM  considers  all  of  its  sub-services  diagnostic </p>
<p>session  specific  execution  precondition  and  calculates  a  diagnostic  session  filter for  the </p>
<p>SID. In case of a multi-identity such a calculation shall be made for all of the diagnostic </p>
<p>configuration variants, which will cost a lot of ROM resources. </p>
<p> </p>
<p>In order to keep DCM ROM resources as low as possible the service Id specific session </p>
<p>filtering is created considering the superset of all sub-services it contains, independently of </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM </p>
<p>PDU-R </p>
<p>DCM  </p>
<p>COM CFG </p>
<p> </p>
<p> </p>
<p>DCM  </p>
<p>APPL </p>
<p> </p>
<p> </p>
<p> </p>
<p>DCM  </p>
<p>DIAG CFG </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>90 / 163 </p>
<p>their  configuration  affiliation.  Depending  on  the  active  configuration  set  in  the  ECU,  this </p>
<p>limitation can lead to the following effect:  </p>
<p>A  requested  service  will  be  responded  with  the  NRC  $12  (SubfunctionNotSupported)  or </p>
<p>$31(requestOutOfRange), depending on if it has a sub-function or not, instead of the NRC </p>
<p>$7F. Such a configuration could be for example: </p>
<p>Service $22 (ReadDataByIdentifier) supports only two DIDs: </p>
<p>$F100 - supported only in the default diagnostic sessions and available only in variant 1; </p>
<p>$F101 – supported only in a non-default session and available only in variant 2. </p>
<p>DCM  will  summarize  in  this  case,  that  service  $22  is allowed  in  any  diagnostic  session </p>
<p>since there is at least one DID supported in at least one of each session. </p>
<p>Now  let’s  assume  the  ECU  is  powered  up  with  active  variant  2.  If  the  client  sends  a </p>
<p>request $22 $F100 while in the default diagnostic session, DCM will respond with the NRC </p>
<p>$31 (DID not supported), instead of the $7F (none of the DIDs in the active configuration is </p>
<p>executable in the default session -&gt; the service Id itself is not executable in the session -&gt; </p>
<p>NRC $7F would be expected). </p>
<p><b>6.3.3.2 </b></p>
<p><b>Configuration in CANdela </b></p>
<p>Please follow the steps below on how to configure VSG in CANdelaStudio. </p>
<p> </p>
<p>1. </p>
<p>Defining all available VSGs for the concrete ECU. </p>
<p>In CANdelaStudio, select the Vehichle System Groups view and add all necessary VSGs </p>
<p>into the VSG pool. </p>
<p> </p>
<p>Figure 6-3 </p>
<p>Defining VSGs in CANdelaStudio </p>
<p>The name of the created VSG will be used later by DCM for the diagnostic configuration </p>
<p>constants  that  the  DCM  application  shall  use  during  the  configuration  activation  phase </p>
<p>(refer to chapter <i>3.3 VSG Configuration Set Pre-Selection</i>). </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>91 / 163 </p>
<p>Once  all  of  the  required  VSGs  are  created,  you  can  start  with  the  service  to  VSG </p>
<p>assignment. </p>
<p> </p>
<p>2. </p>
<p>Service to VSG assignment </p>
<p>Using CANdelaStudio you can assign any diagnostic instance to none, one or multiple </p>
<p>VSGs. Those services that do belong to a diagnostic instance without a VSG assignment </p>
<p>will be considered as services of the base variant (services that are always available). </p>
<p> </p>
<p>Figure 6-4 </p>
<p>Setting a VSG for service in CANdelaStudio </p>
<p><b>6.3.3.3 </b></p>
<p><b>Configuration in GENy </b></p>
<p>In order to put GENy into VSG mode, you have to select it on the DCM component root. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>92 / 163 </p>
<p> </p>
<p>Figure 6-5 </p>
<p>Switching DCM in GENy to VSG mode </p>
<p>Now  import  the  CDD  file,  containing  the  VSGs  in  GENy  as  described  in  chapter <i> 9.2.3 </i></p>
<p><i>CANdelaDiagnosticDocument import options</i>. That is all. </p>
<p> </p>
<p><b>6.4 </b></p>
<p><b>Code Template </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>This feature is available first since DCM version 3.15.00! </p>
<p><b> </b></p>
<p> </p>
<p>if no RTE is available, a code template providing all needed data type definitions, function </p>
<p>prototypes  and  example  callback  implementation  (pseudo-)  code  for  all  DCM  Required </p>
<p>Ports </p>
<p>(see </p>
<p>8.5.1.2) </p>
<p>will </p>
<p>be </p>
<p>generated </p>
<p>automatically </p>
<p>to </p>
<p>support </p>
<p>your </p>
<p>application </p>
<p>development. </p>
<p> </p>
<p><b>6.4.1 </b></p>
<p><b>Code Template File Structure </b></p>
<p>The generated code template consists of the following files: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>93 / 163 </p>
<p><b>Filename </b></p>
<p><b>Description </b></p>
<p>Appl_Dcm.h </p>
<p>Contains all data type definitions and callback function </p>
<p>prototypes that are needed to implement all DCM Required </p>
<p>Port callbacks. </p>
<p>This file must not be edited. </p>
<p>Appl_Dcm.c </p>
<p>Contains callback function implementations for all DCM </p>
<p>Required Port callbacks. </p>
<p>This file can be edited as described in section 6.4.2. </p>
<p>Table 6-4  </p>
<p>DCM application code template files </p>
<p><b>6.4.2 </b></p>
<p><b> Editing and Merging of the Code Template </b></p>
<p>The file Appl_Dcm.c is only allowed to be edited within marked areas delimited by special </p>
<p>comment tags: </p>
<p>/*************************************************************************************************** </p>
<p> * DO NOT CHANGE THIS COMMENT!     &lt;&lt; Start of user editable area &gt;&gt;     DO NOT CHANGE THIS COMMENT! </p>
<p> **************************************************************************************************/ </p>
<p>  </p>
<p> /* Only edit this file within marked areas like this one */ </p>
<p> </p>
<p>/*************************************************************************************************** </p>
<p> * DO NOT CHANGE THIS COMMENT!     &lt;&lt; End of user editable area &gt;&gt;       DO NOT CHANGE THIS COMMENT! </p>
<p> **************************************************************************************************/</p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>All changes made outside the marked areas within Appl_Dcm.c will be overwritten </p>
<p>during the next generation run. </p>
<p> </p>
<p><b>[11]  </b></p>
<p> </p>
<p>If during a generation run, the file Appl_Dcm.c already exists in the target directory, code </p>
<p>from within these areas will be transferred unchanged into the corresponding sections of </p>
<p>the updated template file. </p>
<p>If the configuration has changed in between two generation runs, the function bodies of all </p>
<p>functions that do not exist any more in the updated template file will be transferred to the </p>
<p>“removed code area” at the bottom of the Appl_Dcm.c file. </p>
<p>The  existing Appl_Dcm.c  file  will  be  saved  as Appl_Dcm.c.#.bak,  with  #  being  the  next </p>
<p>available number. </p>
<p>The  updated  “clean”  template  file  containing  only  the  automatically  generated  template </p>
<p>code will be saved as Appl_Dcm.c.tpl. </p>
<p><b>6.4.3 </b></p>
<p><b>Template (Pseudo-) Implementations of Callback Functions </b></p>
<p>To support you with the callback implementation, an example implementation is given for </p>
<p>each callback function. </p>
<p>These  example  implementations  show  how  the  parameters  and  return  values  of  each </p>
<p>function </p>
<p>can </p>
<p>be </p>
<p>used. </p>
<p>Sometimes </p>
<p>pseudo-code </p>
<p>is </p>
<p>used </p>
<p>to </p>
<p>illustrate </p>
<p>more </p>
<p>complex </p>
<p>correlations. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>94 / 163 </p>
<p>All allowed return values for the implementation are listed in the comment header of each </p>
<p>function. </p>
<p><b> </b></p>
<p> </p>
<p><b>Example </b></p>
<p>Here is an example that has been prepared for you. </p>
<p><b>[12]  </b></p>
<p><b> </b></p>
<p>/*************************************************************************************************** </p>
<p> *  Appl_Dcm_DidServices_0x0000_ReadData </p>
<p> **************************************************************************************************/ </p>
<p>/*! \brief          This service port operation will be executed by DCM by receiving a valid read </p>
<p> *                  data by identifier request (service 0x22). The application shall write the DID    </p>
<p> *                   data to the specified buffer beginning by position 0.  </p>
<p> *                  Note: There is no paged-buffer support - all the data must be written linearly  </p>
<p> *                  into the buffer. </p>
<p> *  \param[in,out]  data  Pointer to the response buffer for the DID data. </p>
<p> *  \return         Operation status </p>
<p> *  \retval         DCM_E_OK  Operation terminated successfully </p>
<p> *  \retval         DCM_E_PENDING  The application needs more time to perform the requested  </p>
<p> *                  operation. </p>
<p> *  \context        Function will be called from the Dcm_MainFunction() context </p>
<p> *************************************************************************************************/ </p>
<p>FUNC(Std_ReturnType, DCM_APPL_CODE) Appl_Dcm_DidServices_0x0000_ReadData( </p>
<p>  P2VAR(Dcm_1Byte_Type, AUTOMATIC, DCM_VAR_NOINIT) data) </p>
<p>{ </p>
<p>/*************************************************************************************************** </p>
<p> * DO NOT CHANGE THIS COMMENT!  &lt;&lt; Start of callback implementation &gt;&gt;   DO NOT CHANGE THIS COMMENT! </p>
<p> * Symbol: Appl_Dcm_DidServices_0x0000_ReadData </p>
<p> **************************************************************************************************/ </p>
<p>   </p>
<p>  /* </p>
<p>  if (&lt;READ_DATA_RSLT_NOT_READY&gt;) </p>
<p>  { </p>
<p>    return DCM_E_PENDING; </p>
<p>  } </p>
<p>  */ </p>
<p>   </p>
<p>  (*data)[0] = 0x12; </p>
<p>   </p>
<p>  return DCM_E_OK; </p>
<p> </p>
<p>/*************************************************************************************************** </p>
<p> * DO NOT CHANGE THIS COMMENT!   &lt;&lt; End of callback implementation &gt;&gt;    DO NOT CHANGE THIS COMMENT! </p>
<p> **************************************************************************************************/ </p>
<p>} </p>
<p> </p>
<p><b>6.5 </b></p>
<p><b>Support of Unspecified Services </b></p>
<p><b>6.5.1 </b></p>
<p><b>Functionality </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>FAQ </b></p>
<p>This feature is first supported in DCM 4.03.00. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>Per default, any service identifier not defined in the DCM configuration (i.e. CDD file) will </p>
<p>be </p>
<p>rejected </p>
<p>automatically </p>
<p>by </p>
<p>DCM, </p>
<p>sending </p>
<p>the </p>
<p>NRC </p>
<p>0x11 </p>
<p>(ServiceNotSupported). </p>
<p>According  to  AR  3.0  standard,  DCM  is  also  limited  to  support  only  several  service </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>95 / 163 </p>
<p>identifiers  from  UDS. This  may  hardly  restrict  ECU  suppliers,  which  need  own  SIDs  for </p>
<p>internal  production  and  test  purposes.  For  such  situations,  Vector’s  DCM  provides  a </p>
<p>special feature  that  allows  you  to  implement  in  a  generic  way  any  service  identifier  you </p>
<p>need. </p>
<p>The  idea  of  the  unspecified  service  handling  is  quite  simple:  on  any  requested  service </p>
<p>identifier  that  DCM  does  not  support,  the  application  will  be  asked </p>
<p>via  the  call-out </p>
<p><i>Dcm_CheckUnspecifiedService </i>whether the SID is known to it or not. The further service </p>
<p>handling will depend on the result of this function call: </p>
<p><b>Unspecified Service Not Supported </b></p>
<p>If  the  application  does  not  support  the  requested  SID,  the  following  sequence  will  be </p>
<p>performed: </p>
<p><b>sd UnspecifiedServ iceHandling_SNS</b></p>
<p>DCM</p>
<p><i>(from Interaction Objects)</i></p>
<p>Tester</p>
<p><i>(from Interaction Objects)</i></p>
<p>Application</p>
<p><i>(from Interaction Objects)</i></p>
<p>Request(0xXX, ANY_SUBSVC, ANY_DATA)</p>
<p>Dcm_CheckUnspecifiedService(0xXX, FALSE)</p>
<p>Dcm_CheckUnspecifiedService() :DCM_E_NOT_OK</p>
<p>Response(0x7F,0xXX,0x11)</p>
<p> </p>
<p>Figure 6-6 </p>
<p>Unspecified service not supported by the application </p>
<p><b>Unspecified Service Supported </b></p>
<p>If </p>
<p>the </p>
<p>application </p>
<p>does </p>
<p>support </p>
<p>the </p>
<p>requested </p>
<p>SID, </p>
<p>the </p>
<p>following </p>
<p>sequence </p>
<p>will </p>
<p>be </p>
<p>performed: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>96 / 163 </p>
<p> </p>
<p>Figure 6-7 </p>
<p>Processing of a supported unspecified service </p>
<p>As shown in <i>Figure 6-7  Processing  of  a  supported  unspecified  service </i> any  application </p>
<p>specific service will result in a call of the <i>Dcm_HandleUnspecifiedService </i>service handler, </p>
<p>where  the  complete  service  processing  shall  be  performed.  At  the  end  of  the  service </p>
<p>execution </p>
<p>the </p>
<p><i>Dcm_PostHandleUnspecifiedService </i></p>
<p>will </p>
<p>be </p>
<p>called </p>
<p>for </p>
<p>some </p>
<p>state </p>
<p>management post-handling (e.g. releasing resources/semaphores, etc.). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>97 / 163 </p>
<p><b>6.5.2 </b></p>
<p><b>Implementation Specifics and Limitations </b></p>
<p>Since there is no information on any of the  services handled within such a procedure at </p>
<p>DCM configuration time, DCM is not able to support the application by any kind of service </p>
<p>validations. These are: </p>
<p><b>&gt; </b> ECU variant assignment (in ECUs, supporting multi identity) </p>
<p><b>&gt; </b> Minimum request length check  </p>
<p><b>&gt; </b> Session filtering </p>
<p><b>&gt; </b> Security access </p>
<p>All these tasks shall be performed by the application within the </p>
<p><i>Dcm_CheckUnspecifiedService </i>and <i>Dcm_HandleUnspecifiedService </i>callouts. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>If the ECU is configured for multi-variant handling, any service that is not supported </p>
<p>within the currently active variant will be considered and handled as “unspecified </p>
<p>service”. This would allow you to handle such a service in a completely different way </p>
<p>depending on the currently active variant.  </p>
<p>In general the <i>Dcm_CheckUnspecifiedService </i>shall consider only SIDs not supported </p>
<p>by the DCM configuration at all (i.e. independently of variants). Therefore the ECU will </p>
<p>always return NRC 0x11 as a final result when the DCM configuration contains a </p>
<p>service that is not supported in the active variant. There is no special consideration for </p>
<p>the application required for this case. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>6.5.3 </b></p>
<p><b>Configuration in CANdela </b></p>
<p>There is nothing you shall configure for this feature in CANdelaStudio. </p>
<p><b>6.5.4 </b></p>
<p><b>Configuration in GENy </b></p>
<p>In  order  to  be  able  to  use  this  feature,  you  have  to  enable  it  in  GENy.  Please  refer  to </p>
<p>chapter <i>9.2.2 General DCM options </i>for more details about this GENy option. </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>98 / 163 </p>
<p><b>7 </b></p>
<p><b>Overview of all Services handled by DCM </b></p>
<p>Your DCM does not handle internally any services. </p>
<p>For  the  services  listed  below,  DCM  provides  an  internal  implementation  and  for  those </p>
<p>services, there will be no service port required from the application to be implemented.  </p>
<p>In some cases DCM delegates the services specific task to be handled by another BSW.  </p>
<p>In other cases special call-outs to the application will be required. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>Each service implementation has a condition which if not met, will cause that the </p>
<p>service is treated by DCM as a normal one and there will be a service call to the </p>
<p>application to handle it.  </p>
<p>For all services is true that the implementation will be activated if the corresponding </p>
<p>service is available in the current ECU diagnostic configuration. For link-time variants – </p>
<p>the DCM built in code will not be executed, but still it is needed to implement all </p>
<p>symbols that are required by the DCM library. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>7.1 </b></p>
<p><b>Implemented PIDs of ServiceId $01 </b></p>
<p><b>PID </b></p>
<p><b>Type </b></p>
<p><b>Implementation </b></p>
<p><b>Condition </b></p>
<p><b>Description </b></p>
<p><b>Handled </b></p>
<p><b>by  </b></p>
<p>$01-$02 </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$1C </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$21 </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$30-$31 </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$41 </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$4D </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$4E </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$5F </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$90-$94 </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$00, </p>
<p>$20, </p>
<p>$40, </p>
<p>$60, </p>
<p>$80, </p>
<p>$A0, </p>
<p>$C0, </p>
<p>$E0 </p>
<p>Supported </p>
<p>PID </p>
<p>Always </p>
<p>The supported PID content will be calculated </p>
<p>by DCM and reported automatically. </p>
<p>DCM </p>
<p>Table 7-1  </p>
<p>Service $01 internally handled PIDs </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>99 / 163 </p>
<p><b>7.2 </b></p>
<p><b>Implemented MIDs of ServiceId $06 </b></p>
<p><b>MID </b></p>
<p><b>Type </b></p>
<p><b>Implementation </b></p>
<p><b>Condition </b></p>
<p><b>Description </b></p>
<p><b>Handled </b></p>
<p><b>by  </b></p>
<p>$00, </p>
<p>$20, </p>
<p>$40, </p>
<p>$60, </p>
<p>$80, </p>
<p>$A0, </p>
<p>$C0, </p>
<p>$E0 </p>
<p>Supported </p>
<p>MID </p>
<p>Always </p>
<p>The supported MID content will be calculated by </p>
<p>DCM and reported automatically. </p>
<p>DCM </p>
<p>Table 7-2  </p>
<p>Service $06 internally handled MIDs </p>
<p><b>7.3 </b></p>
<p><b>Implemented TIDs of ServiceId $08 </b></p>
<p><b>MID </b></p>
<p><b>Type </b></p>
<p><b>Implementation </b></p>
<p><b>Condition </b></p>
<p><b>Description </b></p>
<p><b>Handled </b></p>
<p><b>by  </b></p>
<p>$00, </p>
<p>$20, </p>
<p>$40, </p>
<p>$60, </p>
<p>$80, </p>
<p>$A0, </p>
<p>$C0, </p>
<p>$E0 </p>
<p>Supported </p>
<p>TID </p>
<p>Always </p>
<p>The supported TID content will be calculated by </p>
<p>DCM and reported automatically. </p>
<p>DCM </p>
<p>Table 7-3  </p>
<p>Service $08 internally handled TIDs </p>
<p><b>7.4 </b></p>
<p><b>Implemented VIDs of ServiceId $09 </b></p>
<p><b>VID </b></p>
<p><b>Type </b></p>
<p><b>Implementation </b></p>
<p><b>Condition </b></p>
<p><b>Description </b></p>
<p><b>Handled </b></p>
<p><b>by  </b></p>
<p>$08 </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$0B </p>
<p>FaultMemory </p>
<p>Always </p>
<p>PID Data reading will be rerouted to DEM. </p>
<p>DEM </p>
<p>$00, </p>
<p>$20, </p>
<p>$40, </p>
<p>$60, </p>
<p>$80, </p>
<p>$A0, </p>
<p>$C0, </p>
<p>$E0 </p>
<p>Supported </p>
<p>VID </p>
<p>Always </p>
<p>The supported VID content will be calculated by </p>
<p>DCM and reported automatically. </p>
<p>DCM </p>
<p>Table 7-4  </p>
<p>Service $09 internally handled VIDs </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>100 / 163 </p>
<p><b>7.5 </b></p>
<p><b>Implemented DIDs of ServiceId $22 </b></p>
<p><b>DID </b></p>
<p><b>Type </b></p>
<p><b>Implementation </b></p>
<p><b>Condition </b></p>
<p><b>Description </b></p>
<p><b>Handled </b></p>
<p><b>by  </b></p>
<p>$F400-</p>
<p>$F5FF </p>
<p>OBD PID </p>
<p>Refer to chapter </p>
<p><i>6.2 (WWH-)OBD </i></p>
<p><i>Support </i></p>
<p>Refer to chapter <i>6.2 (WWH-)OBD Support </i></p>
<p>DCM </p>
<p>$F600-</p>
<p>$F7FF </p>
<p>OBD MID </p>
<p>Refer to chapter </p>
<p><i>6.2 (WWH-)OBD </i></p>
<p><i>Support </i></p>
<p>Refer to chapter <i>6.2 (WWH-)OBD Support </i></p>
<p>DCM </p>
<p>$F800-</p>
<p>$F8FF </p>
<p>OBD VID </p>
<p>Refer to chapter </p>
<p><i>6.2 (WWH-)OBD </i></p>
<p><i>Support </i></p>
<p>Refer to chapter <i>6.2 (WWH-)OBD Support </i></p>
<p>DCM </p>
<p>Table 7-5  </p>
<p>Service $22 internally handled DIDs </p>
<p> </p>
<p><b>7.6 </b></p>
<p><b>Implemented RIDs of ServiceId $31 </b></p>
<p><b>SF: </b></p>
<p><b>RID </b></p>
<p><b>Type </b></p>
<p><b>Implementation </b></p>
<p><b>Condition </b></p>
<p><b>Description </b></p>
<p><b>Handled </b></p>
<p><b>by  </b></p>
<p>$01: </p>
<p>$E000-</p>
<p>$E1FF </p>
<p>OBD Routine </p>
<p>Refer to chapter </p>
<p><i>6.2 (WWH-)OBD </i></p>
<p><i>Support </i></p>
<p>Refer to chapter <i>6.2 (WWH-)OBD Support </i></p>
<p>DCM </p>
<p>Table 7-6  </p>
<p>Service $31 internally handled RIDs </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>101 / 163 </p>
<p><b>8 </b></p>
<p><b>API Description </b></p>
<p><b>8.1 </b></p>
<p><b>Interfaces Overview </b></p>
<p><b>class Interactions</b></p>
<p>OEM specific usage</p>
<p><b>ComM</b></p>
<p><b>Dcm</b></p>
<p>«interface»</p>
<p><b>Dcm_ComM</b></p>
<p>+ </p>
<p>Dcm_ComM_NoComModeEntered() : void</p>
<p>+ </p>
<p>Dcm_ComM_SilentComModeEntered() : void</p>
<p>+ </p>
<p>Dcm_ComM_FullComModeEntered() : void</p>
<p>«interface»</p>
<p><b>PduR</b></p>
<p>+ </p>
<p>PduR_DcmTransmit() : void</p>
<p>«interface»</p>
<p><i><b>Dcm_PduR</b></i></p>
<p>+ </p>
<p><i>Dcm_ProvideRxBuffer() : void</i></p>
<p>+ </p>
<p><i>Dcm_RxIndication() : void</i></p>
<p>+ </p>
<p><i>Dcm_ProvideTxBuffer() : void</i></p>
<p>+ </p>
<p><i>Dcm_TxConfirmation() : void</i></p>
<p>+ </p>
<p><i>Dcm_TriggerTransmit() : void</i></p>
<p><b>PduR</b></p>
<p><b>Dem</b></p>
<p>«interface»</p>
<p><i><b>Dem</b></i></p>
<p>+ </p>
<p><i>&lt;DEM APIs according to ASR 3.0 &gt;() : void</i></p>
<p>+ </p>
<p><i>DemOem_SetFaultStatus(uint8*) : Std_ReturnType</i></p>
<p>+ </p>
<p><i>DemOem_EraseMirrorMemoryDTCs() : Std_ReturnType</i></p>
<p><b>Mcu</b></p>
<p>«interface»</p>
<p><i><b>Mcu</b></i></p>
<p>+ </p>
<p><i>Mcu_PerformReset() : void</i></p>
<p><i><b>ComM</b></i></p>
<p>+ </p>
<p><i>ComM_DCM_ActiveDiagnostic() : void</i></p>
<p>+ </p>
<p><i>ComM_DCM_InactiveDiagnostic() : void</i></p>
<p>+ </p>
<p><i>ComM_Dcm_SetPassiveMode(boolean) : void</i></p>
<p><b>Nv M</b></p>
<p><b>VpM</b></p>
<p><b>DcmFbl</b></p>
<p><b>IoHwAb</b></p>
<p>«interface»</p>
<p><b>IoHwAb</b></p>
<p>+ </p>
<p>IoHwAb_DCM_&lt;IODescriptor&gt;&lt;IOSignal&gt;(ActionType, SignalType) : Std_ReturnType</p>
<p>+ </p>
<p>IoHwAb_DCM_Read_&lt;IOSignal&gt;(SignalType) : Std_ReturnType</p>
<p>«interface»</p>
<p><b>Nv M</b></p>
<p>+ </p>
<p>NvM_ReadBlock(NvM_BlockIdType, uint8*) : Std_ReturnType</p>
<p>+ </p>
<p>NvM_WriteBlock(NvM_BlockIdType, uint8*) : Std_ReturnType</p>
<p>+ </p>
<p>NvM_SetBlockLockStatus(NvM_BlockIdType, boolean) : Std_ReturnType</p>
<p>+ </p>
<p>NvM_GetErrorStatus(NvM_BlockIdType, uint8*) : void</p>
<p>«interface»</p>
<p><b>VpM</b></p>
<p>+ </p>
<p>Vpm_Init() : void</p>
<p>+ </p>
<p>Vpm_DcmWriteData(uint32, uint32, uint8*) : VpmResultType</p>
<p>+ </p>
<p>Vpm_GetStatus() : VpmResultType</p>
<p>«interface»</p>
<p><b>DcmFbl</b></p>
<p>+ </p>
<p>&lt;OEM specific API set&gt;() : uint8 </p>
<p><b>RTE (PIM)</b></p>
<p>«interface»</p>
<p><b>PIM</b></p>
<p>+ </p>
<p>&lt;A2L symbols&gt;:  uint8,-16,-32; sint8,-16,-32; Array</p>
<p>«interface»</p>
<p><i><b>Vmm</b></i></p>
<p>+ </p>
<p><i>Vmm_Dcm_CommunicationControl(uint8, uint8, boolean, boolean) : void</i></p>
<p><b>Vmm</b></p>
<p>«use»</p>
<p>«use»</p>
<p>«implement»</p>
<p>«implement»</p>
<p>«use»</p>
<p>«implement»</p>
<p>«use»</p>
<p>«use»</p>
<p>«implement»</p>
<p>«use»</p>
<p>«implement»</p>
<p>«use»</p>
<p>«implement»</p>
<p>«implement»</p>
<p>«implement»</p>
<p>«use»</p>
<p>«implement»</p>
<p>«implement»</p>
<p>«implement»</p>
<p>«use»</p>
<p>«implement»</p>
<p>use</p>
<p>«use»</p>
<p>«use»</p>
<p> </p>
<p>Figure 8-1 </p>
<p>DCM interactions with other BSWs </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>102 / 163 </p>
<p><b>8.2 </b></p>
<p><b>Services Provided by DCM </b></p>
<p>The DCM API consists of services, which are realized by function calls. </p>
<p> </p>
<p><b>8.2.1 </b></p>
<p><b>Dcm_GetSesCtrlType </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>Dcm_GetSesCtrlType </b>(Dcm_SesCtrlType *SessionCtrlType) </p>
<p><b>Parameter </b></p>
<p>SessionCtrlType </p>
<p>A pointer to variable where the current session value will be stored </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>Operation successful </p>
<p><b>Functional Description </b></p>
<p>This API provides to the caller the currently active diagnostic session value. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>None </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>May be called from interrupt context or on task level </p>
<p>Table 8-1  </p>
<p>Dcm_SessionCtrlType </p>
<p> </p>
<p><b>8.2.2 </b></p>
<p><b>Dcm_GetSecurityLevel </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>Dcm_GetSecurityLevel </b>(Dcm_SecLevelType *</p>
<p> </p>
<p>SecLevel) </p>
<p><b>Parameter </b></p>
<p>SecLevel </p>
<p>A pointer to variable where the current security access value will be stored </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>Operation successful </p>
<p><b>Functional Description </b></p>
<p>This API provides to the caller the currently active security access value. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>None </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>May be called from interrupt context or on task level </p>
<p>Table 8-2  </p>
<p>Dcm_GetSecurityLevel </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>103 / 163 </p>
<p><b>8.3 </b></p>
<p><b>Services Used by DCM </b></p>
<p>In the following table services provided by other components, which are used by the DCM </p>
<p>are listed. For details about prototype and functionality refer to the documentation of the </p>
<p>providing component. </p>
<p> </p>
<p><b>Component </b></p>
<p><b>API </b></p>
<p>DET </p>
<p>Det_ReportError </p>
<p>DEM </p>
<p>Dem_SetDTCFilter </p>
<p>Dem_GetNumberOfFilteredDTC </p>
<p>Dem_GetNextFilterdDTC </p>
<p>Dem_GetNextFilteredDTCAndFDC </p>
<p>Dem_GetNextFilteredRecord </p>
<p>Dem_GetNextFilteredDTCAndSeverity </p>
<p>Dem_GetViewIDOfDTC </p>
<p>Dem_GetStatusOfDTC </p>
<p>Dem_GetDTCStatusAvailabilityMask </p>
<p>Dem_GetDTCByOccurrenceTime </p>
<p>Dem_GetDTCOfFreezeFrameRecord </p>
<p>Dem_GetSizeOfFreezeFrame </p>
<p>Dem_GetFreezeFrameDataByDTC </p>
<p>Dem_GetFreezeFrameDataIdentifierByDTC </p>
<p>Dem_GetExtendedDataRecordByDTC </p>
<p>Dem_ClearDTC </p>
<p>Dem_DisableDTCStorage </p>
<p>Dem_EnableDTCStorage </p>
<p>Dem_DisableDTCRecordUpdate </p>
<p>Dem_EnableDTCRecordUpdate </p>
<p>Dem_GetSizeOfExtendedDataRecordByDTC </p>
<p>Dem_SetDTCFilterForRecords </p>
<p>Dem_GetSeverityOfDTC </p>
<p>Dem_GetTranslationType </p>
<p>Dem_GetDTCSeverityAvailabilityMask (only for the WWH-OBD use case) </p>
<p>Dem_GetOBDFreezeFrameData (only for the OBD use case) </p>
<p>PduR </p>
<p>PduR_DcmTransmit </p>
<p>MCU </p>
<p>Mcu_PerformReset </p>
<p>EcuM </p>
<p>EcuM_KillAllRUNRequests </p>
<p>EcuM_SelectShutdownTarget </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>104 / 163 </p>
<p><b>Component </b></p>
<p><b>API </b></p>
<p>NvM </p>
<p>NvM_ReadBlock </p>
<p>NvM_WriteBlock </p>
<p>NvM_SetBlockLockStatus </p>
<p>NvM_GetErrorStatus </p>
<p>ComM </p>
<p>ComM_DCM_ActiveDiagnostic </p>
<p>ComM_DCM_InactiveDiagnostic </p>
<p>Table 8-3  </p>
<p>Services used by the DCM </p>
<p><b>DirectMemoryAccess </b></p>
<p><i>Dcm_CheckMemory </i></p>
<p><i>Dcm_ReadMemory </i></p>
<p><i>Dcm_WriteMemory </i></p>
<p><b>EcuM </b></p>
<p>EcuM_GeneratorCompatibilityError (see [8]) </p>
<p><b>JumpTo/FromFBL </b></p>
<p><i>Dcm_SetProgConditions </i></p>
<p><i>Dcm_GetProgConditions </i></p>
<p><b>UnspecifiedServices </b></p>
<p><i>Dcm_CheckUnspecifiedService </i></p>
<p><i>Dcm_HandleUnspecifiedService </i></p>
<p><i>Dcm_PostHandleUnspecifiedService </i></p>
<p>Table 8-4  </p>
<p>Services beyond AUTOSAR used by the DCM </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>8.3.1 </b></p>
<p><b>Direct Memory Access </b></p>
<p>DCM uses the following API to get read and write access to the controller memory, if the </p>
<p>AR  4.0  memory  access  API  is  enabled  (please  refer  to  chapter <i> 6.1.1.1  AR  4.0  Like </i></p>
<p><i>Memory Access Interface </i>for more information). </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>105 / 163 </p>
<p><b>8.3.1.1 </b></p>
<p><b>Dcm_CheckMemory </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType Dcm_CheckMemory( Dcm_MemMgrOpType MemOp, </p>
<p>                                uint8            MemoryIdentifier,  </p>
<p>                                uint32           MemoryAddress, </p>
<p>                                uint32           MemorySize,  </p>
<p>                                Dcm_NegativeResponseCodeType*                        </p>
<p>                                                 ErrorCode) </p>
<p><b>Parameter </b></p>
<p>MemOp </p>
<p> </p>
<p>MemoryIdentifier </p>
<p>MemoryAddress </p>
<p>MemorySize </p>
<p>ErrorCode </p>
<p>IN parameter that specifies the requested operation. Valid values are: </p>
<p><b>DCM_MEM_OP_READ </b>and <b>DCM_MEM_OP_WRITE</b>. </p>
<p>IN parameter that contains the requested MID </p>
<p>IN parameter that specifies the memory block start address </p>
<p>IN parameter that specifies the memory block length </p>
<p>OUT parameter that shall be used for unknown, invalid or secured memory </p>
<p>ranges </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p> </p>
<p>Operation was successful </p>
<p>Any other return value will enforce DCM to send NRC $10 (GeneralReject) </p>
<p>and throw a DET report. </p>
<p><b>Functional Description </b></p>
<p>This API will be called for any valid service $23, $2C $02 and $3D request. The application shall check </p>
<p>whether the requested memory range is valid and allowed for the concrete operation type or not. If the </p>
<p>requested parameters do not match any valid range or the range is secured while the ECU is in locked </p>
<p>state, the application shall set the appropriate NRC into the ErrorCode parameter.  </p>
<p> </p>
<p>The information about current session and security level is accessible through the DCM provided ports: </p>
<p><i>Dcm_GetSesCtrlType </i>and <i>Dcm_GetSecurityLevel</i>. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>If service $23 and/or $3D are supported and DCM configuration does not contain any memory range </p>
<p>information or DCM is preconfigured to ignore any available memory range configuration. </p>
<p></p>
<p> </p>
<p>Available only in DCM version 4.01.00 and later. </p>
<p></p>
<p> </p>
<p>If the memory identifier is not supported for the OEM, the value of the parameter will be 0. </p>
<p></p>
<p> </p>
<p>This API is synchronous – the application shall decide immediately whether the requested data is valid </p>
<p>or not. </p>
<p></p>
<p> </p>
<p>It is not required the application to check parameter values that may cause overflow (e.g. (requested </p>
<p>address + requested size) &gt; MAX_UINT)). This is already performed within DCM. </p>
<p>Expected Caller Context </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>106 / 163 </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-5  </p>
<p>Dcm_CheckMemory </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>107 / 163 </p>
<p><b>8.3.1.2 </b></p>
<p><b>Dcm_ReadMemory </b></p>
<p><b>Prototype </b></p>
<p>Dcm_ReturnReadMemoryType Dcm_ReadMemory(uint8  MemoryIdentifier,  </p>
<p>                                        uint32 MemoryAddress, </p>
<p>                                        uint32 MemorySize,  </p>
<p>                                        uint8* MemoryData) </p>
<p><b>Parameter </b></p>
<p>MemoryIdentifier </p>
<p>MemoryAddress </p>
<p>MemorySize </p>
<p>MemoryData </p>
<p>IN parameter that contains the requested MID. </p>
<p>IN parameter that specifies the memory block start address </p>
<p>IN parameter that specifies the memory block length </p>
<p>OUT parameter that specifies the diagnostic buffer start address to copy the </p>
<p>data into </p>
<p><b>Return code </b></p>
<p>DCM_READ_OK </p>
<p>DCM_READ_PENDING </p>
<p>DCM_READ_FAILED </p>
<p>Operation was successful </p>
<p>Operation still not complete – call again </p>
<p>Operation failed – NRC $22 (ConditionsNotCorrect) will be sent back. </p>
<p>Any other return value will enforce DCM to send NRC $10 (GeneralReject) </p>
<p>and throw a DET report. </p>
<p><b>Functional Description </b></p>
<p>This API will be called for all valid service $23 requests.  </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>If service $23 supported and DCM was configured to use the AR 4.0 like memory APIs. </p>
<p></p>
<p> </p>
<p>Available only in DCM version 3.12.00 and above </p>
<p></p>
<p> </p>
<p>If the memory identifier is not supported for the OEM, the value of the parameter will be 0. </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-6  </p>
<p>Dcm_ReadMemory </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>108 / 163 </p>
<p><b>8.3.1.3 </b></p>
<p><b>Dcm_WriteMemory </b></p>
<p><b>Prototype </b></p>
<p>Dcm_ReturnWriteMemoryType Dcm_WriteMemory(uint8  MemoryIdentifier,  </p>
<p>                                          uint32 MemoryAddress, </p>
<p>                                          uint32 MemorySize,  </p>
<p>                                          uint8* MemoryData) </p>
<p><b>Parameter </b></p>
<p>MemoryIdentifier </p>
<p>MemoryAddress </p>
<p>MemorySize </p>
<p>MemoryData </p>
<p>IN parameter that contains the requested MID. </p>
<p>IN parameter that specifies the memory block start address </p>
<p>IN parameter that specifies the memory block length </p>
<p>IN parameter that specifies the diagnostic buffer start address to copy the data </p>
<p>from </p>
<p><b>Return code </b></p>
<p>DCM_WRITE_OK </p>
<p>DCM_WRITE_PENDING </p>
<p>DCM_WRITE_FAILED </p>
<p>Operation was successful </p>
<p>Operation still not complete – call again </p>
<p>Operation failed – NRC $22 (ConditionsNotCorrect) will be sent back. </p>
<p>Any other return value will enforce DCM to send NRC $10 (GeneralReject) </p>
<p>and throw a DET report. </p>
<p><b>Functional Description </b></p>
<p>This API will be called for all valid service $3D requests.  </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>If service $3D supported and DCM was configured to use the AR 4.0 like memory APIs. </p>
<p></p>
<p> </p>
<p>Available only in DCM version 3.12.00 and above </p>
<p></p>
<p> </p>
<p>If the memory identifier is not supported for the OEM, the value of the parameter will be 0. </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-7  </p>
<p>Dcm_WriteMemory </p>
<p><b>8.3.2 </b></p>
<p><b>Unspecified Service Handling </b></p>
<p>The following API applies to the feature unspecified service handling. For details about the </p>
<p>feature, please refer to chapter <i>6.5 Support of Unspecified Services</i>. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>109 / 163 </p>
<p><b>8.3.2.1 </b></p>
<p><b>Dcm_CheckUnspecifiedService </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType Dcm_CheckUnspecifiedService(uint8 sid </p>
<p>                                          ,boolean hasSprmib) </p>
<p><b>Parameter </b></p>
<p>sid </p>
<p>hasSprmib </p>
<p>Contains the requested SID. </p>
<p>An output parameter, which shall specify whether the SID supports the </p>
<p>SPRMIB or not.  </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p>The SID is supported, proceeed with the service processing </p>
<p>The SID is not supported; proceed with standard procedure on not supported </p>
<p>SID. </p>
<p><b>Functional Description </b></p>
<p>This API is called each time DCM receives an unknown (not existing in the DCM configuration) service </p>
<p>identifier. The application shall be able immediately to decide whether the requested SID is supported or </p>
<p>not.  </p>
<p>If the SID is unknown to the application too, the return value shall be DCM_E_NOT_OK. </p>
<p>In case the SID is supported by the application, the return value shall be DCM_E_OK. The output </p>
<p>parameter <b>hasSprmib </b>shall be set to TRUE if the SID supports the SPRMIB (i.e. is a sub-function). In this </p>
<p>way DCM will automatically suppress the positive response later.  </p>
<p>Note: </p>
<p>- </p>
<p>If the output parameter <b>hasSprmib </b>is not initialized within this API, DCM will consider it as FALSE. </p>
<p>- </p>
<p>If the output parameter <b>hasSprmib </b>is set to TRUE, DCM will mask bit 7 of the first byte after the </p>
<p>SID, so later in the <i>Dcm_HandleUnspecifiedService </i>you will always receive the sub-function </p>
<p>without the SPRMIB. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Available only in DCM versions 4.03.00 and later. </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-8  </p>
<p>Dcm_CheckUnspecifiedService </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>110 / 163 </p>
<p><b>8.3.2.2 </b></p>
<p><b>Dcm_HandleUnspecifiedService </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType Dcm_HandleUnspecifiedService(uint8 sid </p>
<p>                             ,Dcm_MsgType requestPtr </p>
<p>                             ,Dcm_MsgLenType reqDataLen </p>
<p>                             ,Dcm_MsgType responsePtr </p>
<p>                             ,Dcm_MsgLenPtrType resDataLenPtr </p>
<p>                             ,Dcm_NegativeResponseCodePtrType errorPtr) </p>
<p><b>Parameter </b></p>
<p>sid </p>
<p>requestPtr </p>
<p>reqDataLen </p>
<p>responsePtr </p>
<p> </p>
<p>resDataLenPtr </p>
<p>errorPtr </p>
<p>Contains the requested SID. </p>
<p>Points to the first byte after the SID in the request message. </p>
<p>Contains the requested data length (the SID byte is excluded). </p>
<p>Points to the first byte after the response SID in the positive response </p>
<p>message. </p>
<p>An output parameter that will contain the positive response length (excluding </p>
<p>the SID). </p>
<p>An output parameter that will return the operation result expressed as NRC. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>Service processing has finished (with or without success) </p>
<p>Service processing not finished yet, call again. </p>
<p>Note: Any other value will end up with NRC 0x10(GeneralReject) and DET </p>
<p>activation. </p>
<p><b>Functional Description </b></p>
<p>Once the application has confirmed that an unspecified requested SID is a valid one in the </p>
<p><i>Dcm_CheckUnspecifiedService</i>, DCM will delegate the service processing handlig to the application by </p>
<p>calling this API. </p>
<p>If the application can not finish the service processing immediately (i.e. shall wait for final result from </p>
<p>another component), the return value shall be DCM_E_PENDING; to give DCM task enough time to </p>
<p>manage the P2 timing monitoring. </p>
<p>If the service has some sub-service information it can be dispatched using the <b>requestPtr </b>parameter. The </p>
<p>length check is performed by using the <b>reqDataLen </b>parameter. </p>
<p>If the service shall return some data back to the tester (e.g. the requested sub-function must be returned </p>
<p>too), the <b>responsePtr </b>parameter shall be used as target buffer reference. In this case also the </p>
<p><b>resDataLenPtr </b>parameter shall be set to the corresponding amount of copied data. </p>
<p>Once the application has finished the requested job (with or without success), the return value shall be </p>
<p>DCM_E_OK. If there shall be a negative response sent, the <b>errorPtr </b>parameter shall be set with the </p>
<p>appropriate NRC.  </p>
<p> </p>
<p>Note: </p>
<p>- </p>
<p>If not set, the <b>errorPtr </b>parameter will be considered as DCM_E_OK. </p>
<p>- </p>
<p>If not set, the <b>resDataLen </b>parameter will be considered as zero (only SID will be returned). </p>
<p><b>Particularities and Limitations </b></p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>111 / 163 </p>
<p></p>
<p> </p>
<p>On each call of this API, the <b>resDataLen </b>parameters will be set to zero! </p>
<p></p>
<p> </p>
<p>Available only in DCM versions 4.03.00 and later. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-9  </p>
<p>Dcm_HandleUnspecifiedService </p>
<p><b>8.3.2.3 </b></p>
<p><b>Dcm_PostHandleUnspecifiedService </b></p>
<p><b>Prototype </b></p>
<p>void Dcm_PostHandleUnspecifiedService(uint8 sid </p>
<p>                                 ,Dcm_ConfirmationStatusType status) </p>
<p><b>Parameter </b></p>
<p>sid </p>
<p>status </p>
<p>Contains the requested SID. </p>
<p>Indicates the final result of the service execution. </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>Once the application has finished its job on the requested unspecified service in the </p>
<p><i>Dcm_HandleUnspecifiedService</i>, DCM will react according to the result of service execution and finally call </p>
<p>this API. </p>
<p>The status parameter can have one of the following values: </p>
<p>DCM_RES_POS_OK – The requested service has been succefully executed. </p>
<p>DCM_RES_POS_NOT_OK - The requested service has been succefully executed, but the positive </p>
<p>response could not be sent </p>
<p>DCM_RES_NEG_OK - The requested service has ended with a negative response. </p>
<p>DCM_RES_NEG_NOT_OK – The requested service has ended with a negative response, but the </p>
<p>response message could not be sent. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Available only in DCM versions 4.03.00 and later. </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-10  </p>
<p>Dcm_PostHandleUnspecifiedService </p>
<p><b>8.3.3 </b></p>
<p><b>Jump To/From FBL </b></p>
<p>DCM supports the jump into resp. from the FBL as proposed in AR 4.0. The following APIs </p>
<p>shall  be  implemented  in  the  DCM  application  in  order  to  exchange  required  information </p>
<p>between the FBL and DCM. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>112 / 163 </p>
<p><b>8.3.3.1 </b></p>
<p><b>Dcm_SetProgConditions </b></p>
<p><b>Prototype </b></p>
<p>void Dcm_SetProgConditions (<i>Dcm_ProgConditionsType </i>*ProgConditions) </p>
<p><b>Parameter </b></p>
<p>ProgConditions </p>
<p>Contains all of the information needed by the FBL to send the final response. </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>Once DCM receives a diagnostic service to jump into the FBL (e.g. 0x10 0x02/0x82), it will call this API to </p>
<p>prepare the FBL for sending the final response.  </p>
<p>Refer to chapter <i>10.2.5.2 AR 4.0 like Jump to/from the FBL </i>for details about API usage. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Available only in DCM versions 4.05.00 and later. </p>
<p></p>
<p> </p>
<p>The application shall copy the content referenced by the function parameter, since after returning from </p>
<p>the call, the pointer is no more valid. </p>
<p></p>
<p> </p>
<p>The “EcuStartMode” member value shall not be evaluated. It is currently initialized with the value </p>
<p>DCM_WARM_START only for consistency purpose. The call of this API will always precede a reset </p>
<p>triggering in DCM, and it is always intended for a FBL jump. </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-11  </p>
<p>Dcm_SetProgConditions </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>113 / 163 </p>
<p><b>8.3.3.2 </b></p>
<p><b>Dcm_GetProgConditions </b></p>
<p><b>Prototype </b></p>
<p>void Dcm_GetProgConditions (<i>Dcm_ProgConditionsType </i>*ProgConditions) </p>
<p><b>Parameter </b></p>
<p>ProgConditions </p>
<p>Contains all of the information needed by the DCM to send the final response. </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>Once the ECU has booted, the very first Dcm_MainFunction (Dcm_StateTask) activation will call this API to </p>
<p>check whether DCM shall send a final response of the FBL or not. If the “EcuStartMode” parameter </p>
<p>specifies that a response shall be triggered, DCM evaluates the remained parameters to determine which </p>
<p>tester connection shall be used for the transmission. If this detection fails to find a supported connection, a </p>
<p>DET will be triggered and no response will be sent. </p>
<p>Refer to chapter <i>10.2.5.2 AR 4.0 like Jump to/from the FBL </i>for details about API usage. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Available only in DCM versions 4.05.00 and later. </p>
<p></p>
<p> </p>
<p>The application shall copy the content referenced by the function parameter, since after returning from </p>
<p>the call, the pointer is no more valid. </p>
<p></p>
<p> </p>
<p>Once this API is called, and all of the information is copied to DCM, the application shall reset the </p>
<p>related memory to prevent from repeated response transmission by DCM on the next ECU boot. </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Will be called from Dcm_MainFunction context </p>
<p>Table 8-12  </p>
<p>Dcm_GetProgConditions </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>114 / 163 </p>
<p><b>8.3.3.3 </b></p>
<p><b>Dcm_EcuStartModeType </b></p>
<p><b>Item Name </b></p>
<p><b>C-Type </b></p>
<p><b>Value </b></p>
<p><b>Description </b></p>
<p>DCM_COLD_START</p>
<p> </p>
<p>uint8 </p>
<p>0x00 </p>
<p>Normal ECU boot mode. DCM will not send any </p>
<p>response. </p>
<p>DCM_WARM_START</p>
<p> </p>
<p>uint8 </p>
<p>0x01 </p>
<p>Reset through the FBL. DCM will evaluate the </p>
<p>FBL parameters and send the appropriate final </p>
<p>response. </p>
<p>Table 8-13  </p>
<p>Dcm_EcuStartModeType </p>
<p><b>8.3.3.4 </b></p>
<p><b>Dcm_ProgConditionsType </b></p>
<p><b>Struct Element </b></p>
<p><b>Name </b></p>
<p><b>C-Type </b></p>
<p><b>Values </b></p>
<p><b>Description </b></p>
<p>TesterSourceAddr </p>
<p>uint8 </p>
<p>0x00- </p>
<p>0xFF </p>
<p>Specifies the tester address to send </p>
<p>the response to. </p>
<p>Sid </p>
<p>uint8 </p>
<p>0x10, </p>
<p>0x11 </p>
<p>Specifies the Sid to be responded to. </p>
<p>SubFncId </p>
<p>uint8 </p>
<p>0x00-</p>
<p>0x7F </p>
<p>Specifies the sub-function of the Sid </p>
<p>that will be responded. Currently </p>
<p>supported combinations are: </p>
<p>Sid = 0x10, SubFncId = 0x01 </p>
<p>Sid = 0x11, SubFuncId = Any except </p>
<p>0x04 and 0x05. </p>
<p>EcuStartMode </p>
<p><i>Dcm_EcuStartModeType </i></p>
<p>- </p>
<p>Specifies whether the DCM shall </p>
<p>send a final response or not. </p>
<p>Table 8-14  </p>
<p>Dcm_ProgConditionsType </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>115 / 163 </p>
<p><b>8.4 </b></p>
<p><b>Callback Functions </b></p>
<p>This chapter describes the callback functions that are implemented by the DCM and can </p>
<p>be invoked by other modules. The prototypes of the callback functions are provided in the </p>
<p>header file Dcm_Cbk.h by the DCM. </p>
<p> </p>
<p><b>8.4.1 </b></p>
<p><b>ComManager Callbacks </b></p>
<p><b>8.4.1.1 </b></p>
<p><b>Dcm_ComM_NoComModeEntered </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_ComM_NoComModeEntered </b>(void) </p>
<p><b>Parameter </b></p>
<p>- </p>
<p> </p>
<p><b>Return code </b></p>
<p>- </p>
<p> </p>
<p><b>Functional Description </b></p>
<p>Notifies DCM that the communication is disabled (both Rx and Tx paths). </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>none </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Can be called from interrupt context </p>
<p>Table 8-15  </p>
<p>Dcm_ComM_NoComModeEntered </p>
<p><b>8.4.1.2 </b></p>
<p><b>Dcm_ComM_SilentComModeEntered </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_ComM_SilentComModeEntered </b>(void) </p>
<p><b>Parameter </b></p>
<p>- </p>
<p> </p>
<p><b>Return code </b></p>
<p>- </p>
<p> </p>
<p><b>Functional Description </b></p>
<p>Notifies DCM that the communication is disabled (only Tx paths, reception is still possible). </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>none </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Can be called from interrupt context </p>
<p>Table 8-16  </p>
<p>Dcm_ComM_SilentComModeEntered </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>116 / 163 </p>
<p><b>8.4.1.3 </b></p>
<p><b>Dcm_ComM_FullComModeEntered </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_ComM_FullComModeEntered </b>(void) </p>
<p><b>Parameter </b></p>
<p>- </p>
<p> </p>
<p><b>Return code </b></p>
<p>- </p>
<p> </p>
<p><b>Functional Description </b></p>
<p>Notifies DCM that full communication is enabled (both Rx and Tx paths). </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>none </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Can be called from interrupt context </p>
<p>Table 8-17  </p>
<p>Dcm_ComM_FullComModeEntered </p>
<p><b>8.4.2 </b></p>
<p><b>PduRouter Callbacks </b></p>
<p><b>8.4.2.1 </b></p>
<p><b>Dcm_ProvideRxBuffer </b></p>
<p><b>Prototype </b></p>
<p>BufReq_ReturnType <b>Dcm_ProvideRxBuffer </b>(</p>
<p>PduIdType DcmRxPduId, PduLengthType </p>
<p>TpSduLength, PduInfoType** PduInfoPtr</p>
<p>) </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>TpSduLength </p>
<p>PduInfoPtr </p>
<p>The RxPduId on which the request is received. </p>
<p>The total request message length. </p>
<p>Pointer to a pointer for the returned buffer address- and size-information. </p>
<p><b>Return code </b></p>
<p>BUFREQ_OK </p>
<p> </p>
<p>BUFREQ_E_OVFL </p>
<p> </p>
<p>BUFREQ_E_NOT_OK </p>
<p>Returned if there is free buffer to accept the message and the whole request </p>
<p>will fit into this buffer. </p>
<p>Returned if there is free buffer to accept the message but the whole request </p>
<p>will NOT fit into this buffer. </p>
<p>Returned if there is NO free buffer to accept the message. </p>
<p><b>Functional Description </b></p>
<p>Requires a free buffer from DCM to write the requested message into. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>none </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Can be called from interrupt context </p>
<p>Table 8-18  </p>
<p>Dcm_ProvideRxBuffer </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>117 / 163 </p>
<p><b>8.4.2.2 </b></p>
<p><b>Dcm_RxIndication </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_RxIndication </b>(</p>
<p>PduIdType DcmRxPduId, NotifResultType Result</p>
<p>) </p>
<p><b>Parameter </b></p>
<p>DcmRxPduId </p>
<p>Result </p>
<p>The RxPduId on which the request is received. </p>
<p>The reception result. </p>
<p><b>Return code </b></p>
<p>- </p>
<p> </p>
<p><b>Functional Description </b></p>
<p>Notifies DCM that the reception on the connection identifier by the RxPduId has finished. The result </p>
<p>parameter specifies the reception status. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>none </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Can be called from interrupt context </p>
<p>Table 8-19  </p>
<p>Dcm_RxIndication </p>
<p><b>8.4.2.3 </b></p>
<p><b>Dcm_ProvideTxBuffer </b></p>
<p><b>Prototype </b></p>
<p>BufReq_ReturnType <b>Dcm_ProvideTxBuffer </b>(</p>
<p>PduIdType DcmTxPduId, PduInfoType** </p>
<p>PduInfoPtr, PduLengthType TpSduLength</p>
<p>) </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>PduInfoPtr </p>
<p>TpSduLength </p>
<p>The TxPduId on which the response is being sent. </p>
<p>Points to pointer of the returned buffer address and size information. </p>
<p>The minimum required portion length. </p>
<p><b>Return code </b></p>
<p>BUFREQ_OK </p>
<p>BUFREQ_E_BUSY </p>
<p>BUFREQ_E_NOT_OK </p>
<p>Returned if there was enough data to be transferred. </p>
<p>Returned if there is currently no data to be filled in (temporary buffer-</p>
<p>underrun), so another call is expected. </p>
<p>Returned if there is NO more data to be sent (permanent buffer-underrun) and </p>
<p>no further calls of this API are expected. </p>
<p><b>Functional Description </b></p>
<p>Requires a buffer from which to send the response data. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>none </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Can be called from interrupt context </p>
<p>Table 8-20  </p>
<p>Dcm_ProvideTxBuffer </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>118 / 163 </p>
<p><b>8.4.2.4 </b></p>
<p><b>Dcm_TxConfirmation </b></p>
<p><b>Prototype </b></p>
<p>void <b>Dcm_TxConfirmation </b>(</p>
<p>PduIdType DcmTxPduId, NotifResultType Result</p>
<p>) </p>
<p><b>Parameter </b></p>
<p>DcmTxPduId </p>
<p>Result </p>
<p>The TxPduId on which the request is received. </p>
<p>The transmission result. </p>
<p><b>Return code </b></p>
<p>- </p>
<p> </p>
<p><b>Functional Description </b></p>
<p>Notifies DCM that the response transmission on the connection identifier by the TxPduId has finished. The </p>
<p>result parameter specifies the transmission status. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>none </p>
<p>Expected Caller Context </p>
<p></p>
<p> </p>
<p>Can be called from interrupt context </p>
<p>Table 8-21  </p>
<p>Dcm_TxConfirmation </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>119 / 163 </p>
<p><b>8.5 </b></p>
<p><b>Service Ports </b></p>
<p>In case DCM is used in software environment with RTE, the following service ports will be </p>
<p>used  to  transfer  data  to  and  from  the  application.  If  no  RTE  is  available,  DCM  will </p>
<p>communicate  with  the  application  directly  via  function  calls  having  the  same  function </p>
<p>prototypes like the ones generated by the RTE.  </p>
<p><b>8.5.1 </b></p>
<p><b>Client Server Interface </b></p>
<p>A client server interface is related to a Provide Port at the server side and a Require Port </p>
<p>at client side.  </p>
<p><b>8.5.1.1 </b></p>
<p><b>Provide Ports </b></p>
<p>At  the  Provide  Ports  of  the  DCM  the  API  functions  described  in  8.2  are  available  as </p>
<p>Runnable Entities. The Runnable Entities are invoked via Operations. The mapping from a </p>
<p>SWC client call to an Operation is performed by the RTE. In this mapping the RTE adds </p>
<p>Port Defined Argument Values to the client call of the SWC, if configured. </p>
<p>The following  table presents  the  Provide  Ports  defined for the  DCM  and  the  Operations </p>
<p>defined  for  the  Provide  Ports,  the API  functions  related  to  the  Operations  and  the  Port </p>
<p>Defined Argument Values to be added by the RTE: </p>
<p> </p>
<p><b>Provide Port </b></p>
<p><b>Operation </b></p>
<p><b>API Function </b></p>
<p><b>Port Defined Argument Values </b></p>
<p>DCMServices </p>
<p>GetSesCtrlType </p>
<p><i>Dcm_GetSesCtrlType </i></p>
<p>Dcm_SesCtrlType SessionControlType </p>
<p>GetSecurityLevel </p>
<p><i>Dcm_GetSecurityLevel </i></p>
<p>Dcm_SecLevelType SecLevel </p>
<p>Table 8-22  </p>
<p>Provide Ports on BSW module side </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>120 / 163 </p>
<p><b>8.5.1.2 </b></p>
<p><b>Require Ports </b></p>
<p>At its Require Ports the DCM calls Operations. These Operations have to be provided by </p>
<p>the  SWCs  by  means  of  Runnable  Entities.  These  Runnable  Entities  implement  the </p>
<p>callback functions expected by the DCM. </p>
<p>This document describes only the ports that are not described in details within the DCM </p>
<p>SWS document or are specific for the vendor’s implementation. </p>
<p>The following table presents the Require Ports defined for the  DCM, the Operations that </p>
<p>are  called  from  the  DCM  and  the  related  Notifications,  which  are  described  in  below </p>
<p>chapters: </p>
<p><b>Require Port </b></p>
<p><b>Operation </b></p>
<p><b>Notification </b></p>
<p>SessionControl </p>
<p>GetSesChgPermission </p>
<p><i>&lt;CallPrefix&gt;SessionControl_GetSesChgPermissi</i></p>
<p><i>on </i></p>
<p>2)</p>
<p> </p>
<p>ChangeIndication </p>
<p><i>&lt;CallPrefix&gt;SessionControl_ChangeIndication</i></p>
<p> 2)</p>
<p> </p>
<p>ConfirmationRespPending </p>
<p><i>&lt;CallPrefix&gt;SessionControl_ConfirmationRespP</i></p>
<p><i>ending </i></p>
<p>2)</p>
<p> </p>
<p>ResetService </p>
<p>EcuReset </p>
<p><i>&lt;CallPrefix&gt;ResetService_EcuReset </i></p>
<p>2)</p>
<p> </p>
<p>DidServices_&lt;DID&gt; </p>
<p>ConditionCheckRead </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheck</i></p>
<p><i>Read </i></p>
<p>1)</p>
<p> </p>
<p>2) </p>
<p>ReadDataLength </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLengt</i></p>
<p><i>h </i></p>
<p>1)</p>
<p> </p>
<p>2) </p>
<p>ReadData </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData </i></p>
<p>1)</p>
<p> </p>
<p>2) </p>
<p>ConditionCheckWrite </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheck</i></p>
<p><i>Write </i></p>
<p>1)</p>
<p> </p>
<p>2) </p>
<p>WriteData </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteData </i></p>
<p>1)</p>
<p> </p>
<p>2) </p>
<p>ReturnControlToECU </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnControlT</i></p>
<p><i>oECU </i></p>
<p>1)</p>
<p> </p>
<p>2) </p>
<p>ResetToDefault  </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ResetToDefault </i></p>
<p>1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>FreezeCurrentState </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_FreezeCurrentS</i></p>
<p><i>tate </i></p>
<p>1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>ShortTermAdjustement</p>
<p> </p>
<p><i>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ShortTermAdjus</i></p>
<p><i>tment </i></p>
<p>1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>SecurityAccess_&lt;LEVEL&gt; </p>
<p>GetSeed </p>
<p><i>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_GetSeed </i></p>
<p>2) 3)</p>
<p><i> </i></p>
<p>CompareKey </p>
<p><i>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_Compare</i></p>
<p><i>Key </i></p>
<p>2) 3)</p>
<p> </p>
<p>RoutineServices_&lt;RID&gt;</p>
<p> </p>
<p>Start </p>
<p><i>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Start </i></p>
<p>1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>Stop </p>
<p><i>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Stop </i></p>
<p>1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>RequestResults </p>
<p><i>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_RequestRe</i></p>
<p><i>sults </i></p>
<p>1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>Table 8-23  </p>
<p>Require Ports on BSW module side </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>121 / 163 </p>
<p> </p>
<p> </p>
<p><b>Require Port </b></p>
<p><b>Operation </b></p>
<p><b>Notification </b></p>
<p>ComControl </p>
<p>CheckCondition </p>
<p><i>&lt;CallPrefix&gt;ComControl_CheckCondition </i></p>
<p>2)</p>
<p> </p>
<p>Table 8-24  </p>
<p>Require Ports beyond AUTOSAR on BSW module side, ComControl </p>
<p><b>Require Port </b></p>
<p><b>Operation </b></p>
<p><b>Notification </b></p>
<p>PidServices_&lt;PID&gt; </p>
<p>GetPIDValue </p>
<p><i>&lt;CallPrefix&gt;PidServices_&lt;PID&gt;_GetPIDValue</i></p>
<p> 1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>DTRServices_&lt;MIDTID&gt; </p>
<p>GetDTRValue </p>
<p><i>&lt;CallPrefix&gt;DTRServices_&lt;MIDTID&gt;_GetDTRVa</i></p>
<p><i>lue</i></p>
<p> 2)</p>
<p> </p>
<p>RequestControlServices_&lt;</p>
<p>TID&gt; </p>
<p>RequestControl </p>
<p><i>&lt;CallPrefix&gt;RequestControlServices_&lt;TID&gt;_Req</i></p>
<p><i>uestControl</i></p>
<p> 1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>InfoTypeServices_&lt;INFID&gt; </p>
<p>GetInfoType </p>
<p><i>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_GetInfoT</i></p>
<p><i>ypeValue</i></p>
<p> 1)</p>
<p> </p>
<p>2)</p>
<p> </p>
<p>ReadDataLength </p>
<p><i>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_ReadDat</i></p>
<p><i>aLength</i></p>
<p><i> </i></p>
<p>Table 8-25  </p>
<p>Require Ports beyond AUTOSAR on BSW module side, OBD </p>
<p>1)</p>
<p> </p>
<p>The &lt;DID&gt; (resp. &lt;RID&gt;, &lt;PID&gt;, &lt;TID&gt;, &lt;INFID&gt;) could be either the ID in its digital </p>
<p>representation (e.g. “<b>0xf100</b>”) or the ID short name from the diagnostic data base source (e.g. </p>
<p>“<b>Fingerprint_appl_software_Id</b>”).  </p>
<p>The  selection of the  naming  convention and  its  configuration  aspect  is an  OEM  specific </p>
<p>requirement. </p>
<p> </p>
<p>2) </p>
<p>The call-back prefixes dependent on the availability of RTE. If RTE is available, the prefix </p>
<p>will be “<b>Rte_Call_</b>” otherwise “<b>Appl_Dcm_</b>”.  </p>
<p>3) </p>
<p>The  &lt;LEVEL&gt;  is  always  the  decimal  representation  of  the  corresponding  “get-seed” </p>
<p>subfunction  of  the  Level.  Example:  Service  $27  $0B  /  $0C  specify  the  security  level </p>
<p>“Unlocked_Programming”. </p>
<p>Then </p>
<p>the </p>
<p>port </p>
<p>interface </p>
<p>will </p>
<p>have </p>
<p>the </p>
<p>name: </p>
<p><b>&lt;CallPrefix&gt;SecurityAccess_11_GetSeed  </b></p>
<p>resp.  </p>
<p><b>&lt;CallPrefix&gt;SecurityAccess_11_CompareKey </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>122 / 163 </p>
<p><b>8.5.1.2.1 </b></p>
<p><b>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission </b>( </p>
<p>Dcm_SesCtrlType SesCtrlTypeActive,  </p>
<p>Dcm_SesCtrlType SesCtrlTypeNew) </p>
<p><b>Parameter </b></p>
<p>SesCtrlTypeActive </p>
<p> </p>
<p>SesCtrlTypeNew </p>
<p>- </p>
<p>Represents the currently active session in DCM (session transition </p>
<p>source state). </p>
<p>- </p>
<p>Represents the new session that requested to be activated in DCM </p>
<p>(session transition target state) </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p>DCM_E_SESSION_NOT_</p>
<p>ALLOWED </p>
<p>DCM_E_PENDING </p>
<p>DCM_E_FORCE_RCRRP </p>
<p>The requested session transition is accepted. </p>
<p>The application does not allow current session transition. </p>
<p>Same as DCM_E_NOT_OK. </p>
<p> </p>
<p>The application needs more time to take decision. Will be called again. </p>
<p>Enforces transmission of RCR-RP response. Will be called again. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM to give the application the opportunity to accept or </p>
<p>reject the requested session transition.  </p>
<p> </p>
<p>For the case DCM_E_FORCE_RCRRP the application will be additionally notified about the RCR-RP </p>
<p>transmission status via the function call <i>&lt;CallPrefix&gt;SessionControl_ConfirmationRespPending</i>. While the </p>
<p>RCR-RP message is on transmission, this service port will be called further. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>DiagnosticSessionControl ($10) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-26  </p>
<p>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>123 / 163 </p>
<p><b>8.5.1.2.2 </b></p>
<p><b>&lt;CallPrefix&gt;SessionControl_ChangeIndication </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;SessionControl_ChangeIndication </b>( </p>
<p>Dcm_SesCtrlType SesCtrlTypeOld,  </p>
<p>Dcm_SesCtrlType SesCtrlTypeNew) </p>
<p><b>Parameter </b></p>
<p>SesCtrlTypeOld </p>
<p> </p>
<p>SesCtrlTypeNew </p>
<p>- </p>
<p>Represents the currently active session in DCM (session transition </p>
<p>source state). </p>
<p>- </p>
<p>Represents the new session that requested to be activated in DCM </p>
<p>(session transition target state) </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p> </p>
<p>The requested session transition is accepted. </p>
<p>Has no effect since this is only an indication function. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM once the positive response for service $10 has been </p>
<p>successfully sent.  </p>
<p>Note: The return value is ignored. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>DiagnosticSessionControl ($10) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-27  </p>
<p>&lt;CallPrefix&gt;SessionControl_ChangeIndication </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>124 / 163 </p>
<p><b>8.5.1.2.3 </b></p>
<p><b>&lt;CallPrefix&gt;SessionControl_ConfirmationRespPending </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;SessionControl_ConfirmationRespPending</b>( </p>
<p>Dcm_ConfirmationStatusType status) </p>
<p><b>Parameter </b></p>
<p>status </p>
<p>- Can be one of the following values: </p>
<p>DCM_RES_NEG_OK - The enforced RCR-RP response is sent successfully </p>
<p>DCM_RES_NEG_NOT_OK – The enforced RCR-RP response could not be </p>
<p>sent. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p> </p>
<p>The requested operation is accepted. </p>
<p>Has no effect since this is only indication function. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM once the call </p>
<p><i>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission  </i>has returned DCM_E_FORCE_RCRRP.  </p>
<p> </p>
<p>Note: If the DET is not active the return value will be ignored. Otherwise it will be monitored for valid result </p>
<p>(i.e. one of the above listed). </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>DiagnosticSessionControl ($10) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-28  </p>
<p>&lt;CallPrefix&gt;SessionControl_ConfirmationRespPending </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>125 / 163 </p>
<p><b>8.5.1.2.4 </b></p>
<p><b>&lt;CallPrefix&gt;ComControl_CheckCondition </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;ComControl_CheckCondition </b>( </p>
<p>uint8 subNetId,  </p>
<p>uint8 msgType,  </p>
<p>boolean rxState,  </p>
<p>boolean txState) </p>
<p><b>Parameter </b></p>
<p>subNetId </p>
<p> </p>
<p>msgType </p>
<p>rxState </p>
<p>txState </p>
<p>The requested sub network id: all ($FF), current and specific. The last is not </p>
<p>supported. </p>
<p>Represents the message type(s) to be manipulated: APPL ($01), NM ($02) </p>
<p>and BOTH ($03). </p>
<p>Represents the RX path manipulation type (enable/disable) </p>
<p>Represents the RX path manipulation type (enable/disable) </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>DCM_E_COM_CTRL_NO</p>
<p>T_ACCEPTED </p>
<p>Communication control operation accepted. </p>
<p>The application needs more time to check the service execution condition. </p>
<p>The application does not allow the communication control operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM prior changing the communication state of the ECU. If </p>
<p>the application can not accept the communication state change, the </p>
<p>DCM_E_COM_CTRL_NOT_ACCEPTED shall be returned where as DCM will send negative response $22 </p>
<p>(ConditionsNotCorrect) back to the tester and will keep the current communication state. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>CommunicationControl ($28) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-29  </p>
<p>&lt;CallPrefix&gt;ComControl_CheckCondition </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>126 / 163 </p>
<p><b>8.5.1.2.5 </b></p>
<p><b>&lt;CallPrefix&gt;ResetService_EcuReset </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;ResetService_EcuReset </b>( </p>
<p>uint8 resetType,  </p>
<p>                             Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>resetType </p>
<p>errorCode </p>
<p>Contains the requested reset type (e.g. $01 – HardReset, etc.) </p>
<p>Pointer to the NRC register in DCM. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p>DCM_E_PENDING </p>
<p>Reset is accepted. </p>
<p>The application can not perform the check operation. </p>
<p>The application needs more time to check the service execution condition. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM prior executing the reset operation of the ECU. If the </p>
<p>application can not accept the requested reset type, the errorCode parameter shall be set with an </p>
<p>appropriate DCM_E_&lt;NRC&gt; code. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>EcuReset ($11) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-30  </p>
<p>&lt;CallPrefix&gt;ResetService_EcuReset </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>127 / 163 </p>
<p><b>8.5.1.2.6 </b></p>
<p><b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckRead </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckRead</b>( </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>ErrorCode </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>DID check operation successful (also for set NRC). </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid read data by identifier request </p>
<p>(service $22). The application use this call to evaluate any DID access conditions (other than diagnostic </p>
<p>session and security access which are checked by DCM) and reject the request by a specific NRC. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>ReadDataByIdentifier ($22) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-31  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckRead </p>
<p><b>8.5.1.2.7 </b></p>
<p><b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLength </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLength</b>( </p>
<p>uint16 *DidLength) </p>
<p><b>Parameter </b></p>
<p>DidLength </p>
<p>Returns the DID actual length. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>DID read length operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid read data by identifier request </p>
<p>(service $22) for a DID with dynamic length. The application shall set the actual DID length at the time of </p>
<p>the request.  </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>ReadDataByIdentifier ($22) </i>must be supported. </p>
<p></p>
<p> </p>
<p>The DID this port belongs to has a dynamic data length (defined at run-time e.g. 10-20bytes ASCII). </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-32  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadDataLength </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>128 / 163 </p>
<p><b>8.5.1.2.8 </b></p>
<p><b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *data) </p>
<p><b>Parameter </b></p>
<p>data </p>
<p>Pointer to the response buffer for the DID data. </p>
<p>The data type of this parameter depends on the actual length of the data to be </p>
<p>read. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>DCM_E_NOT_OK </p>
<p>DID read operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p>DID read operation failed- NRC 0x10 (GeneralReject) will be sent back. <b>This </b></p>
<p><b>return values is supported first in DCM ver. 4.01.00. </b></p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid read data by identifier request </p>
<p>(service $22) The application shall write the DID data to the specified buffer beginning by position 0.  </p>
<p> </p>
<p>Note: There is no paged-buffer support – all the data must be written linearly into the buffer. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>ReadDataByIdentifier ($22) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-33  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReadData </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>129 / 163 </p>
<p><b>8.5.1.2.9 </b></p>
<p><b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckWrite </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckWrite</b>( </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>ErrorCode </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>DID check operation successful (also for set NRC). </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid write data by identifier request </p>
<p>(service $2E). The application use this call to evaluate any DID access conditions (other than diagnostic </p>
<p>session and security access which are checked by DCM) and reject the request by a specific NRC. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>WriteDataByIdentifier ($2E) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-34  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ConditionCheckWrite </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>130 / 163 </p>
<p><b>8.5.1.2.10 </b></p>
<p><b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteData </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteData</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *data,  </p>
<p>uint16 dataLength,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>data </p>
<p>dataLength </p>
<p>ErrorCode </p>
<p>Pointer to the response buffer for the DID data. </p>
<p>Requested DID data length. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>DID writing operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid write data by identifier request </p>
<p>(service $2E) The application shall read the DID data from the specified buffer beginning by position 0.  </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>WriteDataByIdentifier ($2E) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-35  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_WriteData </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>131 / 163 </p>
<p><b>8.5.1.2.11 </b></p>
<p><b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnControlToECU </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnControlToECU</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *RequestData,  </p>
<p>uint16 RequestDataLength,  </p>
<p>Dcm_&lt;n&gt;Byte_Type *ResponseData,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>RequestData </p>
<p>RequestDataLength </p>
<p>ResponseData </p>
<p>ErrorCode </p>
<p>Pointer to the request data. </p>
<p>Actual length of the requested data. </p>
<p>Pointer to the response data. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>I/O control operation successful. </p>
<p>The application needs more time to perform the requested operation (see </p>
<p>limitations below). </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving an I/O-Control request (service $2F) with </p>
<p>control operation “ReturnControlToECU”. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>IoControlByIdentifier ($2F) </i>with operation “ReturnControlToECU” must be supported. </p>
<p></p>
<p> </p>
<p>DCM_E_PENDING can be used in any case. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-36  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ReturnControlToECU </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>132 / 163 </p>
<p><b>8.5.1.2.12 </b></p>
<p><b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ResetToDefault </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ResetToDefault</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *RequestData,  </p>
<p>uint16 RequestDataLength,  </p>
<p>Dcm_&lt;n&gt;Byte_Type *ResponseData,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>RequestData </p>
<p>RequestDataLength </p>
<p>ResponseData </p>
<p>ErrorCode </p>
<p>Pointer to the request data. </p>
<p>Actual length of the requested data. </p>
<p>Pointer to the response data. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>I/O control operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving an I/O-Control request (service $2F) with </p>
<p>control operation “ResetToDefault”. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>IoControlByIdentifier ($2F) </i>with operation “ResetToDefault” must be supported. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-37  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ResetToDefault </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>133 / 163 </p>
<p><b>8.5.1.2.13 &lt;CallPrefix&gt;DidServices_&lt;DID&gt;_FreezeCurrentState </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_FreezeCurrentState</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *RequestData,  </p>
<p>uint16 RequestDataLength,  </p>
<p>Dcm_&lt;n&gt;Byte_Type *ResponseData,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>RequestData </p>
<p>RequestDataLength </p>
<p>ResponseData </p>
<p>ErrorCode </p>
<p>Pointer to the request data. </p>
<p>Actual length of the requested data. </p>
<p>Pointer to the response data. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>I/O control operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving an I/O-Control request (service $2F) with </p>
<p>control operation “FreezeCurrentState”. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>IoControlByIdentifier ($2F) </i>with operation “FreezeCurrentState” must be supported. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-38  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_FreezeCurrentState </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>134 / 163 </p>
<p><b>8.5.1.2.14 &lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ShortTermAdjustment </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ShortTermAdjustment</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *RequestData,  </p>
<p>uint16 RequestDataLength,  </p>
<p>Dcm_&lt;n&gt;Byte_Type *ResponseData,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>RequestData </p>
<p>RequestDataLength </p>
<p>ResponseData </p>
<p>ErrorCode </p>
<p>Pointer to the request data. </p>
<p>Actual length of the requested data. </p>
<p>Pointer to the response data. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>I/O control operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving an I/O-Control request (service $2F) with </p>
<p>control operation “ShortTermAdjustment”. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>IoControlByIdentifier ($2F) </i>with operation “ShortTermAdjustment” must be supported. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-39  </p>
<p>&lt;CallPrefix&gt;DidServices_&lt;DID&gt;_ShortTermAdjustment </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>135 / 163 </p>
<p><b>8.5.1.2.15 &lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Start </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Start</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *RequestData,  </p>
<p>uint16 RequestDataLength,  </p>
<p>Dcm_&lt;n&gt;Byte_Type *ResponseData, </p>
<p>uint16* ResponseDataLength,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>RequestData </p>
<p>RequestDataLength </p>
<p>ResponseData </p>
<p>ResponseDataLength </p>
<p>ErrorCode </p>
<p>Pointer to the request data. </p>
<p>Actual length of the requested data. </p>
<p>Pointer to the response data. </p>
<p>Returns the actual length of the copied response data. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>Routine operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a RoutineControl request (service $31) </p>
<p>with control operation “Start”. </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>RoutineControlByIdentifier ($31) </i>with operation “Start” must be supported. </p>
<p></p>
<p> </p>
<p>The “ResponseDataLength” parameter will be set to zero at each function call. Therefore set the final </p>
<p>response data length when the return code is not DCM_E_PENDING.  </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-40  </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Start </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>136 / 163 </p>
<p><b>8.5.1.2.16 &lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Stop </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Stop</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type RequestData,  </p>
<p>uint16 *RequestDataLength,  </p>
<p>Dcm_&lt;n&gt;Byte_Type *ResponseData, </p>
<p>uint16* ResponseDataLength,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>RequestData </p>
<p>RequestDataLength </p>
<p>ResponseData </p>
<p>ResponseDataLength </p>
<p>ErrorCode </p>
<p>Pointer to the request data. </p>
<p>Actual length of the requested data. </p>
<p>Pointer to the response data. </p>
<p>Returns the actual length of the copied response data. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>Routine operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a RoutineControl request (service $31) </p>
<p>with control operation “Stop”. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>RoutineControlByIdentifier ($31) </i>with operation “Stop” must be supported. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p></p>
<p> </p>
<p>The “ResponseDataLength” parameter will be set to zero at each function call. Therefore set the final </p>
<p>response data length when the return code is not DCM_E_PENDING. </p>
<p>Table 8-41  </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_Stop </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>137 / 163 </p>
<p><b>8.5.1.2.17 &lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_RequestResults </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_RequestResults</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *RequestData,  </p>
<p>uint16 RequestDataLength,  </p>
<p>Dcm_&lt;n&gt;Byte_Type *ResponseData, </p>
<p>uint16* ResponseDataLength,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>RequestData </p>
<p>RequestDataLength </p>
<p>ResponseData </p>
<p>ResponseDataLength </p>
<p>ErrorCode </p>
<p>Pointer to the request data. </p>
<p>Actual length of the requested data. </p>
<p>Pointer to the response data. </p>
<p>Returns the actual length of the copied response data. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>Routine operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a RoutineControl request (service $31) </p>
<p>with control operation “RequestResults”. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>RoutineControlByIdentifier ($31) </i>with operation “RequestResults” must be supported. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p></p>
<p> </p>
<p>The “ResponseDataLength” parameter will be set to zero at each function call. Therefore set the final </p>
<p>response data length when the return code is not DCM_E_PENDING. </p>
<p>Table 8-42  </p>
<p>&lt;CallPrefix&gt;RoutineServices_&lt;RID&gt;_RequestResults </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>138 / 163 </p>
<p><b>8.5.1.2.18 &lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_GetSeed </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_GetSeed</b>( </p>
<p>Dcm_SecAccess_&lt;LEVEL&gt;_DataRecType *securityAccessDataRecord,  </p>
<p>Dcm_SecAccess_&lt;LEVEL&gt;_SeedType *Seed,  </p>
<p>Dcm_NegativeResponseCodeType *ErrorCode) </p>
<p><b>Parameter </b></p>
<p>securityAccessDataRecord  </p>
<p>Seed  </p>
<p>ErrorCode </p>
<p>Pointer to the seed-record in the request message. </p>
<p>Pointer to the seed buffer where the data has to be written. </p>
<p>Pointer to the error register in order to set operation negative response code. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p> </p>
<p>DCM_E_PENDING </p>
<p>GetSeed operation successful. </p>
<p>Seed could not be generated. If no error has been set in the parameter </p>
<p>ErrorCode, the NRC will be $22 (ConditionsNotCorrect). </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid request for service security access </p>
<p>– get seed ($27 $01, $03….) </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>SecurityAccess ($27) </i>must be supported. </p>
<p></p>
<p> </p>
<p>Refer to chapter <i>4.5 Considerations Using Request- and ResponseData Pointers in a Call-back</i>. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-43 </p>
<p>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_GetSeed </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>139 / 163 </p>
<p><b>8.5.1.2.19 &lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_CompareKey </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_CompareKey</b>( </p>
<p>Dcm_SecAcces_&lt;LEVEL&gt;_KeyType *Key) </p>
<p><b>Parameter </b></p>
<p>Key  </p>
<p>Pointer to the buffer where the requested key is located. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p> </p>
<p>DCM_E_COMPARE_KEY</p>
<p>_FAILED </p>
<p>DCM_E_PENDING </p>
<p>Key veification operation successful. </p>
<p>Key verification can not be performed. The NRC to be sent back will be $22 </p>
<p>(ConditionsNotCorrect). </p>
<p> </p>
<p>The requested key is not a valid one. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid request for service security access </p>
<p>– send key ($27 $02, $04….) </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>SecurityAccess ($27) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-44 </p>
<p>&lt;CallPrefix&gt;SecurityAccess_&lt;LEVEL&gt;_CompareKey </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>140 / 163 </p>
<p><b>8.5.1.2.20 </b></p>
<p><b>&lt;CallPrefix&gt;PidServices_&lt;PID&gt;_GetPIDValue </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;PidServices_&lt;PID&gt;_GetPIDValue</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *DataValueBuffer) </p>
<p><b>Parameter </b></p>
<p>DataValueBuffer </p>
<p>Pointer to the response buffer for the PID data. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p>PID read operation successful. </p>
<p>PID data access failed – NRC $22 (ConditionsNotCorrect) will be sent back. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM on receiving a valid OBD service $01 or equivalent </p>
<p>UDS $22 $F4xx request. The application shall write the PID data to the specified buffer beginning by </p>
<p>position 0.  </p>
<p> </p>
<p>Note: There is no paged-buffer support – all the data must be written linearly into the buffer. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>RequestCurrentPowertrainDiagnosticData ($01) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-45  </p>
<p>&lt;CallPrefix&gt;PidServices_&lt;PID&gt;_GetPIDValue </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>141 / 163 </p>
<p><b>8.5.1.2.21 </b></p>
<p><b>&lt;CallPrefix&gt;DTRServices_&lt;MIDTID&gt;_GetDTRValue </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;DTRServices_&lt;MIDTID&gt;_GetDTRValue</b>( </p>
<p>uint16* TestValue,  </p>
<p> uint16* MinLimit , </p>
<p>uint16* MaxLimit , </p>
<p>DTRStatusType* Status) </p>
<p><b>Parameter </b></p>
<p>TestValue </p>
<p>MinLimit  </p>
<p>MaxLimit </p>
<p>Status </p>
<p>OUT parameter for the test value. </p>
<p>OUT parameter for the minimum limit. </p>
<p>OUT parameter for the maximum limit. </p>
<p>OUT parameter for the test status. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p>TID read operation successful. </p>
<p>TID data access failed – NRC $31 (RequestOutOfRange) will be sent back (if </p>
<p>allowed). </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM on receiving a valid OBD service $06 or equivalent </p>
<p>UDS $22 $F6xx request.  </p>
<p> </p>
<p>The valid status values are: DCM_DTRSTATUS_VISIBLE and DCM_DTRSTATUS_INVISIBLE. In case of </p>
<p>INVISIBLE, DCM will automatically put zero values for all test values. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>RequestOnBoardMonitorTestResults ($06) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-46  </p>
<p>&lt;CallPrefix&gt;PidServices_&lt;MIDTID&gt;_GetDTRValue </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>142 / 163 </p>
<p><b>8.5.1.2.22 </b></p>
<p><b>&lt;CallPrefix&gt;RequestControlServices_&lt;TID&gt;_RequestControl </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;RequestControlServices_&lt;TID&gt;_RequestControl</b>(  </p>
<p>                                                                  void) </p>
<p><b>Parameter </b></p>
<p>- </p>
<p>- </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_NOT_OK </p>
<p>TID read operation successful. </p>
<p>TID data access failed – NRC $22 (ConditionsNotCorrect) will be sent. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM on receiving a valid OBD service $08 or equivalent </p>
<p>UDS $31 $01 $E$x request.  </p>
<p> </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>RequestControlOfOnBoardSystemTestOrComponent ($08) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-47 </p>
<p>&lt;CallPrefix&gt;RequestControlServices_&lt;TID&gt;_RequestControl </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>143 / 163 </p>
<p><b>8.5.1.2.23 </b></p>
<p><b>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_GetInfoTypeValue </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_GetInfoTypeValue</b>( </p>
<p>Dcm_&lt;n&gt;Byte_Type *DataValueBuffer) </p>
<p><b>Parameter </b></p>
<p>DataValueBuffer </p>
<p>Pointer to the response buffer for the InfoType ID data. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>DCM_E_NOT_OK </p>
<p>InfoType ID read operation successful. </p>
<p>InfoType ID access still not possible – call again </p>
<p>InfoType ID data access failed – NRC $22 (ConditionsNotCorrect) will be sent </p>
<p>back. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM on receiving a valid OBD service $09 or equivalent </p>
<p>UDS $22 $F8xx request. The application shall write the InfoType ID data to the specified buffer beginning </p>
<p>by position 0.  </p>
<p> </p>
<p>Note: There is no paged-buffer support – all the data must be written linearly into the buffer. </p>
<p> </p>
<p>If the ECU supports only WWH-OBD or only OBD2 – this port operation shall return exactly the data </p>
<p>defined in the specification. </p>
<p>If the ECU supports both WWH-OBD and OBD2 standards and the InfoType DID shares the information </p>
<p>from service <i>RequestVehicleInformation ($09) </i>– this operation shall return depending on the currently </p>
<p>active standard (OBD2 or WWH-OBD) the concrete DID data – for OBD2 with NODI byte, for WWH-OBD - </p>
<p>without NODI byte. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>RequestVehicleInformation ($09) </i>must be supported. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-48  </p>
<p>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_GetInfoTypeValue </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>144 / 163 </p>
<p><b>8.5.1.2.24 </b></p>
<p><b>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_ReadDataLength </b></p>
<p><b>Prototype </b></p>
<p>Std_ReturnType <b>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_ReadDataLength</b>( </p>
<p>uint16 *DidLength) </p>
<p><b>Parameter </b></p>
<p>DidLength </p>
<p>Returns the DID actual length. </p>
<p><b>Return code </b></p>
<p>DCM_E_OK </p>
<p>DCM_E_PENDING </p>
<p>InfoType ID read length operation successful. </p>
<p>The application needs more time to perform the requested operation. </p>
<p><b>Functional Description </b></p>
<p>This service port operation will be executed by DCM by receiving a valid read data by identifier request </p>
<p>(service $22 $F801-$F8FF) for an InfoType DID with dynamic length. The application shall set the actual </p>
<p>DID length at the time of the request.  </p>
<p> </p>
<p>If the ECU supports only WWH-OBD or only OBD2 – this port operation will not exist. </p>
<p>If the ECU supports both WWH-OBD and OBD2 standards and the InfoType DID shares the information </p>
<p>from service <i>RequestVehicleInformation ($09) </i>– this operation is required to determine depending on the </p>
<p>currently active standard (OBD2 or WWH-OBD) the concrete DID length – for OBD2 with NODI byte, for </p>
<p>WWH-OBD -&gt; without NODI byte. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Service <i>ReadDataByIdentifier ($22) </i>must be supported. </p>
<p></p>
<p> </p>
<p>The DID of this port has a corresponding INFID for <i>RequestVehicleInformation ($09). </i></p>
<p></p>
<p> </p>
<p>For <i>RequestVehicleInformation ($09) </i>this operation will not be called. </p>
<p></p>
<p> </p>
<p>The ECU supports both WWH-OBD and OBD2 standards. </p>
<p>Call Context </p>
<p></p>
<p> </p>
<p>Called out of the Dcm_MainFunction task context. </p>
<p>Table 8-49  </p>
<p>&lt;CallPrefix&gt;InfoTypeServices_&lt;INFID&gt;_ReadDataLength </p>
<p> </p>
<p><b>8.5.1.3 </b></p>
<p><b>Implementation Hints for Port Usage </b></p>
<p>All service ports, that have parameters of atomic data type (e.g. uint8, uint16, uint32, etc.) </p>
<p>are to be accessed as usual C- interface. But there are also port interfaces that transfer </p>
<p>large  amount  of  data  between  DCM  and  the  application.  They  use  parameters  of  type </p>
<p>pointer  to  array  that  require  a  little  bit  more  attention  since  if  the  wrong  indirection  is </p>
<p>applied, the compiler will not warn you but at run-time the memory address pointing to the </p>
<p>data will be wrong.  </p>
<p>To  simplify  the  understanding  of  the  usage  of  such  ports,  please  take  a  look  onto  the </p>
<p>example pseudo code below: </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>145 / 163 </p>
<p><b> </b></p>
<p> </p>
<p><b>Example </b></p>
<p>Here is an example that has been prepared for you. </p>
<p><b>[13]  </b></p>
<p><b> </b></p>
<p> </p>
<p>Std_ReturnType Appl_Dcm_DidServices_0xf100_ReadData( </p>
<p>P2VAR(Dcm_8Byte_Type, AUTOMATIC, DCM_VAR_NOINIT) data) </p>
<p>{ </p>
<p>  /* Direct access to the data ... */ </p>
<p>  (*data)[0] = 0x12; </p>
<p>  (*data)[1] = 0x34; </p>
<p>  .... </p>
<p>  (*data)[7] = 0xFF; </p>
<p>   </p>
<p>  /* ... or MemCopy */ </p>
<p>  (void)memcpy(*data, &lt;srcLocation&gt;, n); </p>
<p>} </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>146 / 163 </p>
<p><b>9 </b></p>
<p><b>Configuration </b></p>
<p>DCM uses two configuration tools for its setup: </p>
<p>- </p>
<p>CANdelaStudio: used for the diagnostic configuration settings </p>
<p>- </p>
<p>GENy: used primarily for the component integration setup. </p>
<p><b>9.1 </b></p>
<p><b>Configuration in DBC File </b></p>
<p><b>Attribute Name </b></p>
<p><b>Object </b></p>
<p><b>Type </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>the default value is </p>
<p>written in bold </p>
<p><b>Description </b></p>
<p>DiagRequest </p>
<p>Message </p>
<p>Enum </p>
<p><b>No </b></p>
<p>Yes </p>
<p>Specifies (Yes) that the message is a diagnostic </p>
<p><b>physical USDT </b>request message. </p>
<p>DiagResponse </p>
<p>Message </p>
<p>Enum </p>
<p><b>No </b></p>
<p>Yes </p>
<p>Specifies (Yes) that the message is a diagnostic </p>
<p><b>USDT </b>response message. </p>
<p>DiagState </p>
<p>Message </p>
<p>Enum </p>
<p><b>No </b></p>
<p>Yes </p>
<p>Specifies (Yes) that the message is a diagnostic </p>
<p><b>functional USDT </b>request message. </p>
<p>DiagUudtResponse </p>
<p>Message </p>
<p>Enum </p>
<p><b>false </b></p>
<p>true </p>
<p>Specifies (true) that the message is a diagnostic </p>
<p><b>UUDT </b>response message. </p>
<p>Table 9-1  </p>
<p>Data base attributes </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>147 / 163 </p>
<p><b>9.2 </b></p>
<p><b>Configuration with GENy  </b></p>
<p><b>9.2.1 </b></p>
<p><b>Common GENy usage hints </b></p>
<p>Here you will learn some usefull ideas on how to maximize the benefit of the GENy tool. </p>
<p><b>9.2.1.1 </b></p>
<p><b>Path placeholders  </b></p>
<p>Usually the software project under development is located in a specific folder on the PC </p>
<p>which includes the configuration file, generated files, etc. Within the GENy configuration </p>
<p>you can specify a full path to the folders where: </p>
<p><b>&gt; </b> the software module configuration sources will be generated; </p>
<p>or </p>
<p><b>&gt; </b> any external (e.g. user configuration) files are located and will be imported in GENy; </p>
<p>Using the full path in those configuration fields, you have to adapt your configuration each </p>
<p>time the location of your project changes. If you do not change those paths then in best </p>
<p>case GENy will not be abe to generate the software component configuration or will bring </p>
<p>error messages, so will know that there is something wrong. But if you just have copied the </p>
<p>project, so the original paths still exist, GENy might be able to generate source code, but </p>
<p>then either to the wrong target directory or/and using wrong input files. </p>
<p>To avoid such problems, the best practice is always to specify relative paths in GENy using </p>
<p>as a root GENy’s project directory (e.g. where the .gny configuration file is stored). For this </p>
<p>purpose, just use the placeholder “<b>$(ProjectDir)</b>” for your paths. </p>
<p>Here some examples: </p>
<p>$(ProjectDir)UserConigFiles\Dcm.cfg </p>
<p>$(ProjectDir)..\CANdelaFiles\MyEcu.cdd </p>
<p>You can always verify where the placeholder is pointing to by calling the generation path </p>
<p>dialog: </p>
<p> </p>
<p>Figure 9-1 </p>
<p>GENy tool bar – activating generation path dialog </p>
<p><b>9.2.2 </b></p>
<p><b>General DCM options </b></p>
<p>The components general options are located directly on the components root node: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>148 / 163 </p>
<p> </p>
<p>Figure 9-2 </p>
<p>General configuration </p>
<p> </p>
<p>Listed options here are: </p>
<p> </p>
<p><b>Attribute Name </b></p>
<p><b>Availability </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>The default value is </p>
<p>written in bold </p>
<p><b>Description </b></p>
<p>Software </p>
<p>Component Name </p>
<p>Always. </p>
<p>String </p>
<p><b>Dcm </b></p>
<p>This name is used as component name </p>
<p>(ShortName) in the generated software </p>
<p>component template. Change this name if </p>
<p>you try to import the Dcm components of </p>
<p>several ECUs and have problems with name </p>
<p>clashes. </p>
<p>Task Time [ms] </p>
<p>Always. </p>
<p>Integer </p>
<p><b>10 </b></p>
<p>1..255 </p>
<p>The 'Dcm_Task' (resp. 'Dcm_TimerTask') </p>
<p>function must be called EXACTLY in the time </p>
<p>period which is specified here. This is </p>
<p>important because the time constant will be </p>
<p>converted into a number of function calls and </p>
<p>if this setting doesn't match the real call cycle, </p>
<p>the component internal timeout monitors will </p>
<p>not function properly. </p>
<p>Configuration </p>
<p>Always. </p>
<p>Enum </p>
<p><b>Pre-compile </b></p>
<p>Select which type of configuration variant this </p>
<p>BSW module shall fulfil. Only those that are </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>149 / 163 </p>
<p><b>Attribute Name </b></p>
<p><b>Availability </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>The default value is </p>
<p>written in bold </p>
<p><b>Description </b></p>
<p>Variant </p>
<p>Link-time </p>
<p>Post-build </p>
<p>supported by this BSW module are </p>
<p>selectable. </p>
<p>The available variants are BSW module </p>
<p>dependent and specified by AUTOSAR. </p>
<p>Please refer to the AUTOSAR specification of </p>
<p>COM for details about the variants and their </p>
<p>meaning. </p>
<p>Paged-Buffer </p>
<p>Enabled </p>
<p>Always. </p>
<p>Boolean </p>
<p><b>True </b></p>
<p>False </p>
<p>In order to save some RAM, you can enable </p>
<p>this feature which will allow much longer </p>
<p>responses to be sent with a small static buffer </p>
<p>configuration.  </p>
<p> </p>
<p>This feature just enables a DCM </p>
<p>implementation part allowing the usage of </p>
<p>paged-buffer transfer. The application writes </p>
<p>always only by linear buffer access. </p>
<p>Dev Error Detect </p>
<p>Always. </p>
<p>Boolean </p>
<p><b>True </b></p>
<p>False </p>
<p>Enabling this option, you will turn on the DCM </p>
<p>internal monitoring of all APIs to the </p>
<p>application and from it. Once an invalid </p>
<p>parameter or return value has been detected, </p>
<p>DCM notifies the DET (Development Error </p>
<p>Tracer) component for the fault. </p>
<p>Version Info API </p>
<p>Always. </p>
<p>Boolean </p>
<p><b>True </b></p>
<p>False </p>
<p>Enable/disable the version information report </p>
<p>API. </p>
<p>If the version information is not needed, </p>
<p>disable this option to save resources (ROM). </p>
<p>Use  Rte </p>
<p>Always. </p>
<p>Boolean </p>
<p><b>True </b></p>
<p>False </p>
<p>If this option is enabled, a port interface </p>
<p>description (Software Component Template) </p>
<p>is generated which can be used for the RTE </p>
<p>configuration. </p>
<p> </p>
<p>Pseudo Parallel </p>
<p>Request Handling </p>
<p>OEM specific </p>
<p>use case. </p>
<p>Enum </p>
<p><b>Exclusive </b></p>
<p><b>Silent </b></p>
<p>Exclusive </p>
<p>Request  </p>
<p>Exclusive </p>
<p>Session </p>
<p>Choosing any value other than   'Exclusive </p>
<p>Silent' will enable responses with negative </p>
<p>response code   &quot;Busy - Repeat Request&quot;  </p>
<p>(NRC $21) to parallel requests from different </p>
<p>testers. </p>
<p>  </p>
<p>The options are: </p>
<p><b>Exclusive Silent</b>: Requests received while </p>
<p>the DCM is still processing another request </p>
<p>are ignored without response. This is the </p>
<p>default. </p>
<p>  </p>
<p><b>Exclusive Request</b>: Requests received while </p>
<p>the DCM is still processing another request </p>
<p>are rejected with NRC $21. </p>
<p>  </p>
<p><b>Exclusive Session</b>: Requests received while </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>150 / 163 </p>
<p><b>Attribute Name </b></p>
<p><b>Availability </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>The default value is </p>
<p>written in bold </p>
<p><b>Description </b></p>
<p>the DCM is still processing another request </p>
<p>are rejected with NRC $21. </p>
<p>Additionally, if a tester activates a non-default </p>
<p>session, requests from other testers will be </p>
<p>rejected with NRC $21 until the ECU switches </p>
<p>back to the default session. </p>
<p>Maximum Number </p>
<p>of Parallel Requests  </p>
<p>OEM specific </p>
<p>use case. </p>
<p>Integer </p>
<p><b>3 </b></p>
<p>Set the maximum number of parallel requests </p>
<p>that can be rejected with negative response </p>
<p>code $21. </p>
<p>The optimal value for this setting is the total </p>
<p>number of testers that are expected to </p>
<p>communicate with the ECU at the same time.  </p>
<p>  </p>
<p>This value has no effect if the option 'Pseudo </p>
<p>Parallel Request Handling' is set </p>
<p>to <b>'Exclusive Silent'</b>. </p>
<p> </p>
<p>Runtime Limiter </p>
<p>Always. </p>
<p>Integer </p>
<p><b>10 </b></p>
<p>0..255 </p>
<p>Determines the maximum number of </p>
<p>iterations (e.g. DEM read DTCs) per single </p>
<p>Dcm_MainFunction call. This is useful in </p>
<p>cases where the CPU is overloaded and </p>
<p>there could be expected a watchdog reset or </p>
<p>OS task reactivation resp. task activation </p>
<p>delay of concurrent, lower priority tasks. </p>
<p> Note:  </p>
<p>- </p>
<p>You need at least a limiter of 3 to fill a </p>
<p>CanTP consecutive frame per DCM </p>
<p>task cycle. </p>
<p>- </p>
<p>Zero value means no limitation. </p>
<p>ECU Reset Delay </p>
<p>Time [ms] </p>
<p>OEM specific </p>
<p>use case. </p>
<p>Integer </p>
<p><b>1000 </b></p>
<p>0..65535 </p>
<p>This option specifies the delay time in </p>
<p>milliseconds to be applied from accepting a </p>
<p>valid ECU reset request until its real </p>
<p>execution.  </p>
<p>Valid values are: </p>
<p>0 - no delay time until reset </p>
<p>1 - 65535 - the delay time </p>
<p> </p>
<p>Note: If the configured value is not a multiple </p>
<p>of the Dcm_MainFunction call time period, </p>
<p>the result will be rounded down. </p>
<p>Maximum memory </p>
<p>gap size for memory </p>
<p>block combination </p>
<p>optimization </p>
<p>Available only if </p>
<p>direct memory </p>
<p>access services </p>
<p>are supported </p>
<p>(i.e. Sid: $23 </p>
<p>and/or $3D). </p>
<p> </p>
<p>Integer </p>
<p><b>0 </b></p>
<p>0..(2</p>
<p>32</p>
<p>-1) </p>
<p>Specifies the maximum gap size between two </p>
<p>consecutive memory blocks that can be </p>
<p>combined to a single memory block (i.e. the </p>
<p>gap will be treated as accessible area too ). </p>
<p>This process can be only applied if the </p>
<p>properties of those memory blocks are equal: </p>
<p>have the same access operations (read/write) </p>
<p>and same access conditions (session, </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>151 / 163 </p>
<p><b>Attribute Name </b></p>
<p><b>Availability </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>The default value is </p>
<p>written in bold </p>
<p><b>Description </b></p>
<p>security access, etc.). </p>
<p> </p>
<p>Valid values: </p>
<p>0: no gap - combine only memory blocks that </p>
<p>are attached. </p>
<p>1 - UINT_MAX:  combine memory blocks only </p>
<p>if the start address of the subsequent block is </p>
<p>not farther than the end address of the first </p>
<p>block + this value + 1. </p>
<p>Variant Mode </p>
<p>Selection </p>
<p>Always. </p>
<p>Enum </p>
<p><b>SIMPLE_ECU </b></p>
<p>MULTI_IDENTI</p>
<p>TY_MODE </p>
<p>VSG_MODE </p>
<p>Note: This setting is independent from </p>
<p>communication identities! </p>
<p>SIMPLE_ECU: The diagnostics support one </p>
<p>configuration only. </p>
<p>MULTI_IDENTITY_MODE: The diagnostics </p>
<p>support different diagnostic variants. One </p>
<p>variant is active a time. </p>
<p>VSG_MODE: Diagnostic Entities </p>
<p>(SubServices, DTCs...) are grouped into </p>
<p>VSGs. A subset of VSGs is active at a time. </p>
<p>Asr 4 Style Memory </p>
<p>Access </p>
<p>Available only if </p>
<p>direct memory </p>
<p>access services </p>
<p>are supported </p>
<p>(i.e. Sid: $23 </p>
<p>and/or $3D). </p>
<p>Boolean </p>
<p><b>False </b></p>
<p>True </p>
<p>If this option is enabled and one of the </p>
<p>service $23 or $3D is available in the ECU </p>
<p>diagnostic configuration, DCM will require </p>
<p>additional callouts to be implemented (see </p>
<p>TechnicalReference for details about them).  </p>
<p>If it is disabled, DCM will provide a direct </p>
<p>memory access to the requested address </p>
<p>block without any application interaction. </p>
<p>Respond All </p>
<p>Request </p>
<p>OEM specific </p>
<p>use case. </p>
<p>Boolean </p>
<p><b>True </b></p>
<p>False </p>
<p>If set to FALSE the Dcm will not respond to </p>
<p>diagnostic request that contains a service ID </p>
<p>which is in the range from 0x40 to 0x7F or in </p>
<p>the range from 0xC0 to 0xFF (Response IDs). </p>
<p>Unspecified Service </p>
<p>Support </p>
<p>OEM specific </p>
<p>use case. </p>
<p>Boolean </p>
<p><b>False </b></p>
<p>True </p>
<p>If this option is enabled, Dcm will not reject </p>
<p>every unknown service, but will ask your </p>
<p>application if the SID is an application specific </p>
<p>one and if so will delegate the service </p>
<p>processing to the application. </p>
<p>Periodic Tx Type </p>
<p>OEM specific </p>
<p>use case </p>
<p>Enum </p>
<p><b>Type I </b></p>
<p>Type II </p>
<p>Select which type of periodic response is </p>
<p>supported by Dcm. The per-protocol selection </p>
<p>defined by AUTOSAR is not necessarily </p>
<p>consistent, so this parameter is used as </p>
<p>authoritative reference. </p>
<p> </p>
<p>- Type_I: Same Tx Pdu as for main response </p>
<p>- Type_II: Dedicated (unsegmented) Tx Pdu </p>
<p>RoE Tx Type </p>
<p>Future use </p>
<p>Enum </p>
<p><b>Type I </b></p>
<p>Select which type of periodic response is </p>
<p>supported by Dcm. The per-protocol selection </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>152 / 163 </p>
<p><b>Attribute Name </b></p>
<p><b>Availability </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>The default value is </p>
<p>written in bold </p>
<p><b>Description </b></p>
<p>Type II </p>
<p>defined by AUTOSAR is not necessarily </p>
<p>consistent, so this parameter is used as </p>
<p>authoritative reference. </p>
<p> </p>
<p>- Type_I: Same Tx Pdu as for main response </p>
<p>- Type_II: Dedicated (segmented) Tx Pdu </p>
<p>Support Multi </p>
<p>Channel FBL </p>
<p>OEM specific </p>
<p>use case </p>
<p>Boolean </p>
<p><b>False </b></p>
<p>True </p>
<p>If this option is enabled, the Dcm will provide </p>
<p>additional information to the DcmFbl interface </p>
<p>about the logical channel the request </p>
<p>originated on. This allows the proper handling </p>
<p>of ECUs that can jump to the boot loader </p>
<p>from different channels. Also, the Dcm </p>
<p>expects the DcmFbl to provide the same </p>
<p>information after startup. </p>
<p> </p>
<p>Note: If the channel layout differs between </p>
<p>Application and Bootloader, the channel </p>
<p>mapping must be implemented in DcmFbl </p>
<p>during integration (also see the DcmFbl </p>
<p>TechnicalReference) </p>
<p> </p>
<p>This setting must match the DcmFbl interface </p>
<p>and the boot loader used. </p>
<p> </p>
<p><b>User Config File </b></p>
<p>If </p>
<p>you </p>
<p>want </p>
<p>to </p>
<p>overwrite </p>
<p>some </p>
<p>of </p>
<p>the </p>
<p>settings </p>
<p>in </p>
<p>the </p>
<p>generated </p>
<p>configuration </p>
<p>file </p>
<p>(dcm_cfg.h), you can specify a path to a user defined configuration file. The user defined </p>
<p>configuration  file  will  be  included  at  the  end  of  the  generated  pre-processor  switches. </p>
<p>Definitions in the user defined configuration file can overwrite definitions in the generated </p>
<p>configuration file.  </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>Use relative path to the user configuration file with the help of GENy placeholders to </p>
<p>avoid unexpected results on later moving of the project location. Refer to chapter </p>
<p><i>9.2.1.1Path placeholders </i>for more details about GENy’s placeholders. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>NOTE:  Not  all  of  the features  can  be  overwritten  simply  by  triggering  the  pre-processor </p>
<p>switch. Some of the options are complex and the code generator generates less or more </p>
<p>code depending on the setting. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>153 / 163 </p>
<p><b> </b></p>
<p> </p>
<p><b>Caution </b></p>
<p>USE SUCH A FILE ONLY AFTER DISCUSSION WITH VECTOR. </p>
<p><b> </b></p>
<p> </p>
<p><b>9.2.3 </b></p>
<p><b>CANdelaDiagnosticDocument import options </b></p>
<p>In  order  to  generate  the  DCM  diagnostic  configuration  a  CANdelaDiagnosticDocument </p>
<p>(CDD) must be imported. </p>
<p> </p>
<p>Figure 9-3 </p>
<p>Diagnostic options configuration </p>
<p>Listed options here are: </p>
<p> </p>
<p><b>Import CANdelaStudio Configuration </b></p>
<p>Import a configuration from a CANdelaStudio (.CDD) file. </p>
<p> </p>
<p><b>Diagnostic Variant </b></p>
<p>You have to select the proper diagnostic description variant (if more than one is available) </p>
<p>in order to generate the correct diagnostic component. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>If the option “<b>Variant Selection Mode</b>” (see “<i>General DCM options</i>”) is set to “Multi </p>
<p>Identity”, you will be able to add more diagnostic variants (from the same or other CDD </p>
<p>files), using the button “<b>Add Diagnostic Variant</b>” that can be switch at run-time in DCM </p>
<p>(please refer to chapter <i>6.3 Multi-Identity Support </i>for more information). </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>9.2.4 </b></p>
<p><b>Diagnostic Protocol Configuration </b></p>
<p>Autosar DCM is capable of handling multiple protocols. Each protocol is communicating </p>
<p>over  one  or  several  connections  (i.e.  from  different  testers,  on  multiple  communication </p>
<p>channels, etc.).  Please refer to chapter <i>Multiple Protocol Support </i>for details about multiple </p>
<p>protocols support. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>154 / 163 </p>
<p>The protocol specific settings are listed below (referred to the <i>Figure 9-3 Diagnostic </i></p>
<p><i>options </i>configuration):  </p>
<p> </p>
<p><b>Attribute Name </b></p>
<p><b>Availability </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>The default value </p>
<p>is written in bold </p>
<p><b>Description </b></p>
<p>Buffer Size  </p>
<p>Always available. </p>
<p>Integer </p>
<p><b>32 </b></p>
<p>This sets the size of the buffer </p>
<p>used for this protocol.   </p>
<p>GENy automatically calculates the </p>
<p>best matching value for your </p>
<p>diagnostic configuration (i.e. to be </p>
<p>able to receive the longest </p>
<p>possible service request). </p>
<p> </p>
<p>If OBD support is available, then </p>
<p>DCM reserves two buffers of this </p>
<p>size – one for OBD and one for </p>
<p>UDS. </p>
<p> </p>
<p><b>9.2.5 </b></p>
<p><b>Diagnostic Connection Configuration </b></p>
<p>As mentioned in chapter <i>9.2.4 Diagnostic Protocol Configuration </i>DCM handles diagnostic </p>
<p>protocols  over  different  diagnostic  connections.  GENy  is  capable  of  connection  auto-</p>
<p>detection if the communication database contains the required messages and their meta-</p>
<p>information. The detected connections will be displayed as shown below. </p>
<p> </p>
<p> </p>
<p> </p>
<p>Figure 9-4 </p>
<p>Diagnostic connection configuration </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>155 / 163 </p>
<p><b>Attribute Name </b></p>
<p><b>Availability </b></p>
<p><b>Value </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p>The default value </p>
<p>is written in bold </p>
<p><b>Description </b></p>
<p>Protocol Type  </p>
<p>Always available. </p>
<p>Enum </p>
<p><b>UDS </b></p>
<p>OBD </p>
<p>UDS and </p>
<p>OBD </p>
<p>This setting has only effect on </p>
<p>OBD relevant ECUs in order to </p>
<p>pre-filter a request acceptance on </p>
<p>a certain connection. The filtering </p>
<p>is performed as follows: </p>
<p>- </p>
<p>UDS connection – only </p>
<p>diagnostic services with </p>
<p>identifier greater or equal </p>
<p>to $10 will be accepted. </p>
<p>Any OBD requests will be </p>
<p>ignored. </p>
<p>- </p>
<p>OBD connection – only </p>
<p>OBD requests (within the </p>
<p>range $00 – $0F, resp. if </p>
<p>applicable all WWH-OBD </p>
<p>SIDs) will be accepted. </p>
<p>Any other request </p>
<p>message will be ignored. </p>
<p>Can be used as service </p>
<p>firewalling upon scan-</p>
<p>tools. </p>
<p>- </p>
<p>UDS and OBD connection </p>
<p>– any request will be </p>
<p>accepted, independently </p>
<p>of its service identifier. </p>
<p> </p>
<p><b>9.2.6 </b></p>
<p><b>Channel Configuration </b></p>
<p>In </p>
<p>order </p>
<p>to </p>
<p>specify </p>
<p>on </p>
<p>which </p>
<p>CAN </p>
<p>channel </p>
<p>DCM </p>
<p>shall </p>
<p>communicate, </p>
<p>the </p>
<p><i><b>Dcm_ConnectorCAN </b></i> component  shall  be  selected  on  the  corresponding  channel. This </p>
<p>will allow the automatic network connection of DCM. </p>
<p>Principally for any communication bus type, GENy offers a separate DCM connector. The </p>
<p>component name that you shall activate for the corresponding bus is named according to </p>
<p>the  following  convention  “<b>Dcm_Connector&lt;BUStype&gt;</b>”,  where  as  the  BUStype  can  be: </p>
<p>CAN, FR (for flex ray), LIN, etc. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>156 / 163 </p>
<p><b>10  AUTOSAR Standard Compliance </b></p>
<p><b>10.1 Deviations </b></p>
<p><b>10.1.1 </b></p>
<p><b>Multiple Protocol Support </b></p>
<p>Current DCM 3.0 implementation does not support multiple protocols. This means even if </p>
<p>there are for example both FlexRay and CAN using UDS ([5]) standard, there will be only </p>
<p>one diagnostic protocol supported by DCM – UDS.  </p>
<p>Even  there  are  OBD  services  in  the  DCM  configuration,  the  OBD  support  is  performed </p>
<p>using single protocol instance. DCM distinguishes between different protocols trough the </p>
<p>service id of the received request and the connection specific diagnostic type (please refer </p>
<p>chapter <i>9.2.5 Diagnostic Connection Configuration</i>. </p>
<p><b>10.1.2 </b></p>
<p><b>Compiler abstraction </b></p>
<p><b>10.1.2.1 </b></p>
<p><b>Static and Inline Functions </b></p>
<p>In Autosar 3.0 there are macros defined (by the compiler abstraction unit) for static and </p>
<p>inline  functions.  DCM  uses  such  functions  internally  and  since  not  all  compiler  support </p>
<p>inlining, the combination of STATIC INLINE is used to keep the DCM still  </p>
<p>1)  MISRA compliant  </p>
<p>2)  Let the compiler to be able to optimize the function calls (use also auto-inlining) </p>
<p>There  are  compilers  that  have  troubles  using  both  key  words  at  the  same  time  (bad </p>
<p>implementation </p>
<p>of </p>
<p>the </p>
<p>inline </p>
<p>interpretation). </p>
<p>Therefore </p>
<p>DCM </p>
<p>uses </p>
<p>a </p>
<p>new </p>
<p>keyword </p>
<p>LOCAL_INLINE that allows you to: </p>
<p>1)  Specify on your platform how to implement this combination (e.g. as only STATIC or </p>
<p>INLINE or both (as intended)). </p>
<p>2)  Have  backward  compatibility  to  standard  Autosar  Compiler.h  files  that  does  not </p>
<p>know this new keyword. Per default DCM defines LOCAL_INLINE to INLINE only to </p>
<p>get minimum code usage. </p>
<p> </p>
<p>Please, if needed adapt the Compiler.h in your project to define the LOCAL_INLINE macro </p>
<p>to the best optimal value. </p>
<p><b>10.2 Additions/ Extensions </b></p>
<p>DCM  extends  the  AUTOSAR_SWS_DCM  specification  version  3.0.0  in  the  following </p>
<p>points: </p>
<p><b>10.2.1 </b></p>
<p><b>Diagnostic Configuration </b></p>
<p>AUTOSAR DCM 3.0 does not provide any configuration model for the services that shall </p>
<p>be </p>
<p>supported </p>
<p>and </p>
<p>their </p>
<p>definitions. </p>
<p>Current </p>
<p>DCM </p>
<p>3.0 </p>
<p>implementation </p>
<p>uses </p>
<p>the </p>
<p>CANdelaStudio format as diagnostic description data base.  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>157 / 163 </p>
<p><b> </b></p>
<p> </p>
<p><b>Info</b> </p>
<p>Using the OdxImport functionality of CANdelaStudio, also ODX files can be used as </p>
<p>diagnostic description database. </p>
<p><b> </b></p>
<p><b>10.2.2 </b></p>
<p><b>Service $28 Support </b></p>
<p>In </p>
<p>general  AUTOSAR </p>
<p>does </p>
<p>not </p>
<p>support </p>
<p>this </p>
<p>service </p>
<p>(explicitly </p>
<p>defined </p>
<p>as </p>
<p>limitation </p>
<p>requirement),  but  current  DCM  implementation  supports  it  with  some  limitations  (see </p>
<p>chapter 5.17 for more details). </p>
<p><b>10.2.3 </b></p>
<p><b>Multiple UUDT Message Transmission Support </b></p>
<p>According </p>
<p>to </p>
<p>the  AUTOSAR </p>
<p>DCM </p>
<p>configuration </p>
<p>model, </p>
<p>DCM </p>
<p>shall </p>
<p>support </p>
<p>periodic </p>
<p>transmission  (for  service  $2A)  only  using  one  TxPduId.  Current  DCM  implementation </p>
<p>allows multiple TxPduIds to be assigned for periodic transmissions. </p>
<p><b>10.2.4 </b></p>
<p><b>DEM Interface Compatibility </b></p>
<p>Current implementation of DCM is compliant to DEM 2.1 and 3.0. </p>
<p><b>10.2.5 </b></p>
<p><b>Jump into FBL on Request “Programming Session” ($10 $02) </b></p>
<p>AUTOSAR does not consider the use case FBL activation from the application (DCM), but </p>
<p>still you can perform a jump into the FBL following the ideas in the chapters below. </p>
<p><b>10.2.5.1 </b></p>
<p><b>Application implemented activation </b></p>
<p>By default there is no specific requirement for DCM to implement the FBL activation from </p>
<p>the application, the only possibility to perform a jump to the FBL is the AUTOSAR interface  </p>
<p><i>&lt;CallPrefix&gt;SessionControl_GetSesChgPermission</i>. As  long  as  the  application  needs  to </p>
<p>prepare  for  the  jump,  the <i> &lt;CallPrefix&gt;SessionControl_GetSesChgPermission </i> port  shall </p>
<p>return  DCM_E_PENDING.  Once  the  application  is  ready,  it  shall  manually  perform  ECU </p>
<p>reset. </p>
<p> </p>
<p><b>10.2.5.2 </b></p>
<p><b>AR 4.0 like Jump to/from the FBL </b></p>
<p>This DCM implements the HIS compliant FBL jump behavior as described in AR 4.0. </p>
<p>The following flow-charts show the interaction among different components of the ECU. To </p>
<p>simplify the diagram there are depicted only the positive return values of the involved APIs. </p>
<p>In any negative case the service processing will be interrupted and a negative response </p>
<p>will be sent back. </p>
<p>For  the  detailed  DCM  call  out  descriptions,  please  refer to  chapter <i> 8.3.3  Jump To/From </i></p>
<p><i>FBL</i>. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>158 / 163 </p>
<p><b>Transition from DCM to FBL </b></p>
<p><b>sd AR 4.0 JMP2FBL </b></p>
<p>ECU resets</p>
<p>Tester</p>
<p><i>(from Objects)</i></p>
<p>DCM</p>
<p><i>(from Objects)</i></p>
<p>FBL</p>
<p><i>(from Objects)</i></p>
<p>RTE</p>
<p><i>(from Objects)</i></p>
<p>EEPROM</p>
<p><i>(from Objects)</i></p>
<p>MCU</p>
<p><i>(from Objects)</i></p>
<p>CDD</p>
<p><i>(from Objects)</i></p>
<p>Dcm_ProgConditionsType progConds;</p>
<p>progConds.EcuStartMode = DCM_WARM_START;</p>
<p>progConds.Sid = 0x10;</p>
<p>progConds.SubFncId = 0x02;</p>
<p>progConds.TesterSourceAddr = &lt;tester id from request&gt;</p>
<p>REQ(0x10 0x02/0x82)</p>
<p>Rte_Dcm_Call_SessionControl_GetSesChgPermission(0x02)</p>
<p>:DCM_E_OK</p>
<p>prepareFblData()</p>
<p>Dcm_SetProgConditions(&amp;progConds)</p>
<p>Eep_Write(DCM_data)</p>
<p>Dcm_SendResponsePending()</p>
<p>RES(0x7F 0x10 0x78)</p>
<p>IsRcrRpSent()</p>
<p>Mcu_PerformReset()</p>
<p>FBL StartUp()</p>
<p>Eep_Read(DCM_data)</p>
<p>RES(0x50 0x02 &lt;timing data&gt;)</p>
<p> </p>
<p>Figure 10-1 </p>
<p>Transition from DCM to FBL </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>159 / 163 </p>
<p><b>ECU startup sequence after reprogramming compelteion (FBL) or normal boot </b></p>
<p><b>sd AR 4.0 JMP2DCM</b></p>
<p>ECU resets</p>
<p>Tester</p>
<p><i>(from Objects)</i></p>
<p>DCM</p>
<p><i>(from Objects)</i></p>
<p>FBL</p>
<p><i>(from Objects)</i></p>
<p>RTE</p>
<p><i>(from Objects)</i></p>
<p>EEPROM</p>
<p><i>(from Objects)</i></p>
<p>MCU</p>
<p><i>(from Objects)</i></p>
<p>CDD</p>
<p><i>(from Objects)</i></p>
<p><b>alt Application start</b></p>
<p>[Reprogramming complete]</p>
<p>[Normal start up]</p>
<p>DCM_data:</p>
<p>- Response required for service 0x11 0x01 to tester id XX.</p>
<p>ProgConditions-&gt;EcuStartMode = DCM_WARM_START;</p>
<p>ProgConditions-&gt;Sid = 0x11;</p>
<p>ProgConditions-&gt;SubFncId = 0x01;</p>
<p>ProgConditions-&gt;TesterSourceAddr = &lt;tester id from request&gt;</p>
<p>ProgConditions-&gt;EcuStartMode = DCM_COLD_START;</p>
<p>ProgConditions-&gt;Sid = N.A.;</p>
<p>ProgConditions-&gt;SubFncId = N.A.;</p>
<p>ProgConditions-&gt;TesterSourceAddr = N.A.</p>
<p><b>alt Reaction on ECU reset/power on</b></p>
<p>[Reprogramming complete]</p>
<p>[Normal start up]</p>
<p>Reset the flag, to avoid </p>
<p>again response </p>
<p>transmission on next </p>
<p>ECU reset.</p>
<p>REQ(0x11 0x01)</p>
<p>Eep_Write(DCM_data)</p>
<p>RESET()</p>
<p>Dcm_MainFunction()</p>
<p>Dcm_GetProgConditions(&amp;ProgConditions)</p>
<p>Eep_Read(DCM_data)</p>
<p>ConvertToDcm(ProgConditions)</p>
<p>Eep_Write(DCM_data)</p>
<p>RES(0x51 0x01)</p>
<p> </p>
<p>Figure 10-2 </p>
<p>ECU startup sequence (after reprogramming or normal boot) </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>160 / 163 </p>
<p><b>10.3 Limitations </b></p>
<p>All  of  the  DCM  limitations  are  within  the  implementation  of  the  diagnostic  services.  For </p>
<p>each  service  specific  limitation,  please  refer  the  appropriate  chapter  within  the  section </p>
<p>“<i>Diagnostic Service Implementation</i>”. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>161 / 163 </p>
<p><b>11  Glossary and Abbreviations </b></p>
<p><b>11.1 </b></p>
<p><b>Glossary </b></p>
<p><b>Term </b></p>
<p><b>Description </b></p>
<p>EAD </p>
<p>Embedded Architecture Designer; generation tool for MICROSAR </p>
<p>components </p>
<p>GENy </p>
<p>Generation tool for CANbedded and MICROSAR components </p>
<p>Table 11-1  </p>
<p>Glossary </p>
<p><b>11.2 </b></p>
<p><b>Abbreviations </b></p>
<p><b>Abbreviation </b></p>
<p><b>Description </b></p>
<p>API </p>
<p>Application Programming Interface </p>
<p> </p>
<p>AR </p>
<p>Autosar </p>
<p>AUTOSAR </p>
<p>Automotive Open System Architecture </p>
<p>BSW </p>
<p>Basis Software </p>
<p>CDD </p>
<p>CANdela Diagnostic Data </p>
<p>CDDT </p>
<p>CANdela Diagnostic Data Template </p>
<p>ComM </p>
<p>Communication Manager </p>
<p>DBC </p>
<p>Data Base CAN </p>
<p>DcmFbl </p>
<p>DCM FlashBootLoader interface </p>
<p>DDDID </p>
<p>Dynamically Defined Data Identifier </p>
<p>DEM </p>
<p>Diagnostic Event Manager </p>
<p>DET </p>
<p>Development Error Tracer </p>
<p>DID </p>
<p>Data Identifier </p>
<p>EAD </p>
<p>Embedded Architecture Designer </p>
<p>ECU </p>
<p>Electronic Control Unit </p>
<p>HIS </p>
<p>Hersteller Initiative Software </p>
<p>IoHwAb </p>
<p>Input/Output Hardware Abstraction </p>
<p>ISR </p>
<p>Interrupt Service Routine </p>
<p>LID </p>
<p>Local Identifier </p>
<p>MICROSAR </p>
<p>Microcontroller Open System Architecture (the Vector AUTOSAR </p>
<p>solution) </p>
<p>MID </p>
<p>Monitor Identifier </p>
<p>MIDTID </p>
<p>Onboard Monitor Test Identifier </p>
<p>OBD </p>
<p>On Board Diagnostics </p>
<p>PID </p>
<p>Parameter Identifier </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>162 / 163 </p>
<p>PPort </p>
<p>Provide Port </p>
<p>RPort </p>
<p>Require Port </p>
<p>RTE </p>
<p>Runtime Environment </p>
<p>SID </p>
<p>Service Identifier </p>
<p>SPRMIB </p>
<p>Suppress Positive Response Message Indication Bit </p>
<p>SRS </p>
<p>Software Requirement Specification </p>
<p>SWC </p>
<p>Software Component </p>
<p>SWS </p>
<p>Software Specification </p>
<p>TID </p>
<p>Test Identifier </p>
<p>VID </p>
<p>Vehicle Information Identifier </p>
<p>VMM </p>
<p>Vehicle Mode Management </p>
<p>VPM </p>
<p>Vehicle Parameter Manager </p>
<p>VSG </p>
<p>Vehicle System Group </p>
<p>WWH-OBD </p>
<p>World Wide Harmonized On Board Diagnostics </p>
<p>Table 11-2  </p>
<p>Abbreviations </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR DCM  </p>
<p> </p>
<p>2012, Vector Informatik GmbH </p>
<p>Version: 3.26.02 </p>
<p>based on template version 3.1 </p>
<p>163 / 163 </p>
<p><b>12  Contact </b></p>
<p>Visit our website for more information on </p>
<p> </p>
<p>&gt;   News </p>
<p>&gt;   Products </p>
<p>&gt;   Demo software </p>
<p>&gt;   Support </p>
<p>&gt;   Training data </p>
<p>&gt;   Addresses </p>
<p> </p>
<p><b>www.vector-informatik.com </b></p>
<p> </p>
<p> </p>
</body>
</html>
{% endraw %}