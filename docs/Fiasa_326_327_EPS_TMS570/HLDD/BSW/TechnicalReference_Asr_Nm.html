---
layout: default
title: TechnicalReference_Asr_Nm
nav_order: 24
parent: Fiasa_326_327_EPS_TMS570
---
{% raw %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/transitional.dtd">
<html>
<head>

  <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  <title></title>
  <meta name="generator" content="LibreOffice 24.2.7.2 (Linux)"/>
  <meta name="created" content="00:00:00"/>
  <meta name="changed" content="00:00:00"/>
</head>
<body>
<h1></h1>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>MICROSAR Network Management </b></p>
<p><b>Interface </b></p>
<p>Technical Reference </p>
<p> </p>
<p>NM Interface </p>
<p>Version 2.22.00 </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>Authors </b></p>
<p>Markus Drescher </p>
<p><b>Status: </b></p>
<p>Released </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>2 / 104 </p>
<p><b>Document Information </b></p>
<p><b>History </b></p>
<p><b>Author </b></p>
<p><b>Date </b></p>
<p><b>Version </b></p>
<p><b>Remarks </b></p>
<p>Oliver Hornung </p>
<p>2006-10-24 </p>
<p>1.00.00 </p>
<p>ESCAN00018802: Creation of document for </p>
<p>AUTOSAR Release 2.1. </p>
<p>Oliver Hornung </p>
<p>2006-12-21 </p>
<p>1.01.00 </p>
<p>Reworked after User Review. </p>
<p>Oliver Hornung </p>
<p>2007-01-07 </p>
<p>1.02.00 </p>
<p>ESCAN00019105: Update to actual </p>
<p>implementation.</p>
<p> </p>
<p>Figures updated. </p>
<p>Oliver Hornung </p>
<p>2007-03-09 </p>
<p>1.03.00 </p>
<p>ESCAN00019899: Database attribute </p>
<p>description added. </p>
<p>Oliver Hornung </p>
<p>2007-04-11 </p>
<p>1.04.00 </p>
<p>ESCAN00020054: Limp Home Indication </p>
<p>feature added. </p>
<p>Oliver Hornung </p>
<p>2007-09-24 </p>
<p>2.00.00 </p>
<p>ESCAN00022463: Update to current Software </p>
<p>Specification for AUTOSAR Release 3 </p>
<p>Oliver Hornung </p>
<p>2008-02-01 </p>
<p>2.01.00 </p>
<p>Added coordination extension </p>
<p>Oliver Hornung </p>
<p>2008-03-12 </p>
<p>2.02.00 </p>
<p>ESCAN00025306: Channel link-time support. </p>
<p>Oliver Hornung </p>
<p>2008-04-02 </p>
<p>2.02.01 </p>
<p>Adapted coordination extension </p>
<p>Oliver Hornung </p>
<p>2008-04-21 </p>
<p>2.03.00 </p>
<p>ESCAN00025501: Renaming of Technical </p>
<p>Reference </p>
<p>Oliver Hornung </p>
<p>2008-05-02 </p>
<p>2.03.01 </p>
<p>Corrected Memory Mapping </p>
<p>Markus Schwarz </p>
<p>2008-05-30 </p>
<p>2.04.00 </p>
<p>Added description of coordination of multiple </p>
<p>NMs on one channel </p>
<p>Oliver Hornung </p>
<p>2008-08-20 </p>
<p>2.04.01 </p>
<p>ESCAN00028990: Added description for </p>
<p>synchronous restart / wake-up </p>
<p>Adapted configuration description. </p>
<p>Oliver Hornung </p>
<p>2008-08-22 </p>
<p>2.05.00 </p>
<p>ESCAN00028598: Added support for </p>
<p>Communication Manager AUTOSAR Release </p>
<p>2.1 </p>
<p>Oliver Hornung </p>
<p>2008-11-28 </p>
<p>2.06.00 </p>
<p>ESCAN00031694: Adapted Configuration; </p>
<p>Reworked Coordination Feature Description </p>
<p>Oliver Hornung </p>
<p>2009-03-31 </p>
<p>2.07.00 </p>
<p>ESCAN00034278: Chapters partly restructured; </p>
<p>Added chapter with service functions that are </p>
<p>used by NM Interface. </p>
<p>Oliver Hornung </p>
<p>2009-05-08 </p>
<p>2.07.01 </p>
<p>ESCAN34966: Reworked Coordinator </p>
<p>Extension Description </p>
<p>Oliver Hornung </p>
<p>2009-07-30 </p>
<p>2.08.00 </p>
<p>ESCAN00036624: Corrected OSEK NM </p>
<p>configuration dependency </p>
<p>ESCAN00036645: Added description for </p>
<p>Communication Control Handling in OSEK NM </p>
<p>ESCAN00036652: Added description for </p>
<p>Exclusive Areas </p>
<p>Oliver Hornung </p>
<p>2009-11-30 </p>
<p>2.09.00 </p>
<p>ESCAN00039161: Added feature description </p>
<p>‘NM user data via Com’ </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>3 / 104 </p>
<p>Oliver Hornung </p>
<p>2010-06-23 </p>
<p>2.10.00 </p>
<p>ESCAN00040933: Added description for API </p>
<p>‘EcuM_GeneratorCompatibilityError’ </p>
<p>ESCAN00043405: Added ‘Check Limp Home’ </p>
<p>API description </p>
<p>ESCAN00043406: Added feature description </p>
<p>‘OSEK NM State Change Notifications’ </p>
<p>ESCAN00043439: Added feature description </p>
<p>’Extended OSEK NM Initialization’ </p>
<p>Oliver Hornung </p>
<p>2010-07-22 </p>
<p>2.11.00 </p>
<p>ESCAN00043708: Added feature description </p>
<p>‘Gateway Extension’ </p>
<p>Oliver Hornung </p>
<p>2010-08-27 </p>
<p>2.12.00 </p>
<p>ESCAN00043781: Added feature description </p>
<p>‘Passive Coordinator’ </p>
<p>Oliver Hornung </p>
<p>2010-09-03 </p>
<p>2.13.00 </p>
<p>ESCAN00043776: Added feature description </p>
<p>‘Car Wakeup’ </p>
<p>ESCAN00043778: Added feature description </p>
<p>‘Set Nm State in User Data’ </p>
<p>ESCAN00043792: Added feature description </p>
<p>‘Partial Networking’ </p>
<p>Oliver Hornung </p>
<p>2011-02-17 </p>
<p>2.14.00 </p>
<p>ESCAN00045723 Removed Partial Networking </p>
<p>feature description </p>
<p>ESCAN00045745 Adapted description for </p>
<p>Communication Control </p>
<p>ESCAN00046522 Added description for Fiat </p>
<p>Class B Nm Support </p>
<p>ESCAN00046777 Added description for </p>
<p>Multiple Configuration support </p>
<p>Markus Drescher </p>
<p>2011-08-15 </p>
<p>2.15.00 </p>
<p>ESCAN00048814 Adapted description for </p>
<p>Multiple Configuration support </p>
<p>ESCAN00051939 Adapted function prototypes </p>
<p>in chapters 6.5.1, 6.6, 6.8 </p>
<p>Markus Drescher </p>
<p>2012-01-12 </p>
<p>2.16.00 </p>
<p>ESCAN00053241 Removed VStdLib and CAN </p>
<p>Driver critical section handling </p>
<p>ESCAN00056049 Added limitation that the use </p>
<p>case of a passive coordinator on AUTOSAR </p>
<p>channels is not recommended </p>
<p>Markus Drescher </p>
<p>2012-03-21 </p>
<p>2.16.01 </p>
<p>ESCAN00055255 Removed limitation </p>
<p>introduced with ESCAN00056049 </p>
<p>Markus Drescher </p>
<p>2012-06-19 </p>
<p>2.17.00 </p>
<p>ESCAN00059493 Adapted API descriptions for </p>
<p>availability of the functions in chapters 5.6.7.1, </p>
<p>5.6.8.1, 5.6.9.2  </p>
<p>Markus Drescher </p>
<p>2012-09-10 </p>
<p>2.18.00 </p>
<p>ESCAN00055254 Specified use case </p>
<p>descriptions more precisely in chapter 3.6, </p>
<p>adapted limitation description in chapter 3.1.3 </p>
<p>ESCAN00059749 Added descriptions of the </p>
<p>values written by Nm_GetState (chapter 5.6.1) </p>
<p>ESCAN00061120 Documented AUTOSAR </p>
<p>deviation of the Nm_Init function prototype </p>
<p>(chapters 5.5.1, 3.1.1) </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>4 / 104 </p>
<p>Markus Drescher </p>
<p>2012-11-22 </p>
<p>2.19.00 </p>
<p>ESCAN00062789 Added description for Fiat </p>
<p>Class C Nm Support </p>
<p>ESCAN00062966 Removed occurrences of </p>
<p>‘State Report Feature Enabled’ </p>
<p>ESCAN00062967 Added chapter 3.7 </p>
<p>ESCAN00063231 Updated Architecture </p>
<p>Overview Figure (chapter 2.2.1) </p>
<p>ESCAN00063246 Added further deviations from </p>
<p>[2] to chapter 6 </p>
<p>Markus Drescher </p>
<p>2013-03-05 </p>
<p>2.20.00 </p>
<p>ESCAN00064216 Added Coordinator Support </p>
<p>of Fiat Class B Nm and Fiat Class C Nm </p>
<p>Markus Drescher </p>
<p>2013-04-15 </p>
<p>2.21.00 </p>
<p>ESCAN00065792 Added deviation description </p>
<p>for Nm_ConfigType (chapter 3.1.1) </p>
<p>ESCAN00066111 Adapted chapter 3.1.1 </p>
<p>ESCAN00066647 Added chapter ‘Component </p>
<p>History’, Adapted chapters 2, 3, merged chapter </p>
<p>7 with chapter 3, swapped chapters 4 and 5, </p>
<p>removed ‘Compiler Abstraction and Memory </p>
<p>Mapping’ from chapter 4, various improvements </p>
<p>Markus Drescher </p>
<p>2013-10-01 </p>
<p>2.22.00 </p>
<p>ESCAN00069710 Adapted chapters that deal </p>
<p>with State Change Notifications by OSEK NM </p>
<p>ESCAN00070814 Extended description of NM </p>
<p>States in 5.6.1 </p>
<p> </p>
<p><b>Reference Documents </b></p>
<p><b>No. </b></p>
<p><b>Source </b></p>
<p><b>Title </b></p>
<p><b>Version </b></p>
<p>[1] </p>
<p>AUTOSAR </p>
<p>SRS AUTOSAR Network Management </p>
<p>3.0.0 </p>
<p>[2] </p>
<p>AUTOSAR </p>
<p>SWS NM Interface </p>
<p>1.3.0 </p>
<p>[3] </p>
<p>AUTOSAR </p>
<p>SWS CAN NM </p>
<p>3.4.0 </p>
<p>[4] </p>
<p>AUTOSAR </p>
<p>SWS FlexRay NM </p>
<p>3.3.0 </p>
<p>[5] </p>
<p>AUTOSAR </p>
<p>SWS CAN Interface </p>
<p>3.4.0 </p>
<p>[6] </p>
<p>AUTOSAR </p>
<p>SWS Communication Manager </p>
<p>2.3.0 </p>
<p>[7] </p>
<p>AUTOSAR </p>
<p>Specification of Development Error Tracer </p>
<p>2.2.2 </p>
<p>[8] </p>
<p>AUTOSAR </p>
<p>Specification of Diagnostic Event Manager </p>
<p>3.3.0 </p>
<p>[9] </p>
<p>AUTOSAR </p>
<p>Specification of BSW Scheduler </p>
<p>1.2.0 </p>
<p>[10] </p>
<p>Vector </p>
<p>AN-ISC-8-1118 MICROSAR BSW Compatibility Check </p>
<p>1.0.0 </p>
<p>[11] </p>
<p>Vector </p>
<p>Technical Reference MICROSAR Fiat Class B Network </p>
<p>Management </p>
<p>1.01.00 </p>
<p>[12] </p>
<p>Vector </p>
<p>Technical Reference MICROSAR Fiat Class C Network </p>
<p>Management </p>
<p>1.01.00 </p>
<p>[13] </p>
<p>Vector </p>
<p>Technical Reference MICROSAR ECUM </p>
<p>2.12.01 </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>5 / 104 </p>
<p> </p>
<p><b>Caution </b></p>
<p>We have configured the programs in accordance with your specifications in the </p>
<p>questionnaire. Whereas the programs do support other configurations than the one </p>
<p>specified in your questionnaire, Vector’s release of the programs delivered to your </p>
<p>company is expressly restricted to the configuration you have specified in the </p>
<p>questionnaire. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>6 / 104 </p>
<p><b>Contents </b></p>
<p><b>1</b></p>
<p> </p>
<p><b>Component History ...................................................................................................... 12</b></p>
<p> </p>
<p><b>2</b></p>
<p> </p>
<p><b>Introduction .................................................................................................................. 13</b></p>
<p> </p>
<p>2.1</p>
<p> </p>
<p>Naming Conventions ..................................................................................... 13</p>
<p> </p>
<p>2.2</p>
<p> </p>
<p>Architecture Overview ................................................................................... 14</p>
<p> </p>
<p>2.2.1</p>
<p> </p>
<p>Architecture of AUTOSAR Software .............................................................. 14</p>
<p> </p>
<p>2.2.2</p>
<p> </p>
<p>Architecture of AUTOSAR Network Management .......................................... 14</p>
<p> </p>
<p><b>3</b></p>
<p> </p>
<p><b>Functional Description ................................................................................................ 16</b></p>
<p> </p>
<p>3.1</p>
<p> </p>
<p>Features ........................................................................................................ 16</p>
<p> </p>
<p>3.1.1</p>
<p> </p>
<p>Deviations Against AUTOSAR 3.2 R 2 ........................................................... 16</p>
<p> </p>
<p>3.1.2</p>
<p> </p>
<p>Additions/ Extensions .................................................................................... 17</p>
<p> </p>
<p>3.1.2.1</p>
<p> </p>
<p>Filenames of NM Interface ............................................................... 17</p>
<p> </p>
<p>3.1.2.2</p>
<p> </p>
<p>Link-time Support ............................................................................ 17</p>
<p> </p>
<p>3.1.2.3</p>
<p> </p>
<p>Link-time Support for Channels ....................................................... 18</p>
<p> </p>
<p>3.1.2.4</p>
<p> </p>
<p>Configurable Service Callback Functions......................................... 18</p>
<p> </p>
<p>3.1.2.5</p>
<p> </p>
<p>Development Error Detection ........................................................... 18</p>
<p> </p>
<p>3.1.2.6</p>
<p> </p>
<p>Error Reporting to Diagnostic Event Manager .................................. 18</p>
<p> </p>
<p>3.1.2.7</p>
<p> </p>
<p>Memory Initialization ........................................................................ 18</p>
<p> </p>
<p>3.1.2.8</p>
<p> </p>
<p>Limp Home Indication ...................................................................... 18</p>
<p> </p>
<p>3.1.2.9</p>
<p> </p>
<p>Synchronous Restart / Wake-up Behavior ....................................... 18</p>
<p> </p>
<p>3.1.2.10</p>
<p> </p>
<p>OSEK NM Support .......................................................................... 19</p>
<p> </p>
<p>3.1.2.11</p>
<p> </p>
<p>Selective NM Channel ..................................................................... 19</p>
<p> </p>
<p>3.1.2.12</p>
<p> </p>
<p>Coordinator Extension ..................................................................... 19</p>
<p> </p>
<p>3.1.2.13</p>
<p> </p>
<p>Coordination of Multiple NMs on One Channel ................................ 19</p>
<p> </p>
<p>3.1.2.14</p>
<p> </p>
<p>ComM 2.1 Support .......................................................................... 19</p>
<p> </p>
<p>3.1.2.15</p>
<p> </p>
<p>Communication Control Support for OSEK NM................................ 19</p>
<p> </p>
<p>3.1.2.16</p>
<p> </p>
<p>NM User Data via Com .................................................................... 19</p>
<p> </p>
<p>3.1.2.17</p>
<p> </p>
<p>OSEK NM State Change Notifications ............................................. 19</p>
<p> </p>
<p>3.1.2.18</p>
<p> </p>
<p>OSEK NM Extended Initialization .................................................... 19</p>
<p> </p>
<p>3.1.2.19</p>
<p> </p>
<p>Gateway Extension .......................................................................... 19</p>
<p> </p>
<p>3.1.2.20</p>
<p> </p>
<p>Passive Coordinator ........................................................................ 19</p>
<p> </p>
<p>3.1.3</p>
<p> </p>
<p>Limitations ..................................................................................................... 20</p>
<p> </p>
<p>3.1.3.1</p>
<p> </p>
<p>Synchronized OSEK Channel .......................................................... 20</p>
<p> </p>
<p>3.1.3.2</p>
<p> </p>
<p>Extended Coordination Algorithm .................................................... 20</p>
<p> </p>
<p>3.2</p>
<p> </p>
<p>Adaptation Layer ........................................................................................... 20</p>
<p> </p>
<p>3.3</p>
<p> </p>
<p>Macro Layer Optimization.............................................................................. 20</p>
<p> </p>
<p>3.4</p>
<p> </p>
<p>Network Management Coordination .............................................................. 20</p>
<p> </p>
<p>3.4.1</p>
<p> </p>
<p>Selective Channels ....................................................................................... 21</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>7 / 104 </p>
<p>3.4.2</p>
<p> </p>
<p>Synchronous Channels ................................................................................. 21</p>
<p> </p>
<p>3.4.2.1</p>
<p> </p>
<p>Application Request Handler ........................................................... 22</p>
<p> </p>
<p>3.4.2.2</p>
<p> </p>
<p>Network Request Handler ................................................................ 22</p>
<p> </p>
<p>3.4.2.3</p>
<p> </p>
<p>State Machine for Shutdown ............................................................ 22</p>
<p> </p>
<p>3.4.3</p>
<p> </p>
<p>Coordination of Multiple NMs within one Channel ......................................... 23</p>
<p> </p>
<p>3.5</p>
<p> </p>
<p>Coordinator Extension ................................................................................... 23</p>
<p> </p>
<p>3.5.1</p>
<p> </p>
<p>Active Coordinator Detection ......................................................................... 24</p>
<p> </p>
<p>3.5.2</p>
<p> </p>
<p>Extended Shutdown Algorithm ...................................................................... 24</p>
<p> </p>
<p>3.5.3</p>
<p> </p>
<p>Coordinator Loss Detection ........................................................................... 25</p>
<p> </p>
<p>3.5.3.1</p>
<p> </p>
<p>Loss Detection Before Shutdown ..................................................... 25</p>
<p> </p>
<p>3.5.3.2</p>
<p> </p>
<p>Loss Detection During Shutdown ..................................................... 25</p>
<p> </p>
<p>3.5.4</p>
<p> </p>
<p>Algorithm Restrictions ................................................................................... 25</p>
<p> </p>
<p>3.5.4.1</p>
<p> </p>
<p>Not Covered Scenarios .................................................................... 25</p>
<p> </p>
<p>3.5.4.2</p>
<p> </p>
<p>Synchronous Shutdown Delay ......................................................... 26</p>
<p> </p>
<p>3.6</p>
<p> </p>
<p>Passive Coordinator ...................................................................................... 26</p>
<p> </p>
<p>3.6.1</p>
<p> </p>
<p>Algorithm Restrictions ................................................................................... 26</p>
<p> </p>
<p>3.7</p>
<p> </p>
<p>Provision of the NM State .............................................................................. 27</p>
<p> </p>
<p>3.7.1</p>
<p> </p>
<p>Determining the NM State Using Nm_GetState ............................................. 27</p>
<p> </p>
<p>3.7.2</p>
<p> </p>
<p>Using the ‘State Change Ind Enabled’ feature ............................................... 27</p>
<p> </p>
<p>3.8</p>
<p> </p>
<p>OSEK NM Support ........................................................................................ 27</p>
<p> </p>
<p>3.8.1</p>
<p> </p>
<p>API Mapping ................................................................................................. 28</p>
<p> </p>
<p>3.8.2</p>
<p> </p>
<p>Callback Mapping .......................................................................................... 28</p>
<p> </p>
<p>3.8.3</p>
<p> </p>
<p>Limitations ..................................................................................................... 29</p>
<p> </p>
<p>3.8.4</p>
<p> </p>
<p>NM Coordination ........................................................................................... 29</p>
<p> </p>
<p>3.8.5</p>
<p> </p>
<p>State Change Notifications ............................................................................ 29</p>
<p> </p>
<p>3.8.6</p>
<p> </p>
<p>Extended Initialization ................................................................................... 30</p>
<p> </p>
<p>3.9</p>
<p> </p>
<p>ComM 2.1 Support ........................................................................................ 31</p>
<p> </p>
<p>3.10</p>
<p> </p>
<p>Gateway Extension ....................................................................................... 31</p>
<p> </p>
<p>3.10.1</p>
<p> </p>
<p>Diagnostic Gateway Extension ...................................................................... 32</p>
<p> </p>
<p>3.10.2</p>
<p> </p>
<p>NM Gateway Extension ................................................................................. 32</p>
<p> </p>
<p>3.10.2.1</p>
<p> </p>
<p>Shutdown Criteria ............................................................................ 32</p>
<p> </p>
<p>3.10.2.2</p>
<p> </p>
<p>Wakeup Handling ............................................................................ 33</p>
<p> </p>
<p>3.10.2.3</p>
<p> </p>
<p>Coordination of Multiple NMs within One Channel ........................... 33</p>
<p> </p>
<p>3.11</p>
<p> </p>
<p>Car Wakeup .................................................................................................. 34</p>
<p> </p>
<p>3.12</p>
<p> </p>
<p>Set Nm State in User Data ............................................................................ 34</p>
<p> </p>
<p>3.13</p>
<p> </p>
<p>Multiple ECU Support .................................................................................... 34</p>
<p> </p>
<p>3.14</p>
<p> </p>
<p>Multiple Configuration Support ...................................................................... 35</p>
<p> </p>
<p>3.15</p>
<p> </p>
<p>Fiat Class B NM and Fiat Class C NM Support ............................................. 36</p>
<p> </p>
<p>3.15.1</p>
<p> </p>
<p>API Mapping ................................................................................................. 36</p>
<p> </p>
<p>3.15.2</p>
<p> </p>
<p>Callback Mapping .......................................................................................... 36</p>
<p> </p>
<p>3.15.3</p>
<p> </p>
<p>Limitations ..................................................................................................... 36</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>8 / 104 </p>
<p>3.16</p>
<p> </p>
<p>Error Handling ............................................................................................... 37</p>
<p> </p>
<p>3.16.1</p>
<p> </p>
<p>Development Error Detection ........................................................................ 37</p>
<p> </p>
<p>3.16.2</p>
<p> </p>
<p>Production Code Error Reporting .................................................................. 38</p>
<p> </p>
<p><b>4</b></p>
<p> </p>
<p><b>Integration .................................................................................................................... 39</b></p>
<p> </p>
<p>4.1</p>
<p> </p>
<p>Files .............................................................................................................. 39</p>
<p> </p>
<p>4.2</p>
<p> </p>
<p>Include Structure ........................................................................................... 40</p>
<p> </p>
<p>4.3</p>
<p> </p>
<p>Version Changes ........................................................................................... 40</p>
<p> </p>
<p>4.4</p>
<p> </p>
<p>Initialization ................................................................................................... 40</p>
<p> </p>
<p>4.5</p>
<p> </p>
<p>Main Function................................................................................................ 41</p>
<p> </p>
<p>4.6</p>
<p> </p>
<p>Critical Sections ............................................................................................ 42</p>
<p> </p>
<p>4.6.1</p>
<p> </p>
<p>Critical Section Codes ................................................................................... 42</p>
<p> </p>
<p><b>5</b></p>
<p> </p>
<p><b>API Description ............................................................................................................ 44</b></p>
<p> </p>
<p>5.1</p>
<p> </p>
<p>API Categories .............................................................................................. 44</p>
<p> </p>
<p>5.2</p>
<p> </p>
<p>Data Types .................................................................................................... 44</p>
<p> </p>
<p>5.3</p>
<p> </p>
<p>Global Variables ............................................................................................ 44</p>
<p> </p>
<p>5.4</p>
<p> </p>
<p>Global Constants ........................................................................................... 45</p>
<p> </p>
<p>5.4.1</p>
<p> </p>
<p>AUTOSAR Specification Version ................................................................... 45</p>
<p> </p>
<p>5.4.2</p>
<p> </p>
<p>Component Versions ..................................................................................... 45</p>
<p> </p>
<p>5.4.3</p>
<p> </p>
<p>Vendor and Module ID ................................................................................... 45</p>
<p> </p>
<p>5.5</p>
<p> </p>
<p>Administrative Functions Provided by NM Interface ...................................... 46</p>
<p> </p>
<p>5.5.1</p>
<p> </p>
<p>Nm_Init: Initialization of NM Interface ............................................................ 46</p>
<p> </p>
<p>5.5.2</p>
<p> </p>
<p>Nm_MainFunction: Main Function of the NM Interface .................................. 47</p>
<p> </p>
<p>5.6</p>
<p> </p>
<p>Service Functions Provided by NM Interface ................................................. 48</p>
<p> </p>
<p>5.6.1</p>
<p> </p>
<p>Nm_GetState: Get the State of the Network Management ............................ 48</p>
<p> </p>
<p>5.6.2</p>
<p> </p>
<p>Nm_GetVersionInfo: Version Information API ................................................ 50</p>
<p> </p>
<p>5.6.3</p>
<p> </p>
<p>Nm_PassiveStartUp: Wake-up Network Management................................... 51</p>
<p> </p>
<p>5.6.4</p>
<p> </p>
<p>Wake-up Registration .................................................................................... 52</p>
<p> </p>
<p>5.6.4.1</p>
<p> </p>
<p>Nm_NetworkRequest: Request the Network .................................... 52</p>
<p> </p>
<p>5.6.4.2</p>
<p> </p>
<p>Nm_NetworkRelease: Release the Network .................................... 53</p>
<p> </p>
<p>5.6.5</p>
<p> </p>
<p>Communication Control Service .................................................................... 54</p>
<p> </p>
<p>5.6.5.1</p>
<p> </p>
<p>Nm_DisableCommunication: Disable NM Message Transmission ... 54</p>
<p> </p>
<p>5.6.5.2</p>
<p> </p>
<p>Nm_EnableCommunication: Enable NM Message Transmission ..... 55</p>
<p> </p>
<p>5.6.6</p>
<p> </p>
<p>User Data Handling ....................................................................................... 56</p>
<p> </p>
<p>5.6.6.1</p>
<p> </p>
<p>Nm_SetUserData: Set User Data .................................................... 56</p>
<p> </p>
<p>5.6.6.2</p>
<p> </p>
<p>Nm_GetUserData: Get User Data.................................................... 57</p>
<p> </p>
<p>5.6.6.3</p>
<p> </p>
<p>Nm_GetPduData: Get NM Pdu Data ............................................... 58</p>
<p> </p>
<p>5.6.7</p>
<p> </p>
<p>Node Detection ............................................................................................. 59</p>
<p> </p>
<p>5.6.7.1</p>
<p> </p>
<p>Nm_RepeatMessageRequest: Set Repeat Message Request Bit .... 59</p>
<p> </p>
<p>5.6.7.2</p>
<p> </p>
<p>Nm_GetNodeIdentifier: Get Source Node Identifier ......................... 60</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>9 / 104 </p>
<p>5.6.7.3</p>
<p> </p>
<p>Nm_GetLocalNodeIdentifier: Get Local Source Node Identifier ....... 61</p>
<p> </p>
<p>5.6.8</p>
<p> </p>
<p>Remote Sleep Indication ............................................................................... 62</p>
<p> </p>
<p>5.6.8.1</p>
<p> </p>
<p>Nm_CheckRemoteSleepIndication: Check for Remote Sleep </p>
<p>Indication ......................................................................................... 62</p>
<p> </p>
<p>5.6.9</p>
<p> </p>
<p>Vector Extensions ......................................................................................... 63</p>
<p> </p>
<p>5.6.9.1</p>
<p> </p>
<p>Nm_InitMemory: Memory Initialization ............................................. 63</p>
<p> </p>
<p>5.6.9.2</p>
<p> </p>
<p>Nm_RequestBusSynchronization: Request Bus Synchronization .... 64</p>
<p> </p>
<p>5.6.9.3</p>
<p> </p>
<p>Nm_CheckLimpHomeIndication: Check the Limp Home Status ....... 65</p>
<p> </p>
<p>5.6.9.4</p>
<p> </p>
<p>Nm_SetGwRemoteSleepFilter: Set Remote Sleep Filter ................. 66</p>
<p> </p>
<p>5.6.9.5</p>
<p> </p>
<p>Nm_SetGwRemoteWakeupFilter: Set Remote Wakeup Filter .......... 67</p>
<p> </p>
<p>5.6.9.6</p>
<p> </p>
<p>Nm_WakeupNotification: Wakeup Notification ................................. 68</p>
<p> </p>
<p>5.6.9.7</p>
<p> </p>
<p>Nm_SetDiagGwReqId: Set Requested Diagnostic Node Identifier ... 69</p>
<p> </p>
<p>5.7</p>
<p> </p>
<p>Service Functions Used by NM Interface ....................................................... 70</p>
<p> </p>
<p>5.8</p>
<p> </p>
<p>Callback Functions Provided by NM Interface ............................................... 73</p>
<p> </p>
<p>5.8.1</p>
<p> </p>
<p>Nm_NetworkStartIndication: Network Start Indication ................................... 73</p>
<p> </p>
<p>5.8.2</p>
<p> </p>
<p>Nm_NetworkMode: Network Mode Indication ................................................ 74</p>
<p> </p>
<p>5.8.3</p>
<p> </p>
<p>Nm_PrepareBusSleepMode: Prepare Bus Sleep Mode Indication ................ 74</p>
<p> </p>
<p>5.8.4</p>
<p> </p>
<p>Nm_BusSleepMode: Bus Sleep Mode Indication .......................................... 75</p>
<p> </p>
<p>5.8.5</p>
<p> </p>
<p>Nm_RemoteSleepIndication: Remote Sleep Indication ................................. 75</p>
<p> </p>
<p>5.8.6</p>
<p> </p>
<p>Nm_RemoteSleepCancellation: NM Remote Sleep Cancellation .................. 76</p>
<p> </p>
<p>5.8.7</p>
<p> </p>
<p>Nm_PduRxIndication: NM Message Reception Indication ............................. 76</p>
<p> </p>
<p>5.8.8</p>
<p> </p>
<p>Nm_RepeatMessageIndication: Repeat Message Request Indication ........... 77</p>
<p> </p>
<p>5.8.9</p>
<p> </p>
<p>Nm_StateChangeNotification: State Change Notification .............................. 78</p>
<p> </p>
<p>5.8.10</p>
<p> </p>
<p>Nm_TxTimeoutException: Transmission Timeout Exception ......................... 79</p>
<p> </p>
<p>5.8.11</p>
<p> </p>
<p>Nm_CarWakeUpIndication: Car Wake-up Indication ..................................... 79</p>
<p> </p>
<p>5.8.12</p>
<p> </p>
<p>Vector Extensions ......................................................................................... 80</p>
<p> </p>
<p>5.8.12.1</p>
<p> </p>
<p>Nm_ActiveCoordIndication: Indication of an Active Coordinator </p>
<p>Bit .................................................................................................... 80</p>
<p> </p>
<p>5.8.12.2</p>
<p> </p>
<p>Nm_LimpHomeIndication: Limp Home Indication ............................ 81</p>
<p> </p>
<p>5.8.12.3</p>
<p> </p>
<p>Nm_LimpHomeCancelation: NM Remote Sleep Cancellation .......... 82</p>
<p> </p>
<p>5.8.12.4</p>
<p> </p>
<p>Nm_GwPduRxIndication: Extended Gateway Message Indication .. 83</p>
<p> </p>
<p>5.8.12.5</p>
<p> </p>
<p>OSEK NM Callback Functions ......................................................... 83</p>
<p> </p>
<p>5.9</p>
<p> </p>
<p>Callback Functions Used by NM Interface ..................................................... 85</p>
<p> </p>
<p>5.9.1</p>
<p> </p>
<p>Service Callback Functions of NM Interface .................................................. 85</p>
<p> </p>
<p>5.9.2</p>
<p> </p>
<p>Configurable Service Callback Functions ...................................................... 85</p>
<p> </p>
<p>5.9.3</p>
<p> </p>
<p>Additional Service Callback Functions of NM Interface .................................. 86</p>
<p> </p>
<p>5.9.3.1</p>
<p> </p>
<p>Callbacks for Limp Home Indication ................................................. 86</p>
<p> </p>
<p>5.9.3.2</p>
<p> </p>
<p>Callback for Diagnostic Gateway Extension ..................................... 86</p>
<p> </p>
<p>5.9.3.3</p>
<p> </p>
<p>Generator Compatibility Error .......................................................... 86</p>
<p> </p>
<p><b>6</b></p>
<p> </p>
<p><b>Configuration................................................................................................................ 87</b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>10 / 104 </p>
<p>6.1</p>
<p> </p>
<p>Configuration Variants ................................................................................... 87</p>
<p> </p>
<p>6.2</p>
<p> </p>
<p>Configuration in Data Base............................................................................ 87</p>
<p> </p>
<p>6.3</p>
<p> </p>
<p>Configuration with GENy ............................................................................... 88</p>
<p> </p>
<p>6.3.1</p>
<p> </p>
<p>Component Configuration ............................................................................. 89</p>
<p> </p>
<p>6.3.2</p>
<p> </p>
<p>Channel Configuration ................................................................................... 93</p>
<p> </p>
<p>6.3.3</p>
<p> </p>
<p>NM Coordination Restrictions ........................................................................ 96</p>
<p> </p>
<p>6.3.3.1</p>
<p> </p>
<p>Needed NM Features ...................................................................... 96</p>
<p> </p>
<p>6.3.3.2</p>
<p> </p>
<p>NM Main Function Cycle Time ......................................................... 96</p>
<p> </p>
<p>6.3.3.3</p>
<p> </p>
<p>Shutdown Timing ............................................................................. 96</p>
<p> </p>
<p>6.3.3.3.1</p>
<p> </p>
<p>Shutdown Time Calculation ............................................................. 97</p>
<p> </p>
<p>6.3.3.4</p>
<p> </p>
<p>Synchronized Channels ................................................................... 97</p>
<p> </p>
<p>6.3.4</p>
<p> </p>
<p>NM Extended Coordination Restrictions ........................................................ 98</p>
<p> </p>
<p>6.3.5</p>
<p> </p>
<p>OSEK NM Configuration ............................................................................... 98</p>
<p> </p>
<p>6.3.6</p>
<p> </p>
<p>Diagnostic Gateway Extension Configuration Restrictions .......................... 100</p>
<p> </p>
<p>6.3.7</p>
<p> </p>
<p>NM Gateway Extension Configuration Restrictions ..................................... 100</p>
<p> </p>
<p>6.3.8</p>
<p> </p>
<p>Fiat Class B NM / Fiat Class C NM Configuration Restrictions .................... 101</p>
<p> </p>
<p><b>7</b></p>
<p> </p>
<p><b>Glossary and Abbreviations ...................................................................................... 102</b></p>
<p> </p>
<p>7.1</p>
<p> </p>
<p>Abbreviations .............................................................................................. 102</p>
<p> </p>
<p>7.2</p>
<p> </p>
<p>Glossary ...................................................................................................... 103</p>
<p> </p>
<p><b>8</b></p>
<p> </p>
<p><b>Contact........................................................................................................................ 104</b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>11 / 104 </p>
<p><b>Illustrations </b></p>
<p>Figure 2-1</p>
<p> </p>
<p>Architecture of the AUTOSAR Stack ......................................................... 14</p>
<p> </p>
<p>Figure 2-2</p>
<p> </p>
<p>Interface to Adjacent Modules of the NM Interface .................................... 15</p>
<p> </p>
<p>Figure 3-1</p>
<p> </p>
<p>Request/Release Handling for Selective Channels ................................... 21</p>
<p> </p>
<p>Figure 3-2</p>
<p> </p>
<p>Request/Release Handling for Synchronous Channels ............................. 22</p>
<p> </p>
<p>Figure 3-3</p>
<p> </p>
<p>NM Coordination Scenario with 2 Coordinators ........................................ 24</p>
<p> </p>
<p>Figure 4-1</p>
<p> </p>
<p>Include Structure of Nm Interface ............................................................. 40</p>
<p> </p>
<p>Figure 6-1</p>
<p> </p>
<p>Component Selection in GENy ................................................................. 88</p>
<p> </p>
<p>Figure 6-2</p>
<p> </p>
<p>Component Configuration NM Interface .................................................... 89</p>
<p> </p>
<p>Figure 6-3</p>
<p> </p>
<p>Channel Configuration NM Interface ......................................................... 94</p>
<p> </p>
<p>Figure 6-4</p>
<p> </p>
<p>OSEK NM Configuration ........................................................................... 99</p>
<p> </p>
<p> </p>
<p><b>Tables </b></p>
<p>Table 1-1 </p>
<p> </p>
<p>Component history.................................................................................... 12</p>
<p> </p>
<p>Table 2-1 </p>
<p> </p>
<p>Module Prefixes ........................................................................................ 13</p>
<p> </p>
<p>Table 2-2 </p>
<p> </p>
<p>Additional Supported Network Managements ........................................... 13</p>
<p> </p>
<p>Table 3-1 </p>
<p> </p>
<p>Supported AUTOSAR standard conform features ..................................... 16</p>
<p> </p>
<p>Table 3-2 </p>
<p> </p>
<p>Features provided beyond the AUTOSAR standard .................................. 17</p>
<p> </p>
<p>Table 3-3 </p>
<p> </p>
<p>API Mapping for OSEK NM Channels ....................................................... 28</p>
<p> </p>
<p>Table 3-4 </p>
<p> </p>
<p>Callback Mapping for OSEK NM Channels ............................................... 28</p>
<p> </p>
<p>Table 3-5 </p>
<p> </p>
<p>OSEK NM State Change Notification Arguments: nmPreviousState and </p>
<p>nmCurrentState ........................................................................................ 30</p>
<p> </p>
<p>Table 3-6 </p>
<p> </p>
<p>OSEK NM Extended Initialization States ................................................... 31</p>
<p> </p>
<p>Table 3-7 </p>
<p> </p>
<p>Nm State Change Signal Values ............................................................... 34</p>
<p> </p>
<p>Table 3-8 </p>
<p> </p>
<p>Service IDs ............................................................................................... 38</p>
<p> </p>
<p>Table 3-9 </p>
<p> </p>
<p>DET Error Codes ...................................................................................... 38</p>
<p> </p>
<p>Table 4-1 </p>
<p> </p>
<p>File Names of the NM Interface ................................................................ 39</p>
<p> </p>
<p>Table 4-2 </p>
<p> </p>
<p>Critical Section Codes .............................................................................. 43</p>
<p> </p>
<p>Table 5-1 </p>
<p> </p>
<p>Global NM Types ...................................................................................... 44</p>
<p> </p>
<p>Table 5-2 </p>
<p> </p>
<p>NM Interface Data Types .......................................................................... 44</p>
<p> </p>
<p>Table 5-3 </p>
<p> </p>
<p>Specification Version API Data ................................................................. 45</p>
<p> </p>
<p>Table 5-4 </p>
<p> </p>
<p>Component Version API Data ................................................................... 45</p>
<p> </p>
<p>Table 5-5 </p>
<p> </p>
<p>Vendor and Module ID .............................................................................. 45</p>
<p> </p>
<p>Table 5-6 </p>
<p> </p>
<p>Services Used by the NM Interface ........................................................... 72</p>
<p> </p>
<p>Table 5-7 </p>
<p> </p>
<p>OSEK NM Callback Functions .................................................................. 84</p>
<p> </p>
<p>Table 6-1 </p>
<p> </p>
<p>Database Attributes .................................................................................. 87</p>
<p> </p>
<p>Table 6-2 </p>
<p> </p>
<p>Component Configuration NM Interface .................................................... 93</p>
<p> </p>
<p>Table 6-3 </p>
<p> </p>
<p>Channel Configuration NM Interface ......................................................... 95</p>
<p> </p>
<p>Table 6-4 </p>
<p> </p>
<p>Required Configuration Items for the NM Coordination ............................. 96</p>
<p> </p>
<p>Table 6-5 </p>
<p> </p>
<p>Common Shutdown Time Calculation ....................................................... 97</p>
<p> </p>
<p>Table 6-6 </p>
<p> </p>
<p>Required Items of Involved Components for Proper Usage of the </p>
<p>Coordinator Extension .............................................................................. 98</p>
<p> </p>
<p>Table 6-7 </p>
<p> </p>
<p>Required Configuration Items for Diagnostic Gateway Extension ........... 100</p>
<p> </p>
<p>Table 6-8 </p>
<p> </p>
<p>Required Configuration Items for NM Gateway Extension ...................... 100</p>
<p> </p>
<p>Table 6-9 </p>
<p> </p>
<p>Required Configuration Settings for Fiat Class B NM / Fiat Class C NM </p>
<p>Usage ..................................................................................................... 101</p>
<p> </p>
<p>Table 7-1 </p>
<p> </p>
<p>Abbreviations .......................................................................................... 102</p>
<p> </p>
<p>Table 7-2 </p>
<p> </p>
<p>Glossary ................................................................................................. 103</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>12 / 104 </p>
<p><b>1 </b></p>
<p><b>Component History </b></p>
<p>The </p>
<p>component </p>
<p>history </p>
<p>gives </p>
<p>an </p>
<p>overview </p>
<p>over </p>
<p>the </p>
<p>important </p>
<p>milestones </p>
<p>that </p>
<p>are </p>
<p>supported in the different versions of the component. </p>
<p><b>Component Version </b></p>
<p><b>New Features </b></p>
<p>1.00.00 </p>
<p>Creation for AUTOSAR 2.1 </p>
<p>1.03.00 </p>
<p>Added Limp Home Indication Feature </p>
<p>2.00.00 </p>
<p>Adaption for AUTOSAR 3 </p>
<p>2.01.00 </p>
<p>Added Coordinator Extension (Synchronization Support) Feature </p>
<p>2.03.00 </p>
<p>Added Channel Link-Time Support </p>
<p>2.08.00 </p>
<p>Added AUTOSAR 2.1 Communication Manager Support </p>
<p>2.14.00 </p>
<p>Added ‘User Data via Com’ Feature </p>
<p>2.15.00 </p>
<p>Added OSEK NM State Change Notification Support </p>
<p>Added OSEK NM Extended Initialization Support </p>
<p>2.16.00 </p>
<p>Added ‘Gateway Extension’ Feature </p>
<p>2.17.00 </p>
<p>Added ‘Passive Coordinator’ Feature </p>
<p>2.18.00 </p>
<p>Added ‘Car Wake Up’ Feature </p>
<p>Added ‘State Report’ Feature </p>
<p>2.19.00 </p>
<p>Added Fiat Class B NM Support </p>
<p>Added Multiple Configuration Support </p>
<p>2.26.00 </p>
<p>Added Fiat Class C NM Support </p>
<p>2.27.00 </p>
<p>Added Coordinator Support for Fiat Class B NM and Fiat Class C NM </p>
<p>2.29.00 </p>
<p>Adapted OSEK NM State Change Notification Support in order to support </p>
<p>the NM message being the first message on the bus </p>
<p>Table 1-1  </p>
<p>Component history </p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>13 / 104 </p>
<p><b>2 </b></p>
<p><b>Introduction </b></p>
<p>This </p>
<p>document </p>
<p>describes </p>
<p>the </p>
<p>concept, </p>
<p>features, </p>
<p>API </p>
<p>and </p>
<p>the </p>
<p>configuration </p>
<p>of </p>
<p>the </p>
<p>AUTOSAR </p>
<p>Network </p>
<p>Management </p>
<p>Interface. </p>
<p>Also </p>
<p>the </p>
<p>integration </p>
<p>of </p>
<p>the </p>
<p>Network </p>
<p>Management (NM) into the Vector CANbedded stack is covered by this document. </p>
<p>The FlexRay Network Management is not covered by this document. </p>
<p>Please  note  that  in  this  document  the  term Application  is  not  used  strictly  for  the  user </p>
<p>software but also for any higher software layer, like e.g. a Communication Control Layer. </p>
<p>Therefore, Application refers to any of the software components using the FlexRay NM. </p>
<p>For further information please also refer to the AUTOSAR SWS specifications referenced </p>
<p>in ‘Reference Documents’ </p>
<p><b>2.1 </b></p>
<p><b>Naming Conventions </b></p>
<p>The names of the service functions provided by the NM Interface, CAN NM and FlexRay </p>
<p>NM always start with a prefix that denominates the software component where the service </p>
<p>is located. E.g. a service that starts with ‘</p>
<p>Nm_</p>
<p>’ is implemented within the NM Interface. </p>
<p>In  case  of  callback  functions  to  the  COM  Manager  the  service  starts  with  the  term </p>
<p>‘</p>
<p>ComM_Nm_</p>
<p>’ to make clear it is a callback from the Network Management. E.g. ‘</p>
<p>ComM_Nm_</p>
<p>’ </p>
<p>denominates a service, which is implemented within the COM Manager and called by NM </p>
<p>Interface. </p>
<p><b>Naming conventions </b></p>
<p>Nm_ </p>
<p>Services of NM Interface (Nm). </p>
<p>CanNm_ </p>
<p>Services of CAN NM (CanNm). </p>
<p>FrNm_ </p>
<p>Services of FlexRay NM (FrNm). </p>
<p>BusNm_ </p>
<p>Services of the corresponding bus-specific NM </p>
<p>ComM_Nm_ </p>
<p>Callback services of NM Interface that are implemented within the </p>
<p>Communication Manager (ComM). </p>
<p>Det_ </p>
<p>Services of Development Error Tracer (Det). </p>
<p>Dem_ </p>
<p>Services of Diagnostic Event Manager (Dem). </p>
<p>Table 2-1  </p>
<p>Module Prefixes </p>
<p>The term ‘bus-specific NM’ does not only refer to the AUTOSAR CAN NM and FlexRay NM </p>
<p>but also to the additionally supported NMs listed in the following table with their according </p>
<p>bus type. </p>
<p><b>Bus Type </b></p>
<p><b>Additional supported bus-specific NM (Short name) </b></p>
<p>CAN </p>
<p>OSEK NM (NmOsek) </p>
<p>CAN </p>
<p>Fiat Class B (NmFiatB) </p>
<p>CAN </p>
<p>Fiat Class C (NmFiatC) </p>
<p>Table 2-2  </p>
<p>Additional Supported Network Managements </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>14 / 104 </p>
<p><b>2.2 </b></p>
<p><b>Architecture Overview </b></p>
<p><b>2.2.1 </b></p>
<p><b>Architecture of AUTOSAR Software </b></p>
<p>The </p>
<p>following </p>
<p>figure </p>
<p>shows </p>
<p>where </p>
<p>the </p>
<p>NM </p>
<p>Interface </p>
<p>is </p>
<p>located </p>
<p>in </p>
<p>the </p>
<p>AUTOSAR </p>
<p>architecture. </p>
<p> </p>
<p>Figure 2-1 </p>
<p>Architecture of the AUTOSAR Stack </p>
<p><b>2.2.2 </b></p>
<p><b>Architecture of AUTOSAR Network Management </b></p>
<p>The AUTOSAR Network Management consists of three modules: </p>
<p><b>&gt; </b> NM Interface </p>
<p><b>&gt; </b> CAN NM</p>
<p>1</p>
<p> </p>
<p><b>&gt; </b> FlexRay NM</p>
<p>1</p>
<p> </p>
<p>The NM Interface schedules function calls from the Communication Manager (ComM) to </p>
<p>the respective module for each channel, e.g. for a CAN channel the corresponding CAN </p>
<p>NM function will be called. It also provides the interface to ComM. NM Interface exclusively </p>
<p>interacts with these modules.  </p>
<p>The  communication  bus  specific  functionality  is  incorporated  in  the  corresponding  bus-</p>
<p>specific NM. Refer to the corresponding Technical References of the bus-specific network </p>
<p>managements for more information. </p>
<p>The  next  figure  shows  the  interfaces  to  adjacent  modules  of  the  NM  Interface.  These </p>
<p>interfaces are described in chapter 5 ‘API Description’. </p>
<p>                                            </p>
<p>1</p>
<p> Not covered by this document. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>15 / 104 </p>
<p> </p>
<p>Figure 2-2 </p>
<p>Interface to Adjacent Modules of the NM Interface </p>
<p>Applications do not access the services of the BSW modules directly. They use the service </p>
<p>ports provided by the BSW modules via the RTE. Since the NM Interface has no service </p>
<p>ports, the NM Interface cannot be accessed via RTE by the application. </p>
<p><b>class Architecture</b></p>
<p><b>CanNm</b></p>
<p><b>ComM</b></p>
<p><b>Com</b></p>
<p><b>Nm</b></p>
<p><b>FrNm</b></p>
<p><b>NmFiatB</b></p>
<p><b>NmDirOsek</b></p>
<p><b>NmFiatC</b></p>
<p><b>Det</b></p>
<p><b>BswM</b></p>
<p><b>CDD</b></p>
<p><b>SchM</b></p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>0..1</p>
<p>1</p>
<p>1</p>
<p>1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>0..1</p>
<p>1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<p>0..1</p>
<p>1</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>16 / 104 </p>
<p><b>3 </b></p>
<p><b>Functional Description </b></p>
<p><b>3.1 </b></p>
<p><b>Features </b></p>
<p>The Network Management is a network comprehensive protocol that provides services for </p>
<p>the organization of the network. It is a decentralized and direct network management. That </p>
<p>means  that  every  ECU  transmits  a  special  network  management  message,  which  is </p>
<p>reserved for the network management only. </p>
<p>The features listed in the following tables cover the complete functionality specified for the </p>
<p>Nm. </p>
<p>The AUTOSAR  standard  functionality  is  specified  in  [2],  the  corresponding  features  are </p>
<p>listed in the table </p>
<p><b></b></p>
<p><b> </b></p>
<p>Table 3-1   Supported AUTOSAR standard conform features </p>
<p>Vector Informatik provides further  Nm functionality beyond the AUTOSAR standard. The </p>
<p>corresponding features are listed in the table </p>
<p><b></b></p>
<p><b> </b></p>
<p>Table 3-2   Features provided beyond the AUTOSAR standard </p>
<p> </p>
<p>The following features specified in [2] are supported: </p>
<p><b>Supported AUTOSAR Standard Conform Features </b></p>
<p>Controlled transition of all ECU’s to bus-sleep mode and vice versa.  </p>
<p>User Data Handling </p>
<p>Node Detection </p>
<p>Remote Sleep Indication </p>
<p>Passive Mode Support </p>
<p>Coordination Functionality </p>
<p>Coordinator Synchronization Support </p>
<p>OSEK NM Support </p>
<p>NM User Data via Com </p>
<p>Car Wake-Up </p>
<p>Set Nm State in User Data </p>
<p>Table 3-1  </p>
<p>Supported AUTOSAR standard conform features </p>
<p><b>3.1.1 </b></p>
<p><b>Deviations Against AUTOSAR 3.2 R 2 </b></p>
<p>All deviations of the user requirements are documented within the System Requirements </p>
<p>Specification [1]. The implementation is based on the System Requirements Specification. </p>
<p>The following list provides the limitations of the NM Interface: </p>
<p><b>&gt; </b> Following additional dependencies between configuration parameters are added to </p>
<p>avoid bad configurations:  </p>
<p></p>
<p> </p>
<p>NM_COM_CONTROL_ENABLED</p>
<p> must be set to </p>
<p>OFF</p>
<p> for passive nodes. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>17 / 104 </p>
<p></p>
<p> </p>
<p>NM_NODE_DETECTION_ENABLED</p>
<p> must be set to </p>
<p>OFF</p>
<p> for passive nodes. </p>
<p>Furthermore,  the  function  prototype  of  Nm_Init  deviates  from  the  original  AUTOSAR </p>
<p>requirement in [2]. See also chapter 5.5.1. </p>
<p>The  function  prototype  of  Nm_ActiveCoordIndication  differs  from  the  original AUTOSAR </p>
<p>requirement in [2]. Refer to chapter 5.8.12.1 for details. </p>
<p>The </p>
<p>configuration </p>
<p>parameter </p>
<p>NmGlobalCoordinatorTime </p>
<p>mentioned </p>
<p>in </p>
<p>[2] </p>
<p>is </p>
<p>called </p>
<p>NmCoordinationShutdownTimer instead. </p>
<p>The  data  type  definition  of </p>
<p>Nm_ConfigType</p>
<p>  is  different  to  the  definition  mentioned  in </p>
<p>chapter 8.2.5 of [2]. </p>
<p><b>3.1.2 </b></p>
<p><b>Additions/ Extensions </b></p>
<p>The following features are provided beyond the AUTOSAR standard: </p>
<p><b>Features Provided Beyond The AUTOSAR Standard </b></p>
<p>Limp Home Indication </p>
<p>ComM 2.1 Support </p>
<p>Gateway Extension </p>
<p>Multiple ECU Support </p>
<p>Multiple Configuration Support </p>
<p>Fiat Class B Support </p>
<p>Fiat Class C Support </p>
<p>Table 3-2  </p>
<p>Features provided beyond the AUTOSAR standard </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>Additional non-AUTOSAR features are only available if they are explicitly ordered by </p>
<p>the customer. </p>
<p><b> </b></p>
<p><b> </b></p>
<p>These  and  the  following  extensions  of  the  NM  Interface  software  specification  ([2])  are </p>
<p>available  within  the  Network  Management  embedded  software  components.  If  required, </p>
<p>the extensions have to be enabled during configuration time. </p>
<p><b>3.1.2.1 </b></p>
<p><b>Filenames of NM Interface </b></p>
<p>In order to allow the integration of NM Interface together with OSEK NM the pre-compile </p>
<p>configuration  files  are  renamed  to  ‘</p>
<p>NmIf_Cfg</p>
<p>’  instead  of  ‘</p>
<p>Nm_Cfg</p>
<p>’  in  case  of  a  non </p>
<p>AUTOSAR CAN Driver is used and the OSEK NM Support is enabled. </p>
<p>For more information refer to chapter 4.1 ‘Files’ for an overview of the file names. </p>
<p><b>3.1.2.2 </b></p>
<p><b>Link-time Support </b></p>
<p>Up  to  now,  the  software  specifications  of  the  NM  Interface  only  specify  a  pre-compile </p>
<p>variant. To allow the usage of object code or libraries the link-time variant is available. </p>
<p>For more information refer to chapter 6 ‘Configuration’. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>18 / 104 </p>
<p><b>3.1.2.3 </b></p>
<p><b>Link-time Support for Channels </b></p>
<p>In [2] the number of channels is a pre-compile parameter and cannot be changed at link-</p>
<p>time. For a better library support it must be possible to add or remove channels at link-</p>
<p>time.  Therefore </p>
<p>the  NM </p>
<p>Interface </p>
<p>implementation </p>
<p>supports </p>
<p>link-time </p>
<p>changes </p>
<p>of  the </p>
<p>channels. </p>
<p>Note that the bus-specific NM types are not link-time able, i.e. only channels of already  </p>
<p>available bus-specific NMs can be added or removed (except the last channel of one bus-</p>
<p>specific NM type) at link-time. </p>
<p><b>3.1.2.4 </b></p>
<p><b>Configurable Service Callback Functions </b></p>
<p>As the handling for some optional callback functions from the underlying bus-specific NMs </p>
<p>is not specified the NM Interface provides for them a configurable interface to the upper </p>
<p>layer. </p>
<p>For more information refer to chapter 5.9.2 ‘Configurable Service Callback Functions’. </p>
<p><b>3.1.2.5 </b></p>
<p><b>Development Error Detection </b></p>
<p>As the specified development errors in [2] are not sufficient the implementation will report </p>
<p>additional development errors. </p>
<p>For more information refer to chapter 3.16.1‘Development Error Detection’. </p>
<p><b>3.1.2.6 </b></p>
<p><b>Error Reporting to Diagnostic Event Manager </b></p>
<p>According to the AUTOSAR specifications error reporting to the Diagnostic Event Manager </p>
<p>is  mandatory.  If  the AUTOSAR  NM  is  used  in  environments  without  a  Diagnostic  Event </p>
<p>Manager  it  should  be  possible  to  deactivate  the  error  reporting.  Therefore  the  switch </p>
<p>NM_PROD_ERROR_DETECT</p>
<p> has been added. </p>
<p>For more information refer to chapter 6.3.1 ‘Component Configuration’. </p>
<p><b>3.1.2.7 </b></p>
<p><b>Memory Initialization </b></p>
<p>Not every start-up code of embedded targets and neither CANoe reinitialize all variables </p>
<p>correctly. It thus may happen that the state of a variable may be not initialized, when this </p>
<p>should  be  the  case.  It  therefore  needs  to  be  initialized  explicitly  by  the  corresponding </p>
<p>module. </p>
<p>For more information refer to chapter 5.6.9.1 ‘Nm_InitMemory: Memory Initialization’. </p>
<p><b>3.1.2.8 </b></p>
<p><b>Limp Home Indication </b></p>
<p>This additional feature allows the detection and cancellation of Limp Home, i.e. if no NM </p>
<p>message could be received and transmitted for a certain amount of time. Please note that </p>
<p>this feature is OEM-specific and not available by default. If available it can be activated or </p>
<p>deactivated in the configuration. </p>
<p>For more information refer to chapter 6 ‘Configuration’. </p>
<p><b>3.1.2.9 </b></p>
<p><b>Synchronous Restart / Wake-up Behavior </b></p>
<p>The  state  machine  for  the  synchronous  shutdown  must  consider  an  abortion  of  the </p>
<p>shutdown  due  to  communication  need  on any  of  the  coordinated channels.  For keeping </p>
<p>the algorithm simple the state machine does also cover the use case where at least one or </p>
<p>all channels are asleep. Therefore this implementation also supports a synchronous restart </p>
<p>and wake-up behavior. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>19 / 104 </p>
<p>For more information refer to chapter 3.4.2.3 ‘State Machine for Shutdown’ </p>
<p><b>3.1.2.10 </b></p>
<p><b>OSEK NM Support </b></p>
<p>OSEK NM Support is independently available from the NM Coordination Support. </p>
<p><b>3.1.2.11 </b></p>
<p><b>Selective NM Channel </b></p>
<p>AUTOSAR only allows the NM Coordination for all channels of the ECU. To allow separate </p>
<p>handling  of  channels  that  must  not  have  a  synchronized  shutdown,  a  channel  can  be </p>
<p>enabled </p>
<p>to </p>
<p>be </p>
<p>selective. </p>
<p>Selective </p>
<p>NM </p>
<p>Channels </p>
<p>are </p>
<p>not </p>
<p>considered </p>
<p>for </p>
<p>the </p>
<p>NM </p>
<p>Coordination algorithm. </p>
<p>For more information refer to chapter 3.4.1 ‘Selective Channels’. </p>
<p><b>3.1.2.12 </b></p>
<p><b>Coordinator Extension </b></p>
<p>For  supporting  scenarios  where  more  than  one  coordinator  is  connected  to  the  same </p>
<p>channel this extended coordinator algorithm can be used. </p>
<p>For more information refer to chapter 3.5 ‘Coordinator Extension’. </p>
<p><b>3.1.2.13 </b></p>
<p><b>Coordination of Multiple NMs on One Channel </b></p>
<p>The NM Coordinator is extended to work with different NMs on the same network. </p>
<p>For  more  information  refer  to  chapter  3.4.3  ‘Coordination  of  Multiple  NMs  within  one </p>
<p>Channel’. </p>
<p><b>3.1.2.14 </b></p>
<p><b>ComM 2.1 Support </b></p>
<p>The NM supports integration together with an AUTOSAR 2.1 Communication Manager. </p>
<p>For more information refer to chapter 3.9 ‘ComM 2.1 Support’. </p>
<p><b>3.1.2.15 </b></p>
<p><b>Communication Control Support for OSEK NM </b></p>
<p>The communication control feature is also available for OSEK NM. Refer to chapter 3.8.1 </p>
<p>‘API Mapping’ for the mapping to the corresponding OSEK NM functions. </p>
<p><b>3.1.2.16 </b></p>
<p><b>NM User Data via Com </b></p>
<p>The MICROSAR NM supports the possibility to write the NM user data via Com signals. </p>
<p>For details please refer to the Technical References of CAN NM and FlexRay NM. </p>
<p><b>3.1.2.17 </b></p>
<p><b>OSEK NM State Change Notifications </b></p>
<p>State Change Notifications are provided in case of a state change of OSEK NM. Refer to </p>
<p>chapter 3.8.5 ‘State Change Notifications’ for further information. </p>
<p><b>3.1.2.18 </b></p>
<p><b>OSEK NM Extended Initialization </b></p>
<p>OSEK NM can be initialized with initialization modes other than only ‘Sleep’. See chapter </p>
<p>3.8.6 ‘Extended Initialization’ for details. </p>
<p><b>3.1.2.19 </b></p>
<p><b>Gateway Extension </b></p>
<p>The  Gateway  Extension  contains  two  sub-features,  Diagnostic  Gateway  Extension  and </p>
<p>Network  Management  Gateway  Extension.  For  more  information  refer  to  chapter  3.10 </p>
<p>‘Gateway Extension’. </p>
<p><b>3.1.2.20 </b></p>
<p><b>Passive Coordinator </b></p>
<p>The feature ‘Passive Coordinator’ allows in addition to the feature ‘Coordinator Extension’ </p>
<p>having OSEK NM channels connected to more than one coordinator. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>20 / 104 </p>
<p>For details refer to chapter 3.6 ‘Passive Coordinator’. </p>
<p><b>3.1.3 </b></p>
<p><b>Limitations </b></p>
<p><b>3.1.3.1 </b></p>
<p><b>Synchronized OSEK Channel </b></p>
<p>Since  it  is  only  possible  to  synchronize  the NM  Coordination to one  OSEK  channel this </p>
<p>channel has to explicitly chosen in the configuration (see also chapter 6 ‘Configuration’). </p>
<p><b>3.1.3.2 </b></p>
<p><b>Extended Coordination Algorithm </b></p>
<p>A  coordinator  in  passive  mode  behaves  only  correct  on  all  channels  if  all  passively </p>
<p>coordinated channels are connected to the same active coordinator. </p>
<p>For more information refer to chapter 3.5.4 ‘Algorithm Restrictions’. </p>
<p>The  function  Nm_CoordReadyToSleepIndication  specified  in  [2]  is  not  provided  by  Nm. </p>
<p>The </p>
<p>indication </p>
<p>for </p>
<p>sleep </p>
<p>readiness </p>
<p>shall </p>
<p>be </p>
<p>provided </p>
<p>instead </p>
<p>to </p>
<p>Nm </p>
<p>by </p>
<p>Nm_ActiveCoordIndication. </p>
<p>The  functions  CanNm_SetSleepReadyBit  and  FrNm_SetSleepReadyBit  are  not  used  by </p>
<p>Nm. </p>
<p>Instead, </p>
<p>the </p>
<p>functions </p>
<p>CanNm_SetCoordBits </p>
<p>and </p>
<p>FrNm_SetCoordBits </p>
<p>are </p>
<p>used </p>
<p>instead to indicate whether the coordinator is ready to sleep or not. </p>
<p>The following chapters provide a detailed description of the NM functionality. </p>
<p><b>3.2 </b></p>
<p><b>Adaptation Layer </b></p>
<p>The </p>
<p>NM </p>
<p>Interface </p>
<p>shall </p>
<p>act </p>
<p>as </p>
<p>a </p>
<p>bus-independent </p>
<p>adaptation </p>
<p>layer </p>
<p>between </p>
<p>the </p>
<p>Communication Manager and the bus-specific network managements. Currently supported </p>
<p>are the CAN and the FlexRay NM. AUTOSAR plans to also support LIN NM in the future. </p>
<p>Mainly  for  the  coordination  with  channels  where  OSEK  NM  is  running  the  NM  Interface </p>
<p>supports optionally OSEK NM (refer to chapter 3.8 ‘OSEK NM Support’). Additionally the </p>
<p>usage of Fiat Class B NM and Fiat Class C NM is supported (see also chapter 3.15 ‘Fiat </p>
<p>Class B NM and Fiat Class C NM Support’). </p>
<p><b>3.3 </b></p>
<p><b>Macro Layer Optimization </b></p>
<p>If the NM Interface provides no other functionality than mapping API calls from the higher </p>
<p>layer to exclusively AUTOSAR CAN NM, exclusively AUTOSAR FlexRay NM, exclusively </p>
<p>MICROSAR Fiat Class B NM or exclusively MICROSAR Fiat Class C NM, the complete </p>
<p>layer  can  be  optimized  to  be  a  macro  layer  in  order to  save  precious  resources  (ROM, </p>
<p>RAM and CPU load). Also refer to chapter 6 ‘Configuration’. </p>
<p>Please </p>
<p>note </p>
<p>that </p>
<p>Macro </p>
<p>Layer </p>
<p>optimization </p>
<p>can </p>
<p>only </p>
<p>be </p>
<p>enabled </p>
<p>in </p>
<p>pre-compile </p>
<p>configurations  and  in  configurations  where </p>
<p>the  NM </p>
<p>Interface  does  not </p>
<p>provide  own </p>
<p>algorithms (e.g. Coordinator or Gateway algorithm). </p>
<p><b>3.4 </b></p>
<p><b>Network Management Coordination </b></p>
<p>The  feature  ‘NM  coordination’  is  optional  and  can  be  used  in  ECUs  with  gateway </p>
<p>functionality and the requirement that at least two busses of the gateway have to be shut </p>
<p>down synchronously. The gateway keeps all connected networks awake as long as at least </p>
<p>one NM node is not ready for sleep. This could be either the gateway itself or any node on </p>
<p>any synchronous network. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>21 / 104 </p>
<p>To allow additionally that some networks can still be handled asynchronously each channel </p>
<p>can  be  configured  to  if  it  is  synchronous  or selective  (refer  also  chapter  6.3.2  ‘Channel </p>
<p>Configuration’). </p>
<p><b>3.4.1 </b></p>
<p><b>Selective Channels </b></p>
<p>Selective  channels  behave  like  un-coordinated  channels.  Network  request/releases  are </p>
<p>directly processed and passed on to the underlying bus-specific NM. The following figure </p>
<p>illustrates this handling for selective channels: </p>
<p> </p>
<p> </p>
<p>Figure 3-1 </p>
<p>Request/Release Handling for Selective Channels </p>
<p><b>3.4.2 </b></p>
<p><b>Synchronous Channels </b></p>
<p>Synchronous channels are coordinated. Coordination is done by the coordinator. The </p>
<p>coordinator is based on a cyclic task function (see chapter 4.5 ‘Main Function’). </p>
<p>The coordinator consists of three elements </p>
<p><b>&gt; </b> Application Request Handler </p>
<p><b>&gt; </b> Network Request Handler </p>
<p><b>&gt; </b> Statemachine for Shutdown </p>
<p>The  following  figure  provides  an  overview  of  the  network  request/release  handling  for </p>
<p>synchronous channels: </p>
<p> </p>
<p>NM 4</p>
<p>Nm</p>
<p>Application (ComM)</p>
<p>BusNm</p>
<p>callbacks</p>
<p>Nm_NetworkRequest</p>
<p>()</p>
<p>&lt;BusNm&gt;_NetworkRequest()</p>
<p>&lt;BusNm&gt;_NetworkRelease()</p>
<p>Nm_NetworkRelease</p>
<p>()</p>
<p>NM 4</p>
<p>Nm</p>
<p>Application (ComM)</p>
<p>BusNm</p>
<p>callbacks</p>
<p>Nm_NetworkRequest</p>
<p>()</p>
<p>&lt;BusNm&gt;_NetworkRequest()</p>
<p>&lt;BusNm&gt;_NetworkRelease()</p>
<p>Nm_NetworkRelease</p>
<p>()</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>22 / 104 </p>
<p> </p>
<p>Figure 3-2 </p>
<p>Request/Release Handling for Synchronous Channels </p>
<p><b>3.4.2.1 </b></p>
<p><b>Application Request Handler </b></p>
<p>Network requests are directly performed. The request is also notified to the Application </p>
<p>Request Handler. </p>
<p>Network releases for synchronous channels are redirected to the Application Request </p>
<p>Handler. The network release is not directly performed.  </p>
<p>The  Application  Request  Handler  combines  the  pending  requests  for  all  synchronous </p>
<p>channels. The result influences the state machine for shutdown. </p>
<p><b>3.4.2.2 </b></p>
<p><b>Network Request Handler </b></p>
<p>The bus-specific NM of each synchronous network checks if any of the other nodes on the </p>
<p>network is not ready for sleep. This information is polled by the Network Request Handler. </p>
<p>If  all  nodes  on  a  network  signal  readiness  for  sleep,  the  network  is  said  to  be  Remote </p>
<p>Sleep Indication. </p>
<p>The Network Request Handler combines the status of the Remote Sleep Indication of all </p>
<p>synchronous channels. The result influences the state of the Statemachine for Shutdown. </p>
<p><b>3.4.2.3 </b></p>
<p><b>State Machine for Shutdown </b></p>
<p>The coordinator checks the communication status of all synchronous channels. The </p>
<p>communication status is derived from the status of the Application Request Handler and </p>
<p>the Network Request Handler. </p>
<p>If no communication is required, the shutdown procedure starts. A network-specific delay </p>
<p>time is determined for each synchronous channel. The timing depends on the used types </p>
<p>of channels and their timings. </p>
<p> </p>
<p>NM 4</p>
<p>Nm</p>
<p>Coordinator</p>
<p>Application (ComM)</p>
<p>BusNm</p>
<p>&lt;BusNm&gt;_NetworkRequest() &lt;BusNm&gt;_NetworkRelease()</p>
<p>callbacks</p>
<p>Nm_NetworkRequest()</p>
<p>Nm_NetworkRelease()</p>
<p>NM 4</p>
<p>Nm</p>
<p>Coordinator</p>
<p>Application (ComM)</p>
<p>BusNm</p>
<p>&lt;BusNm&gt;_NetworkRequest() &lt;BusNm&gt;_NetworkRelease()</p>
<p>callbacks</p>
<p>Nm_NetworkRequest()</p>
<p>Nm_NetworkRelease()</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>23 / 104 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The shutdown time depends on the maximum shutdown timing of all channels. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>If on one synchronous channel OSEK NM is running, the shutdown algorithm is based on </p>
<p>the timing of this network, i.e. the size of the logical NM ring. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If multiple synchronous channels with OSEK NM are used, synchronous shutdown </p>
<p>cannot be guaranteed. The timing has to be based on one of the NM OSEK channels. </p>
<p>This decision is done by explicitly setting the OSEK NM channel that should be used as </p>
<p>base for the synchronous shutdown in the configuration (see chapter 3.8.4 ‘NM </p>
<p>Coordination’). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>If the coordinator detects any need for communication during or after the shutdown </p>
<p>procedure, it ensures that all synchronous channels are restarted again. In case a channel </p>
<p>is already asleep this channel will be woken up by calling </p>
<p>void <b>ComM_Nm_RestartIndication </b>( </p>
<p><b> </b></p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p>(5.9.1) </p>
<p>Therefore  the  coordination  algorithm  also  covers  the  synchronous  restart/wake-up  use </p>
<p>case. </p>
<p><b>3.4.3 </b></p>
<p><b>Coordination of Multiple NMs within one Channel </b></p>
<p>The coordination feature supports an AUTOSAR CAN NM and an OSEK NM running both </p>
<p>on the same network. Both NMs are synchronized for shutdown as far as possible.  </p>
<p>Externally this channel behaves like an AUTOSAR CAN NM channel, i.e. any API access </p>
<p>or callback notification is related to the CAN NM. The OSEK NM is handled only internally. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>Channels with multiple NMs need to be coordinated, i.e. the coordination feature must </p>
<p>be enabled and the channel must be synchronous. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>3.5 </b></p>
<p><b>Coordinator Extension </b></p>
<p>For supporting more than one coordinator connected to the same channel it is necessary </p>
<p>to  extend  the  coordination  algorithm  to  prevent  that  the  coordinators  keep  themselves </p>
<p>awake  one  another.  It  has  to  be  ensured  that  only  one  coordinator  coordinates  this </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>24 / 104 </p>
<p>channel actively. All other coordinators act as passive coordinators and just synchronize </p>
<p>their other channels with this one. </p>
<p>The following figure shows such a scenario: </p>
<p> </p>
<p>Figure 3-3 </p>
<p>NM Coordination Scenario with 2 Coordinators </p>
<p><b>3.5.1 </b></p>
<p><b>Active Coordinator Detection </b></p>
<p>Each Coordinator needs for the extension a priority ID that is unique on each channel. For </p>
<p>the configuration of this ID please refer to chapter 6.3.1 ‘Component Configuration’. This Id </p>
<p>is transmitted within the NM message and the coordinator with the highest ID will take over </p>
<p>the  coordination.  All  other  coordinators  reset  their  delay  timer  and  switch  to  passive </p>
<p>coordination for this channel. In passive coordination mode the coordinators won’t transmit </p>
<p>their priority ID. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>As this priority is transmitted within the Control Bit Vector of the NM message and </p>
<p>reserves only just two bits at most 3 coordinators at one channel are allowed. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>3.5.2 </b></p>
<p><b>Extended Shutdown Algorithm </b></p>
<p>Coordinators that act passively on one channel release the communication on this channel </p>
<p>as  soon  as  all  their  other  channels  and  their  applications  are  ready  to  sleep.  Those </p>
<p>coordinators then wait for the ‘Announce Sleep Bit’. This bit is set by the active coordinator </p>
<p>as soon as he detects readiness for sleep on all channels (including his application) and </p>
<p>he  starts  the  shutdown.  This  bit  is  forwarded  as  soon  as  received  on  the  passively </p>
<p>coordinated channel to all actively coordinated AUTOSAR NM channels and the shutdown </p>
<p>is started. </p>
<p>If  at  least  one  channel  on  the  coordinator  node  communication  is  needed  again  the </p>
<p>shutdown  is  aborted. The  active  coordinator  on  this  channel  removes  the  sleep  bit  and </p>
<p>sends its NM message with its priority. All passive coordinators recognize that the sleep bit </p>
<p>has been deleted and abort their shutdown also. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>25 / 104 </p>
<p>Synchronous shutdown timing for all channels is achieved by setting the ‘NM Coordination </p>
<p>Shutdown Timer’ (see chapter 6.3.1 ‘Component Configuration’) to the same value on all </p>
<p>coordinator nodes (refer also to chapter 6.3.4 ‘NM Extended Coordination Restrictions’). </p>
<p><b>3.5.3 </b></p>
<p><b>Coordinator Loss Detection </b></p>
<p>Coordinators  that  act  passively  on  a  channel  must  be  able </p>
<p>to  detect </p>
<p>if </p>
<p>the  active </p>
<p>coordinator fails. In that case the coordinator with the next highest priority will take over the </p>
<p>coordination. This detection mechanism is time based with two different timings depending </p>
<p>whether  the  active  coordinator  already  started  the  synchronous  shutdown  or  not.  Both </p>
<p>scenarios are discussed in the corresponding sub-chapters. </p>
<p><b>3.5.3.1 </b></p>
<p><b>Loss Detection Before Shutdown </b></p>
<p>While the coordination is ongoing due to communication is needed on at least one channel </p>
<p>the active coordinator sends its message with its priority normally. Therefore the timeout is </p>
<p>set to two times the message cycle time</p>
<p>2</p>
<p> for having a short reaction time on a possible </p>
<p>loss of the active coordinator. </p>
<p><b>3.5.3.2 </b></p>
<p><b>Loss Detection During Shutdown </b></p>
<p>When the active coordinator started the shutdown phase it will release communication and </p>
<p>enter Ready Sleep state. It then stops sending its NM message</p>
<p>3</p>
<p> with priority and sleep bit </p>
<p>set. Therefore the timeout is set to the shutdown time of this channel (i.e. the time from </p>
<p>entering  Ready  Sleep  state  until  Bus  Sleep  is  reached).  If  this  time  elapses  and  the </p>
<p>channel has  not  been  shut down  but  also was  not  restarted  by  the active  coordinator a </p>
<p>further </p>
<p>node </p>
<p>has </p>
<p>communication </p>
<p>need </p>
<p>and </p>
<p>keeps </p>
<p>the </p>
<p>bus </p>
<p>awake </p>
<p>while </p>
<p>the </p>
<p>active </p>
<p>coordinator failed. </p>
<p><b>3.5.4 </b></p>
<p><b>Algorithm Restrictions </b></p>
<p>In  this  chapter  restrictions  of  the  usage  of  this  extension  are  discussed.  Configuration </p>
<p>restrictions for this extension are discussed in chapter  6.3.4 ‘NM Extended Coordination </p>
<p>Restrictions’. </p>
<p><b>3.5.4.1 </b></p>
<p><b>Not Covered Scenarios </b></p>
<p>This  extension  of  the  coordination  algorithm  cannot  handle  scenarios  where  more  than </p>
<p>one coordinator is connected to a non-AUTOSAR channel (i.e. a channel where OSEK NM </p>
<p>is running). </p>
<p>The  algorithm  is  not  capable  to  synchronize  shutdown  correctly  if  the  coordinator  acts </p>
<p>passively on more than one channel due to the conflict that could appear when on one of </p>
<p>those channels the ‘Announce Sleep Bit’ is already set but not on another channel. In such </p>
<p>a situation the coordinator keeps all actively coordinated channels awake until the sleep bit </p>
<p>is received on all passively coordinated channels. </p>
<p>Apart  from  this  restriction  are  scenarios  where  all  passively  coordinated  channels  are </p>
<p>connected  to  the  same  active  coordinator,  e.g.  backup  coordinators.  Here  the  sleep </p>
<p>indication bit from the active coordinator will appear almost at the same time on all passive </p>
<p>channels. </p>
<p>                                            </p>
<p>2</p>
<p> Note that in case of FlexRay NM the data cycle time is taken as message cycle time due to the Control Bit </p>
<p>Vector information is relevant for the loss detection. </p>
<p>3</p>
<p> Note that in case of FlexRay data message is send in the static part NM message data is still transmitted in </p>
<p>Ready Sleep. The loss detection mechanism in this case works also. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>26 / 104 </p>
<p><b>3.5.4.2 </b></p>
<p><b>Synchronous Shutdown Delay </b></p>
<p>Coordinators that act passively on one channel will have a small delay on the start of their </p>
<p>synchronous shutdown. This delay depends on the time difference between the point in </p>
<p>time  where  the  active  coordinator  sets  the  ‘Announce  Sleep  Bit’  and  the  point  in  time </p>
<p>where this bit is then transmitted and received. </p>
<p>If the Coordinator that acts passively on one channel has to coordinate on another channel </p>
<p>an OSEK NM actively then this delay will be increased for this OSEK NM channel by the </p>
<p>time until the OSEK NM token is available again in the Coordinator node. </p>
<p><b>3.6 </b></p>
<p><b>Passive Coordinator </b></p>
<p>The  ‘Passive  Coordinator’  feature  is  an  add-on  of  the  ‘Coordinator  Extension’  (refer  to </p>
<p>chapter 3.5 ‘Coordinator Extension’). A channel that is configured for passive coordination </p>
<p>behaves always as if a coordinator with a higher priority is active, regardless of the own </p>
<p>priority and whether any other coordinator is active on that channel or not. Therefore no </p>
<p>timeout monitoring is performed and loss detection of the active coordinator is not possible </p>
<p>on such a channel. </p>
<p>This feature allows scenarios where a channel shall be regarded for coordination but shall </p>
<p>not be kept awake if application and all actively coordinated channels are ready to sleep. It </p>
<p>can be used for example to have more than one coordinator on non-AUTOSAR networks </p>
<p>(i.e. OSEK NM) or for having more than three coordinators connected to the same bus. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Vector recommends using a passive coordinator configuration on AUTOSAR networks </p>
<p>only if more than three coordinators are connected to the same bus. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>On a channel that is configured for passive coordination the ‘Announce Sleep Bit’ may not </p>
<p>be available. Therefore the coordinator accepts additionally the transition to ‘Bus Sleep’ on </p>
<p>this channel as trigger that the channel is ready for shutdown. The shutdown of all actively </p>
<p>coordinated </p>
<p>channels </p>
<p>is </p>
<p>started </p>
<p>when </p>
<p>all </p>
<p>passively </p>
<p>coordinated </p>
<p>channels </p>
<p>indicate </p>
<p>readiness for shutdown. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>On channels that are not configured to passive coordination the ‘Announce Sleep Bit’ is </p>
<p>still required on passively coordinated as otherwise the timeout monitoring will prevent </p>
<p>that the coordinator will shut down. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>3.6.1 </b></p>
<p><b>Algorithm Restrictions </b></p>
<p>When  not  having  the  ‘Announce  Sleep  Bit’  as  trigger  for  shutdown  readiness  on  all </p>
<p>passively  coordinated  channels,  the  shutdown  cannot  be  synchronized  exactly  to  the </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>27 / 104 </p>
<p>actively coordinated channels as their shutdown will start when the passively coordinated </p>
<p>channel is already asleep. </p>
<p><b>3.7 </b></p>
<p><b>Provision of the NM State </b></p>
<p>The NM State can be determined either by using the function </p>
<p>Nm_ReturnType <b>Nm_GetState </b></p>
<p>( const NetworkHandleType  nmChannelHandle, </p>
<p> Nm_StateType* const  </p>
<p>nmStatePtr, </p>
<p> Nm_ModeType* const  </p>
<p>nmModePtr )</p>
<p>  </p>
<p>(5.6.1)</p>
<p><b> </b></p>
<p>or  by  activating  the  feature  ‘State  Change  Ind  Enabled’.  Both  of  these  features  are </p>
<p>implemented according to [2]. </p>
<p>Note that the NM state may also be optionally reported into Com signals using the ‘State </p>
<p>Report Enabled’ feature (refer to chapter 3.12 for details). </p>
<p><b>3.7.1 </b></p>
<p><b>Determining the NM State Using Nm_GetState </b></p>
<p>If  Nm_GetState  (see also  chapter  5.6.1) has  been  called,  the  current  NM  state  and  the </p>
<p>current NM mode of the bus-specific Nm (e.g. CanNm, FrNm) associated with the system </p>
<p>channel  index </p>
<p>nmChannelHandle</p>
<p>  are  written  to  the  passed  pointer  variables.  Possible </p>
<p>state and mode values that are returned into these variables can be seen in the definition </p>
<p>of </p>
<p>Nm_StateType</p>
<p> / </p>
<p>Nm_ModeType</p>
<p> in NmStack_Types.h. </p>
<p><b>3.7.2 </b></p>
<p><b>Using the ‘State Change Ind Enabled’ feature </b></p>
<p>The ‘State Change Ind Enabled’ feature enables a callback that is called each time the NM </p>
<p>state  has  been  changed.  To  use  this  feature,  activate  the  ‘State  Change  Ind  Enabled’ </p>
<p>setting  in  the  module  settings  of  Nm  in  GENy  (see  also  chapter  6.3.1  ‘Component </p>
<p>Configuration’). Furthermore, enter the name of the function that shall be called in case of </p>
<p>a  NM  state  change  into  the  ‘State  Change  Indication  Callback’ field  and  provide the file </p>
<p>name  of  the  header  file  that  contains  the  function  prototype  of  this  function  in  the  ‘Nm </p>
<p>Callbacks Prototype Header’ setting. </p>
<p>Note that the function prototype of the function given in ‘State Change Indication Callback’ </p>
<p>has  to  be  the  same  as  (except  the  function  name) </p>
<p>Nm_StateChangeNotification</p>
<p> </p>
<p>(refer to chapter 5.8.9 for details). </p>
<p><b>3.8 </b></p>
<p><b>OSEK NM Support </b></p>
<p>The optional feature ‘OSEK NM Support’ allows controlling channels where OSEK NM is </p>
<p>running.  If  this  feature  is  enabled  each  channel  can  be  configured  as  an  OSEK  NM </p>
<p>channel. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>If GENy is used for the configuration the mapping for each channel to the correct NM is </p>
<p>done automatically by recognizing which NM is running on which channel. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>28 / 104 </p>
<p><b>3.8.1 </b></p>
<p><b>API Mapping </b></p>
<p>For OSEK NM channels the AUTOSAR NM Interface API is mapped to the corresponding </p>
<p>OSEK NM API. Return values are evaluated and transformed to ‘NM Interface’-compatible </p>
<p>values.  </p>
<p>The table below shows the mapping of the function and the corresponding return values </p>
<p>(not listed NM Interface functions are not mapped): </p>
<p>NM Interface </p>
<p>OSEK NM </p>
<p>Return value </p>
<p>Nm_Init() </p>
<p>NmOsekInit( NM_SLEEPIND ) </p>
<p>NM_E_OK </p>
<p>Nm_PassiveStartUp() </p>
<p>NmOsekInit( NM_SLEEPIND ) </p>
<p>NM_E_OK </p>
<p>Nm_NetworkRequest() </p>
<p>GotoMode( Awake ) </p>
<p>NM_E_OK </p>
<p>Nm_NetworkRelease() </p>
<p>GotoMode( BusSleep ) </p>
<p>NM_E_OK </p>
<p>Nm_GetState() </p>
<p>NmGetState()</p>
<p>4</p>
<p> </p>
<p>NM_E_OK </p>
<p>Nm_CheckRemoteSleepIndication() </p>
<p>NmGetRemoteSleepInd() </p>
<p>NM_E_OK </p>
<p>Nm_DisableCommunication() </p>
<p>SilentNM() </p>
<p>NM_E_OK </p>
<p>Nm_EnableCommunication() </p>
<p>TalkNM() </p>
<p>NM_E_OK </p>
<p>Table 3-3  </p>
<p>API Mapping for OSEK NM Channels </p>
<p><b>3.8.2 </b></p>
<p><b>Callback Mapping </b></p>
<p>Control callbacks from the OSEK NM are implemented by NM Interface. Some of them are </p>
<p>mapped to the corresponding callbacks within the NM Interface. This mapping is shown in </p>
<p>the following table (rows that contain ‘---‘ could not be directly mapped): </p>
<p>OSEK NM </p>
<p>NM Interface </p>
<p>ApplNmCanNormal </p>
<p>ApplNmWaitBusSleepCancel </p>
<p>Nm_NetworkMode </p>
<p>ApplNmWaitBusSleep </p>
<p>Nm_PrepareBusSleepMode </p>
<p>ApplNmCanSleep </p>
<p>Nm_BusSleepMode </p>
<p>ApplNmBusStart </p>
<p>--- </p>
<p>ApplNmCanBusSleep </p>
<p>--- </p>
<p>ApplNmBusOff </p>
<p>--- </p>
<p>ApplNmBusOffEnd </p>
<p>--- </p>
<p>Table 3-4  </p>
<p>Callback Mapping for OSEK NM Channels </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>OSEK NM also offers data callbacks that are not implemented within the NM Interface. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p>                                            </p>
<p>4</p>
<p> OSEK NM state information is converted to AUTOSAR NM state information. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>29 / 104 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>OSEK NM has a different behavior when it receives a NM message in sleep state. </p>
<p>While AUTOSAR NM notifies </p>
<p>Nm_NetworkStartIndication()</p>
<p> OSEK NM performs </p>
<p>a start-up and will call </p>
<p>ApplNmCanNormal()</p>
<p>. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>3.8.3 </b></p>
<p><b>Limitations </b></p>
<p>The following NM features cannot be used when at least one channel with OSEK NM is </p>
<p>used: </p>
<p><b>&gt; </b> Macro Layer Optimization (refer also to chapter 3.3) </p>
<p><b>&gt; </b> Passive Mode Enabled </p>
<p>The following NM features can additionally  not be used when only channels with OSEK </p>
<p>NM are used: </p>
<p><b>&gt; </b> Node Detection Enabled </p>
<p><b>&gt; </b> Node Id Enabled </p>
<p><b>&gt; </b> Pdu Rx Indication </p>
<p><b>&gt; </b> User Data Enabled </p>
<p><b>&gt; </b> State Report Enabled </p>
<p><b>&gt; </b> Car Wake Up Rx Enabled </p>
<p><b>3.8.4 </b></p>
<p><b>NM Coordination </b></p>
<p>It is only possible to synchronize the NM Coordination with one OSEK NM channel due to </p>
<p>the shutdown timing of an OSEK NM channel depends on the availability of the NM token </p>
<p>and normally this token will not be available for all channels at one node at the same time. </p>
<p>For the coordination it is necessary to know to which OSEK NM channel the other network </p>
<p>management shall be synchronized. This is set in the configuration (refer to chapter 6.3.1 </p>
<p>‘Component Configuration’). </p>
<p><b>3.8.5 </b></p>
<p><b>State Change Notifications </b></p>
<p>This  optional  feature  enables  state  change  notification  calls  to  the  higher  layer  when </p>
<p>OSEK NM changes its state. The NM Interface calls the function name that is configured </p>
<p>with the following additional arguments: </p>
<p>nmChannelHandle</p>
<p>: </p>
<p>System Channel Handle </p>
<p>nmPreviousState</p>
<p> and </p>
<p>nmCurrentState</p>
<p>: see Table 3-4 </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>30 / 104 </p>
<p><b>nmCurrentState </b></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p><b>nmPreviousState </b></p>
<p>NM_STATE_BUS_SLEEP </p>
<p>NM_STATE_PREPARE_BUS_SLEEP </p>
<p>NM_STATE_READY_SLEEP </p>
<p>NM_STATE_NORMAL_OPERATION </p>
<p>NM_STATE_BUS_OFF </p>
<p>NM_STATE_BUS_SLEEP </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>NM_STATE_PREPARE_BUS_SLEEP </p>
<p></p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>NM_STATE_READY_SLEEP </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p></p>
<p> </p>
<p>NM_STATE_NORMAL_OPERATION </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p>NM_STATE_BUS_OFF </p>
<p> </p>
<p> </p>
<p></p>
<p> </p>
<p></p>
<p> </p>
<p> </p>
<p>Table 3-5  </p>
<p>OSEK NM State Change Notification Arguments: nmPreviousState and nmCurrentState </p>
<p>Note that BusOff may also occur on the CAN Bus in </p>
<p>NM_STATE_PREPARE_BUS_SLEEP</p>
<p> </p>
<p>but this is explicitly not modeled into the state ‘</p>
<p>NM_STATE_BUS_OFF</p>
<p>’. </p>
<p>From the NM perspective, the TX path of the channel can be enabled if the current state is </p>
<p>NM_STATE_NORMAL_OPERATION</p>
<p> or </p>
<p>NM_STATE_READY_SLEEP</p>
<p>. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>CANbedded CCL is incompatible with this feature. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p>For </p>
<p>further </p>
<p>information </p>
<p>about </p>
<p>the </p>
<p>configuration </p>
<p>refer </p>
<p>to </p>
<p>chapter </p>
<p>6.3.1 </p>
<p>‘Component </p>
<p>Configuration’. </p>
<p><b>3.8.6 </b></p>
<p><b>Extended Initialization </b></p>
<p>OSEK NM is initialized by the NM Interface. This optional feature allows configuring the </p>
<p>state which OSEK NM shall enter during initialization. Note that the initialization state is </p>
<p>only valid for channels where only OSEK NM is active. </p>
<p>The following initialization states are possible: </p>
<p><b>Initialization State </b></p>
<p><b>Description </b></p>
<p>NM_CANSLEEP </p>
<p>OSEK NM initializes in ‘Bus Sleep’, the communication shall be </p>
<p>disabled. This is the default value. </p>
<p>NM_NORMAL </p>
<p>OSEK NM is started during initialization and a communication request is </p>
<p>set.  </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>31 / 104 </p>
<p><b>Initialization State </b></p>
<p><b>Description </b></p>
<p>NM_SLEEPIND </p>
<p>OSEK NM is started during initialization but no communication request </p>
<p>is set. </p>
<p>Table 3-6  </p>
<p>OSEK NM Extended Initialization States </p>
<p>For more information about the OSEK NM initialization states refer also to the Technical </p>
<p>Reference of the OSEK NM. Further information about the configuration can be found in </p>
<p>chapter 6.3.1 ‘Component Configuration’. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>This feature can only be used when an initialization mode other than ‘Sleep’ is allowed </p>
<p>by the stack.  </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>3.9 </b></p>
<p><b>ComM 2.1 Support </b></p>
<p>To allow the integration of an AUTOSAR 2.1 Communication Manager in combination with </p>
<p>AUTOSAR  3  Network  Management  this  feature  has  been  added.  It  adapts  the  API </p>
<p>Interface to work with ComM 2.1. </p>
<p>Please note that the optional NM callbacks have to be configured depending on the needs </p>
<p>of the ComM 2.1. For the configuration of this feature and the callbacks refer to chapter </p>
<p>6.3.1 ‘Component Configuration’.  </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>This feature does not allow the integration with further AUTOSAR 2.1 components </p>
<p>affecting the NM. Especially the CAN Interface and the EcuM (for the initialization </p>
<p>mechanism) are expected to be implemented according to AUTOSAR 3. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>3.10 </b></p>
<p><b>Gateway Extension </b></p>
<p>The </p>
<p>gateway </p>
<p>extension </p>
<p>functionality </p>
<p>provides </p>
<p>two </p>
<p>optional </p>
<p>features, </p>
<p>the </p>
<p>Diagnostic </p>
<p>Gateway Extension and the Network Management Gateway Extension. </p>
<p>The Diagnostic Gateway Extension feature supports the application by reading and writing </p>
<p>one special byte in the NM user data. </p>
<p>The NM Gateway Extension feature provides an extended network coordination handling </p>
<p>where networks can be shut down if no node in any network requests it. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>32 / 104 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>The gateway extension can be used only for systems with a maximum of 8 NM </p>
<p>channels. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>3.10.1 </b></p>
<p><b>Diagnostic Gateway Extension </b></p>
<p>The Diagnostic Gateway Extension informs the application about each received NM </p>
<p>message with the following additional callback:  </p>
<p>void </p>
<p><b>ComM_Nm_DiagGwReqIdIndication</b></p>
<p> ( </p>
<p><b> </b></p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p>uint8 nmNodeId, uint8 nmReqId ) </p>
<p>(5.9.3.2) </p>
<p>Beside  the  channel  the  parameters  this  callback  contains  the  ‘node  identifier’  and  the </p>
<p>‘requested node identifier’. The ‘requested node identifier’ is located in byte  4 of the NM </p>
<p>message. </p>
<p>The application can set the ‘requested node identifier’ by calling the following function:  </p>
<p>Nm_ReturnType </p>
<p><b>Nm_SetDiagGwReqId</b></p>
<p> ( uint8 nmReqId ) </p>
<p>(5.6.9.7) </p>
<p>This  function </p>
<p>causes </p>
<p>additionally </p>
<p>the </p>
<p>transmission </p>
<p>of  the  own </p>
<p>NM </p>
<p>message </p>
<p>on </p>
<p>all </p>
<p>channels. The transmission request is executed within the next CAN NM main function. </p>
<p>For </p>
<p>the </p>
<p>configuration </p>
<p>of </p>
<p>the </p>
<p>Diagnostic </p>
<p>Gateway </p>
<p>Extension </p>
<p>refer </p>
<p>to </p>
<p>chapter </p>
<p>6.3.1 </p>
<p>‘Component Configuration’. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>Note that diagnostic gateway functionality is only provided for channels where CAN NM </p>
<p>is used. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>3.10.2 </b></p>
<p><b>NM Gateway Extension </b></p>
<p>The </p>
<p>Network </p>
<p>Management </p>
<p>Gateway </p>
<p>Extension </p>
<p>provides </p>
<p>an </p>
<p>extended </p>
<p>coordination </p>
<p>handling: </p>
<p>Any network is kept awake if a communication request for that network is active or a node </p>
<p>in another network needs the network to be active.  </p>
<p>On  a  wakeup  event  further  channels  can  be  requested  by  the  NM  Gateway  Extension </p>
<p>algorithm. </p>
<p>For  the  configuration  of  the  NM  Gateway  Extension  refer  to  chapter  6.3.1  ‘Component </p>
<p>Configuration’. </p>
<p><b>3.10.2.1 </b></p>
<p><b>Shutdown Criteria </b></p>
<p>A network can shut down if all of the following criteria are fulfilled: </p>
<p>1. </p>
<p>Application has not requested communication for the network </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>33 / 104 </p>
<p>2. </p>
<p>No node in the network requests communication (detected via remote sleep </p>
<p>mechanism) </p>
<p>3. </p>
<p>No node in another network requests the network by setting corresponding information </p>
<p>in byte 5 of the NM message </p>
<p>4. </p>
<p>No node in another network is active and needs information, i.e. receives signals, from </p>
<p>some nodes in the network (information is provided by the generation tool by </p>
<p>evaluating routing relations of signals) </p>
<p>If any of the criteria is not fulfilled the network is kept awake. </p>
<p>Criterion 4 can be additionally influenced by a Remote Sleep Filter mask for each network. </p>
<p>Other networks that are marked as inactive within this mask cannot be kept awake by the </p>
<p>routing relations of active nodes in this network.  </p>
<p>This mask is initially configured to keep all networks with routing relations awake. </p>
<p>The application can change the channel-specific Remote Sleep Filter mask by calling the </p>
<p>following function: </p>
<p>void </p>
<p><b>Nm_SetGwRemoteSleepFilter</b></p>
<p> ( </p>
<p><b> </b></p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p>uint8 nmFilterMask ) </p>
<p>(5.6.9.4) </p>
<p><b>3.10.2.2 </b></p>
<p><b>Wakeup Handling </b></p>
<p>On any network activity on a sleeping network starts other networks when they are defined </p>
<p>as active in a Remote Wakeup Filter mask for that network. </p>
<p>Default value of the remote wakeup filter is that all channels are started. </p>
<p>The application can change the remote wakeup filter by calling the following function: </p>
<p>void </p>
<p><b>Nm_SetGwRemoteWakeupFilter</b></p>
<p> ( </p>
<p><b> </b></p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p>uint8 nmFilterMask ) </p>
<p>(5.6.9.5) </p>
<p>The NM Interface cannot detect an external wakeup event. Therefore the application has </p>
<p>to inform the NM of any external wakeup event with the function: </p>
<p>void </p>
<p><b>Nm_WakeupNotification</b></p>
<p> ( </p>
<p><b> </b></p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p>(5.6.9.6) </p>
<p>Note  that  the  gateway  algorithm  ignores  this  notification  for  channels  that  are  already </p>
<p>requested by the NM Interface. </p>
<p><b>3.10.2.3 </b></p>
<p><b>Coordination of Multiple NMs within One Channel </b></p>
<p>The Gateway Extension supports an AUTOSAR CAN NM and an OSEK NM running both </p>
<p>on the same network. Both NMs are synchronized for shutdown as far as possible. </p>
<p>Externally this channel behaves like an AUTOSAR CAN NM channel, i.e. any API access </p>
<p>or callback notification is related to the CAN NM. The OSEK NM is handled only internally. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>34 / 104 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Info </b></p>
<p>The gateway extension handling of multiple NMs within one channel does not influence </p>
<p>the shutdown criteria for other networks. The coordination feature (refer to chapter 3.5 </p>
<p>‘Coordinator Extension’) cannot be used and must be disabled. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>3.11 </b></p>
<p><b>Car Wakeup </b></p>
<p>If  ‘Car  Wakeup’  feature  is  enabled  in  the  configuration  the  NM  Interface  provides  a </p>
<p>configurable callback to the application. This callback informs the application when a ‘Car </p>
<p>Wakeup’  request  has  been  detected  by  CAN  NM  or  FlexRay  NM.  Refer  also  to  the </p>
<p>Technical References of CAN NM and FlexRay NM. </p>
<p>For the configuration of the feature refer to chapter 6.3.1 ‘Component Configuration’. </p>
<p><b>3.12 </b></p>
<p><b>Set Nm State in User Data </b></p>
<p>The  feature  ‘Set  Nm  State  in  User  Data’  writes  state  change  notifications  as  bit-coded </p>
<p>values  in  a  configured  Com  signal. The following  table  provides  all state  changes  (from </p>
<p>previous state to current state) and the corresponding signal values that are set by the NM </p>
<p>Interface. </p>
<p><b>Previous State </b></p>
<p><b>Current State </b></p>
<p><b>Signal Value </b></p>
<p>Bus Sleep Mode</p>
<p>5</p>
<p> </p>
<p>Repeat Message </p>
<p>1 </p>
<p>Prepare Bus Sleep Mode</p>
<p>6</p>
<p> </p>
<p>Repeat Message </p>
<p>2 </p>
<p>Repeat Message </p>
<p>Normal Operation </p>
<p>4 </p>
<p>Ready Sleep </p>
<p>Normal Operation </p>
<p>8 </p>
<p>Ready Sleep </p>
<p>Repeat Message </p>
<p>16 </p>
<p>Normal Operation </p>
<p>Repeat Message </p>
<p>32 </p>
<p>Table 3-7  </p>
<p>Nm State Change Signal Values </p>
<p>This feature is optional and has to be enabled in the configuration. For the configuration of </p>
<p>the feature refer to chapter 6.3.2 ‘Channel Configuration’. </p>
<p>Note that this feature should only be used for AUTOSAR NMs (e.g. CAN NM and FlexRay </p>
<p>NM). </p>
<p><b>3.13 </b></p>
<p><b>Multiple ECU Support </b></p>
<p>The </p>
<p>NM </p>
<p>Interface </p>
<p>can </p>
<p>be </p>
<p>used </p>
<p>in </p>
<p>multiple </p>
<p>configuration </p>
<p>environments </p>
<p>when </p>
<p>the </p>
<p>configuration  in  GENy  is  done  with  an  AUTOSAR  ECU  configuration  file.  No  special </p>
<p>support is provided as NM Interface functionality does not have any parameter relevant for </p>
<p>a multiple ECU project. </p>
<p>                                            </p>
<p>5</p>
<p> As FlexRay NM does not perform a transition directly from Bus Sleep Mode to Repeat Message State the </p>
<p>value is set in the transition from Synchronize Mode to Repeat Message State. </p>
<p>6</p>
<p> This transition is not available for FlexRay NM. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>35 / 104 </p>
<p>In  contradiction  to  the  feature  ‘Multiple  Configuration  Support’  only  one  configuration  is </p>
<p>available which has to be used for all identities. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>As only one configuration is available it is possible to pass the null pointer to the </p>
<p>initialization function. NM Interface will automatically initialize with this available </p>
<p>configuration. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>3.14 </b></p>
<p><b>Multiple Configuration Support </b></p>
<p>The NM Interface supports Multiple Configuration setups when the configuration in GENy </p>
<p>is done with an AUTOSAR ECU configuration file. </p>
<p>If  this  feature  is  used  by  applying  an  appropriate  ECU  configuration  file  in  GENy,  the </p>
<p>generated  code  will  contain  multiple  configuration  structures.  When  initializing  the  NM </p>
<p>Interface the active configuration must be chosen by passing the corresponding pointer to </p>
<p>this configuration within the initialization function: </p>
<p>void <b>Nm_Init </b>( </p>
<p> </p>
<p> </p>
<p>const Nm_ConfigType * nmConfigPtr ) </p>
<p>(5.5.1) </p>
<p>The  configuration  type  (Nm_ConfigType) passed to  the  initialization function  contains all </p>
<p>relevant parameters for the multiple configuration support. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>The NM Interface provides defines for the different initialization configurations like other </p>
<p>modules do. Please take a look at the Nm_Cfg.h header file. Choose the relevant </p>
<p>configuration define and use this for configuring the EcuM. Refer to [13] for further </p>
<p>information. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Multiple Configuration Support is only relevant when the feature ‘Coordinator Support </p>
<p>Enabled’ is used. Otherwise it is currently not relevant which configuration is passed to </p>
<p>the initialization function. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Although this feature uses the post-build initialization mechanism the NM Interface is </p>
<p>still not post-build able. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>36 / 104 </p>
<p> </p>
<p><b>3.15 </b></p>
<p><b>Fiat Class B NM and Fiat Class C NM Support </b></p>
<p>The  NM  Interface  supports  channels  with  a  Fiat  Class  B  NM  or  Fiat  Class  C  NM  if  the </p>
<p>configuration in GENy is done with an AUTOSAR ECU configuration file. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>This feature can only be used with the MICROSAR Fiat Class B NM and/or the </p>
<p>MICROSAR Fiat Class C NM which supports an AUTOSAR like API (similar to CAN </p>
<p>NM) and the AUTOSAR architecture. Refer to [11] and/or [12] for details of the </p>
<p>MICROSAR Fiat Class B NM / MICROSAR Fiat Class C NM. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>3.15.1 </b></p>
<p><b>API Mapping </b></p>
<p>API calls for channels with this NM type are forwarded to the Fiat Class B NM / Fiat Class </p>
<p>C NM similar as for CAN NM and FlexRay NM. Therefore the NM Interface expects that </p>
<p>the Fiat Class B NM / Fiat Class C NM implements the corresponding service functions. A </p>
<p>complete list, which functions are expected can be found in chapter 5.7 ‘Service Functions </p>
<p>Used by NM Interface’. </p>
<p><b>3.15.2 </b></p>
<p><b>Callback Mapping </b></p>
<p>The Fiat Class B NM / Fiat Class C NM component must also provide at least the following </p>
<p>mandatory callbacks to the NM Interface: </p>
<p><b>&gt; </b> Nm_NetworkStartIndication (refer also to chapter 5.8.1) </p>
<p><b>&gt; </b> Nm_NetworkMode (see also chapter 5.8.2) </p>
<p><b>&gt; </b> Nm_PrepareBusSleepMode (refer also to chapter 5.8.3) </p>
<p><b>&gt; </b> Nm_BusSleepMode (see also chapter 5.8.4) </p>
<p>All other callback functions are optional and must be only provided if the corresponding </p>
<p>feature is fully supported by the Fiat Class B NM / Fiat Class C NM (refer to [11] and/or </p>
<p>[12] for details). </p>
<p><b>3.15.3 </b></p>
<p><b>Limitations </b></p>
<p>The following features cannot be used when at least one channel with Fiat Class B NM / </p>
<p>Fiat Class C NM is used: </p>
<p><b>&gt; </b> Gateway Extension (see chapter 3.10) </p>
<p><b>&gt; </b> Passive Mode Enabled </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>37 / 104 </p>
<p><b>3.16 </b></p>
<p><b>Error Handling </b></p>
<p><b>3.16.1 </b></p>
<p><b>Development Error Detection </b></p>
<p>Development errors are reported to the DET using the service </p>
<p>Det_ReportError()</p>
<p> as </p>
<p>specified  in  [7],  if  development  error  reporting  is  enabled  (i.e.  pre-compile  parameter </p>
<p>NM_DEV_ERROR_DETECT==STD_ON</p>
<p>). </p>
<p>If  another  module  is  used  for  development  error  reporting,  the  function  prototype  for </p>
<p>reporting the error can be configured by the integrator, but must have the same signature </p>
<p>as the service </p>
<p>Det_ReportError()</p>
<p>. </p>
<p>The reported Nm ID is 29. </p>
<p>The reported service IDs identify the services which are described in chapter 5.5, chapter </p>
<p>5.6, and chapter 5.8. The following table presents the service IDs and the related services: </p>
<p><b>Service ID </b></p>
<p><b>Service </b></p>
<p>0x00 </p>
<p>Nm_Init </p>
<p>0x01 </p>
<p>Nm_PassiveStartUp </p>
<p>0x02 </p>
<p>Nm_NetworkRequest </p>
<p>0x03 </p>
<p>Nm_NetworkRelease </p>
<p>0x04 </p>
<p>Nm_DisableCommunication </p>
<p>0x05 </p>
<p>Nm_EnableCommunication </p>
<p>0x06 </p>
<p>Nm_SetUserData </p>
<p>0x07 </p>
<p>Nm_GetUserData </p>
<p>0x08 </p>
<p>Nm_GetPduData </p>
<p>0x09 </p>
<p>Nm_RepeatMessageRequest </p>
<p>0x0A </p>
<p>Nm_GetNodeIdentifier </p>
<p>0x0B </p>
<p>Nm_GetLocalNodeIdentifier </p>
<p>0x0D </p>
<p>Nm_CheckRemoteSleepIndication </p>
<p>0x0E </p>
<p>Nm_GetState </p>
<p>0x0F </p>
<p>Nm_GetVersionInfo </p>
<p>0x10 </p>
<p>Nm_MainFunction </p>
<p>0x11 </p>
<p>Nm_NetworkStartIndication </p>
<p>0x12 </p>
<p>Nm_NetworkMode </p>
<p>0x13 </p>
<p>Nm_PrepareBusSleepMode </p>
<p>0x14 </p>
<p>Nm_BusSleepMode </p>
<p>0x15 </p>
<p>Nm_PduRxIndication </p>
<p>0x16 </p>
<p>Nm_StateChangeNotification </p>
<p>0x1C </p>
<p>Nm_ActiveCoordIndication </p>
<p>0x1D </p>
<p>Nm_CarWakeUpIndication </p>
<p>0x24 </p>
<p>Nm_RemoteSleepIndication </p>
<p>0x25 </p>
<p>Nm_RemoteSleepCancellation </p>
<p>0x28 </p>
<p>Nm_RepeatMessageIndication </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>38 / 104 </p>
<p><b>Service ID </b></p>
<p><b>Service </b></p>
<p>0x29 </p>
<p>Nm_TxTimeoutException </p>
<p>0x30 </p>
<p>Nm_LimpHomeIndication </p>
<p>0x31 </p>
<p>Nm_LimpHomeCancelation </p>
<p>0x33 </p>
<p>Nm_GwPduRxIndication </p>
<p>0xC0 </p>
<p>Nm_RequestBusSynchronization </p>
<p>0xD0 </p>
<p>Nm_CheckLimpHomeIndication </p>
<p>0xD1 </p>
<p>Nm_SetGwRemoteSleepFilter </p>
<p>0xD2 </p>
<p>Nm_SetGwRemoteWakeupFilter </p>
<p>0xD3 </p>
<p>Nm_WakeupNotification </p>
<p>0xD4 </p>
<p>Nm_SetDiagGwReqId </p>
<p>Table 3-8  </p>
<p>Service IDs </p>
<p>The errors reported to DET are described in the following table: </p>
<p><b>Error Code </b></p>
<p><b>Description </b></p>
<p>0x01 NM_E_NO_INIT </p>
<p>API service used without module initialization. </p>
<p>0x02 NM_E_INVALID_CHANNEL </p>
<p>API service used with wrong channel handle. </p>
<p>0x13 NM_E_NULL_PTR </p>
<p>Null Pointer has been passed as argument. </p>
<p>0x20 NM_E_PRIORITY_COLLISI</p>
<p>ON </p>
<p>Two Coordinators with the same priority are </p>
<p>connected to the same bus </p>
<p>0x21 NM_E_SLEEPBIT_ERROR </p>
<p>Sleep Indication Bit received on an active channel </p>
<p>Table 3-9  </p>
<p>DET Error Codes </p>
<p><b>3.16.2 </b></p>
<p><b>Production Code Error Reporting </b></p>
<p>By  default,  production  code  related  errors  are  reported  to  the  DEM  using  the  service </p>
<p>Dem_ReportErrorStatus()</p>
<p> as specified in [8], if production error reporting is enabled </p>
<p>(i.e. pre-compile parameter </p>
<p>NM_PROD_ERROR_DETECT==STD_ON</p>
<p>). </p>
<p>If another module  is used for production  code  error reporting,  the  function  prototype for </p>
<p>reporting the error can be configured by the integrator, but must have the same signature </p>
<p>as the service </p>
<p>Dem_ReportErrorStatus()</p>
<p>. </p>
<p>Currently the NM Interface does not report any production error. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>39 / 104 </p>
<p><b>4 </b></p>
<p><b>Integration </b></p>
<p><b>4.1 </b></p>
<p><b>Files </b></p>
<p>The NM Interface consists of the following files: </p>
<p><b>Files of NM Interface </b></p>
<p><b> </b></p>
<p>Nm.c </p>
<p>Source code of NM Interface. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>Nm.h </p>
<p>API of NM Interface. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>Nm_Cbk.h </p>
<p>API of NM Interface callback functions. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>Nm_Cfg.c </p>
<p>Pre-compile variant Configuration source file. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>Nm_Cfg.h </p>
<p>Configuration header file for NM Interface. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>Nm_Lcfg.c </p>
<p>Link-time variant Configuration source file. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>Nm_Lcfg.h </p>
<p>Link-time variant Configuration header file. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>NmStack_Types.h </p>
<p>Provided header file for global NM Types. </p>
<p>The user <b>must not </b>change this file! </p>
<p> </p>
<p>Table 4-1  </p>
<p>File Names of the NM Interface </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>If the NM is used with OSEK NM and a non-AUTOSAR CAN Driver the configuration </p>
<p>files </p>
<p>Nm_Cfg.h</p>
<p> and </p>
<p>Nm_Cfg.c</p>
<p> will be generated as </p>
<p>NmIf_Cfg.h</p>
<p> and </p>
<p>NmIf_Cfg.c</p>
<p> </p>
<p>to avoid a conflict with the generated OSEK NM configuration header file. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>40 / 104 </p>
<p><b>4.2 </b></p>
<p><b>Include Structure </b></p>
<p> </p>
<p>Figure 4-1 </p>
<p>Include Structure of Nm Interface </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>If the feature ‘OSEK NM Support’ is enabled, also the configuration header file of the </p>
<p>OSEK NM is included by the NM Interface. </p>
<p>If on at least one channel Fiat Class B and/or Fiat Class C is used, then also the </p>
<p>configuration header file of the Fiat Class B NM / Fiat Class C NM is included by the </p>
<p>NM Interface. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>4.3 </b></p>
<p><b>Version Changes </b></p>
<p>Changes and the release versions of the NM Interface are listed at the beginning of the </p>
<p>header and source code. </p>
<p><b>4.4 </b></p>
<p><b>Initialization </b></p>
<p>Before  the  NM  Interface  can  be  used  it  has  to  be  initialized  by  the  application.  The </p>
<p>initialization  has  to  be  carried  out  before  any  other  functionality  of  the  NM  Interface  is </p>
<p>executed.  It  shall  take  place  after  initialization  of  the  bus-specific  NMs  and  prior  to </p>
<p>initialization of the Communication Manager. </p>
<p>Also refer to chapter 5.5.1 ‘Nm_Init: Initialization of NM Interface‘. </p>
<p> </p>
<p><b>class IncludeStructure</b></p>
<p>Nm.c</p>
<p>Nm.h</p>
<p>Nm_Cfg.h</p>
<p>Nm_Cfg.c</p>
<p>Nm_Lcfg.c</p>
<p>Nm_Cbk.h</p>
<p>SchM_Nm.h</p>
<p>ComStack_Types.h</p>
<p>Std_Types.h</p>
<p>Com.h</p>
<p>MemMap.h</p>
<p>NmStack_Types.h</p>
<p>AmdRtm.h</p>
<p>CanNm.h</p>
<p>FrNm.h</p>
<p>NmFiatB.h</p>
<p>NmFiatC.h</p>
<p>NmOsek.h</p>
<p>ComM_Nm.h</p>
<p>BswM_Nm.h</p>
<p>Det.h</p>
<p>EcuM_Cbk.h</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<p>0..1</p>
<p>1</p>
<p>«include»</p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>41 / 104 </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>The NM Interface assumes that some variables are initialized with zero at start-up </p>
<p>when the feature ‘Coordinator Support Enabled’ is enabled. If the embedded target </p>
<p>does not initialize RAM within the start-up code the function ‘Nm_InitMemory’ has to be </p>
<p>called during start-up and before the initialization is performed. Refer also to chapter </p>
<p>3.1.2.7 ‘Memory Initialization’. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>In an AUTOSAR environment where the ECU Manager is used, the initialization is </p>
<p>performed within the ECU Manager. Refer to the Technical Reference of the ECU </p>
<p>Manager for further details. </p>
<p>When not using the feature ‘Multiple Configuration Support’ only one configuration </p>
<p>exists that has to be passed to the initialization function. Alternatively the null pointer </p>
<p>can be passed and the NM Interface will automatically initialize with this configuration. </p>
<p>When using the feature ‘Multiple Configuration Support’ multiple configurations exist </p>
<p>and depending on which identity shall be active the correct one has to be chosen. </p>
<p>Refer to chapter 3.14 ‘Multiple Configuration Support’ for further information about this </p>
<p>feature. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>4.5 </b></p>
<p><b>Main Function </b></p>
<p>The  NM  Interface  provides  a  main  function  when  the  NM  Coordinator  is  used  or  the </p>
<p>Gateway  Extension  is  enabled. This main function  has  to  be  called  cyclic  on  task  level. </p>
<p>Default  Timing  value  is  10  milliseconds.  The  call  cycle  time  value  has  to  be  set  in  the </p>
<p>component configuration (refer to chapter 6.3.1 ‘Component Configuration’). </p>
<p>For  Further  Information  refer also  to  chapter  5.5.2  ‘Nm_MainFunction:  Main  Function  of </p>
<p>the NM Interface’. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>If no BSW Scheduler is used for the critical sections (refer to chapter 4.6 ‘Critical </p>
<p>Sections’) the NM main function must not be interrupted by any other task. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>42 / 104 </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>If the BSW Scheduler is used, the main function calls are executed by the BSW </p>
<p>Scheduler. When the BSW Scheduler is available in GENy the main function timing is </p>
<p>automatically adapted when changing the value in the component configuration. Refer </p>
<p>to [7] for more details about the BSW Scheduler. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>4.6 </b></p>
<p><b>Critical Sections </b></p>
<p>The AUTOSAR standard provides with the BSW Scheduler (SchM) a BSW module, which </p>
<p>handles entering and leaving critical sections. </p>
<p>Critical sections are supported by the BSW Scheduler. </p>
<p>The NM Interface calls the following function when entering a critical section: </p>
<p>void <b>SchM_Enter_Nm </b>( uint8 ExclusiveArea ) </p>
<p>() </p>
<p>When the critical section is left the following function is called by the NM Interface: </p>
<p>void <b>SchM_Exit_Nm </b>( uint8 ExclusiveArea ) </p>
<p>() </p>
<p>The critical section (exclusive area) codes passed to these functions have to be defined </p>
<p>and mapped to corresponding interrupt locks by the BSW Scheduler. This can be done in </p>
<p>GENy at the BSW Scheduler configuration page. The corresponding sections are already </p>
<p>entered there and have to be adapted to the correct interrupt locking mechanism. Details </p>
<p>which  section  needs  what  kind  of  interrupt  lock  are  provided  in  chapter  4.6.1  ‘Critical </p>
<p>Section Codes’. </p>
<p>For more information about the BSW Scheduler please refer to [7]. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Note that critical sections are only relevant if the NM coordinator is used. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>4.6.1 </b></p>
<p><b>Critical Section Codes </b></p>
<p>Since  the  BSW  Scheduler  is  used  for  critical  sections  (see  also  chapter  4.6  ‘Critical </p>
<p>Sections’)  the  Nm provides  two  critical  section  codes  which  must lead  to  corresponding </p>
<p>interrupt locks, described in the following table: </p>
<p><b>Critical Section Define </b></p>
<p><b>Interrupt Lock </b></p>
<p>NM_EXCLUSIVE_AREA_0</p>
<p> </p>
<p> No interruption by any interrupt is allowed. Therefore this section </p>
<p>must always lock global interrupts. </p>
<p>NM_EXCLUSIVE_AREA_1 </p>
<p>This section must lock task interrupts so that no interruption by the </p>
<p>task of any bus-specific NM is possible. If the system architecture </p>
<p>ensures this already otherwise (e.g. in non-preemptive systems) </p>
<p>this section must not lead to any interrupt lock. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>43 / 104 </p>
<p>Table 4-2  </p>
<p>Critical Section Codes </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>Note that critical section codes are only relevant if the NM coordinator is used. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>44 / 104 </p>
<p><b>5 </b></p>
<p><b>API Description </b></p>
<p><b>5.1 </b></p>
<p><b>API Categories </b></p>
<p>The AUTOSAR Network Management supports a multi-channel indexed API.  </p>
<p>When only one bus-specific NM Type is used the API can be optimized in order to save </p>
<p>runtime (refer to chapter 3.3 ‘Macro Layer Optimization’). </p>
<p><b>5.2 </b></p>
<p><b>Data Types </b></p>
<p>The  software  module  NM  Interface  uses  the  standard  AUTOSAR  data  types  that  are </p>
<p>defined within </p>
<p>Std_Types.h</p>
<p> and the platform specific data types that are defined within </p>
<p>Platform_Types.h</p>
<p>. </p>
<p>NM Interface provides a header file for global NM Types, </p>
<p>NmStack_Types.h</p>
<p>. Following </p>
<p>types are specified in this file: </p>
<p><b>Name </b></p>
<p><b>Type </b></p>
<p><b>Description </b></p>
<p>Nm_ReturnType </p>
<p>uint8 </p>
<p>Return type for NM functions. </p>
<p>Nm_StateType </p>
<p>enum </p>
<p>State of the network management state </p>
<p>machine. </p>
<p>Nm_ModeType </p>
<p>enum </p>
<p>Mode of the network management state </p>
<p>machine. </p>
<p>Table 5-1  </p>
<p>Global NM Types </p>
<p>Furthermore the following software module specific data types are used: </p>
<p><b>Name </b></p>
<p><b>Type </b></p>
<p><b>Description </b></p>
<p>Nm_ConfigType</p>
<p>7</p>
<p> </p>
<p>struct </p>
<p>Structure for configuration parameters. </p>
<p>Nm_ChannelConfigType</p>
<p>7</p>
<p> </p>
<p>struct </p>
<p>Structure for the channel specific </p>
<p>configuration parameters. </p>
<p>Nm_BusNmType</p>
<p> </p>
<p>enum </p>
<p>Enumeration that provides information </p>
<p>about the bus-specific NM type of the </p>
<p>channel. </p>
<p>Nm_SyncNmType</p>
<p>8</p>
<p> </p>
<p>enum </p>
<p>Enumeration that provides information if </p>
<p>the channel is selective or synchronous </p>
<p>Table 5-2  </p>
<p>NM Interface Data Types </p>
<p>These data types are defined within the software components configuration header file. </p>
<p><b>5.3 </b></p>
<p><b>Global Variables </b></p>
<p>There are no global variables within NM Interface. </p>
<p>                                            </p>
<p>7</p>
<p> These types are used for configuration purposes only. </p>
<p>8</p>
<p> Only available if the NM Coordinator is enabled. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>45 / 104 </p>
<p><b>5.4 </b></p>
<p><b>Global Constants </b></p>
<p><b>5.4.1 </b></p>
<p><b>AUTOSAR Specification Version </b></p>
<p>The version of AUTOSAR specification on which the appropriate implementation is based </p>
<p>on is provided by three BCD coded constants: </p>
<p><b>Name </b></p>
<p><b>Type </b></p>
<p><b>Description </b></p>
<p>NM_AR_MAJOR_VERSION</p>
<p> </p>
<p>BCD </p>
<p>Contains the major specification version number. </p>
<p>NM_AR_MINOR_VERSION</p>
<p> </p>
<p>BCD </p>
<p>Contains the minor specification version number. </p>
<p>NM_AR_PATCH_VERSION </p>
<p>BCD </p>
<p>Contains the patch level specification version number. </p>
<p>Table 5-3  </p>
<p>Specification Version API Data </p>
<p><b>5.4.2 </b></p>
<p><b>Component Versions </b></p>
<p>The source code version of NM Interface is provided by three BCD coded constants: </p>
<p><b>Name </b></p>
<p><b>Type </b></p>
<p><b>Description </b></p>
<p>NM_SW_MAJOR_VERSION</p>
<p> </p>
<p>BCD </p>
<p>Contains the major component version number. </p>
<p>NM_SW_MINOR_VERSION</p>
<p> </p>
<p>BCD </p>
<p>Contains the minor component version number. </p>
<p>NM_SW_PATCH_VERSION </p>
<p>BCD </p>
<p>Contains the patch level component version number. </p>
<p>Table 5-4  </p>
<p>Component Version API Data </p>
<p><b>5.4.3 </b></p>
<p><b>Vendor and Module ID </b></p>
<p>NM Interface provides the vendor and module identifier according to HIS: </p>
<p><b>Name </b></p>
<p><b>Type </b></p>
<p><b>Description </b></p>
<p>NM_VENDOR_ID</p>
<p> </p>
<p>- </p>
<p>Vendor ID according to HIS. </p>
<p>NM_MODULE_ID</p>
<p> </p>
<p>- </p>
<p>Module ID according to HIS. </p>
<p>Table 5-5  </p>
<p>Vendor and Module ID </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>46 / 104 </p>
<p><b>5.5 </b></p>
<p><b>Administrative Functions Provided by NM Interface </b></p>
<p><b>5.5.1 </b></p>
<p><b>Nm_Init: Initialization of NM Interface </b></p>
<p><b>Nm_Init </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_Init </b>( const Nm_ConfigType * nmConfigPtr ) </p>
<p><b>Parameter </b></p>
<p>nmConfigPtr</p>
<p> </p>
<p>Configuration Pointer </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x00 </p>
<p><b>Functional Description </b></p>
<p>Initializes the NM Interface. </p>
<p> </p>
<p>This function calls additionally the initialization function of OSEK NM, if configured. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>The function </p>
<p>Nm_Init()</p>
<p> has to be called before any other NM functionality is used. </p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Not re-entrant </p>
<p></p>
<p> </p>
<p>This service is called by EcuM. </p>
<p></p>
<p> </p>
<p>The GENy code generator provides macro definitions for the nmConfigPtr parameter. Please </p>
<p>take a look at Nm_Cfg.h after code generation. The name of these macro definitions may </p>
<p>vary if you have a multiple ECU or a multiple configuration setup. Please refer to [13] for </p>
<p>details about the Initialization of Basic Software Modules. This applies only to AUTOSAR </p>
<p>ECU configurations. </p>
<p></p>
<p> </p>
<p>Note that this function prototype deviates from the AUTOSAR document [2]. The original </p>
<p>AUTOSAR requirement requires actually this prototype: </p>
<p>void <b>Nm_Init</b>(Nm_ConfigType* const nmConfigPtr)</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>47 / 104 </p>
<p><b>5.5.2 </b></p>
<p><b>Nm_MainFunction: Main Function of the NM Interface </b></p>
<p><b>Nm_MainFunction </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_MainFunction </b>( void ) </p>
<p><b>Parameter </b></p>
<p>nmConfigPtr</p>
<p> </p>
<p>Configuration Pointer </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x10 </p>
<p><b>Functional Description </b></p>
<p>Main function of the NM Interface.</p>
<p> </p>
<p>This function controls the NM Coordination. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>This function has to be called cyclically on task level. </p>
<p></p>
<p> </p>
<p>Call context: task level. </p>
<p></p>
<p> </p>
<p>Not re-entrant. </p>
<p></p>
<p> </p>
<p>If this service is called by the Basic Scheduler or the CCL it must not be called by the </p>
<p>application. </p>
<p></p>
<p> </p>
<p>This function is only available if </p>
<p>NM_COORDINATOR_SUPPORT_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>48 / 104 </p>
<p><b>5.6 </b></p>
<p><b>Service Functions Provided by NM Interface </b></p>
<p><b>5.6.1 </b></p>
<p><b>Nm_GetState: Get the State of the Network Management </b></p>
<p><b>Nm_GetState </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_GetState </b>( const NetworkHandleType  nmChannelHandle, </p>
<p> </p>
<p>Nm_StateType* const  </p>
<p>nmStatePtr, </p>
<p> </p>
<p>Nm_ModeType* const  </p>
<p>nmModePtr )</p>
<p><b> </b></p>
<p><b>Parameter </b></p>
<p>nmChannelHandle</p>
<p><b> </b></p>
<p>Identification of the physical channel </p>
<p>nmStatePtr </p>
<p>Pointer where state of the network management shall be copied to </p>
<p>nmModePtr </p>
<p>Pointer where network management mode shall be copied to </p>
<p><b>Return code </b></p>
<p>NM_E_OK</p>
<p><b> </b></p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Getting of NM state has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x0E </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>49 / 104 </p>
<p><b>Functional Description </b></p>
<p>Returns the current state and the current mode of the network management by calling the GetState function </p>
<p>for the respective bus-specific NM. </p>
<p>One of the following state values is written to the variable where nmStatePtr points to: </p>
<p>&gt; </p>
<p>NM_STATE_BUS_SLEEP</p>
<p>  </p>
<p>(Bus Sleep) </p>
<p>&gt; </p>
<p>NM_STATE_PREPARE_BUS_SLEEP</p>
<p>  </p>
<p>(Prepare Bus Sleep)</p>
<p>9</p>
<p> </p>
<p>&gt; </p>
<p>NM_STATE_READY_SLEEP</p>
<p>  </p>
<p>(Ready Sleep) </p>
<p>&gt; </p>
<p>NM_STATE_NORMAL_OPERATION</p>
<p>  </p>
<p>(Normal Operation) </p>
<p>&gt; </p>
<p>NM_STATE_REPEAT_MESSAGE</p>
<p>  </p>
<p>(Repeat Message)</p>
<p>10</p>
<p> </p>
<p>&gt; </p>
<p>NM_STATE_SYNCHRONIZE  </p>
<p>(Synchronized State)</p>
<p>11</p>
<p> </p>
<p>&gt; </p>
<p>NM_STATE_WAIT_CHECK_ACTIVATION </p>
<p>(Wait Check Activation)</p>
<p>12</p>
<p> </p>
<p>&gt; </p>
<p>NM_STATE_WAIT_NETWORK_STARTUP </p>
<p>(Wait Network Startup)</p>
<p>12</p>
<p> </p>
<p>&gt; </p>
<p>NM_STATE_BUS_OFF </p>
<p>(BusOff)</p>
<p>13</p>
<p> </p>
<p>One of the following mode values is written to the variable where nmModePtr points to: </p>
<p>&gt; </p>
<p>NM_MODE_BUS_SLEEP</p>
<p>  </p>
<p>(Bus Sleep Mode) </p>
<p>&gt; </p>
<p>NM_MODE_PREPARE_BUS_SLEEP</p>
<p>  </p>
<p>(Prepare Bus Sleep Mode) </p>
<p>&gt; </p>
<p>NM_MODE_NETWORK</p>
<p>  </p>
<p>(Network Mode) </p>
<p>For details about the states and modes refer to the documentation for the corresponding BusNm (e.g. [3], </p>
<p>[4], [11], [12]). </p>
<p>As a state value for channels with OSEK NM only, </p>
<p>&gt; </p>
<p>NM_STATE_BUS_SLEEP</p>
<p>  </p>
<p>is returned, if it is in NMBusSleep (</p>
<p>NM_ACTION_BUS_SLEEP</p>
<p>), </p>
<p>&gt; </p>
<p>NM_STATE_PREPARE_BUS_SLEEP</p>
<p>  </p>
<p>is returned, if it is in NMTwbsNormal or NMTwbsLimpHome </p>
<p> </p>
<p> </p>
<p>(</p>
<p>NM_ACTION_GO_BUSSLEEP</p>
<p>), </p>
<p>&gt; </p>
<p>NM_STATE_READY_SLEEP</p>
<p>  </p>
<p>is returned, if it is not in NMBusSleep, NMTwbsNormal or </p>
<p> </p>
<p> </p>
<p>NMTwbsLimpHome and </p>
<p>GotoMode(BusSleep)</p>
<p> has been </p>
<p> </p>
<p> </p>
<p>called and it has not got any BusOff indication by CanSM, </p>
<p>&gt; </p>
<p>NM_STATE_NORMAL_OPERATION</p>
<p>  </p>
<p>is returned, if it is not in NMBusSleep, NMTwbsNormal or </p>
<p> </p>
<p> </p>
<p>NMTwbsLimpHome and </p>
<p>GotoMode(Awake)</p>
<p> has been </p>
<p> </p>
<p> </p>
<p>called and it has not got any BusOff indication by CanSM,. </p>
<p>&gt; </p>
<p>NM_STATE_BUS_OFF </p>
<p>is returned, if it is not in NMBusSleep, NMTwbsNormal or </p>
<p> </p>
<p> </p>
<p>NMTwbsLimpHome and it has got a BusOff indication by </p>
<p> </p>
<p> </p>
<p>CanSM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p> </p>
<p>                                            </p>
<p>9</p>
<p> Not used by FrNm </p>
<p>10</p>
<p> Only used by CanNm and FrNm </p>
<p>11</p>
<p> Only used by FrNm </p>
<p>12</p>
<p> Only used by NmFiatB and NmFiatC </p>
<p>13</p>
<p> Only used by OSEK NM </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>50 / 104 </p>
<p><b>5.6.2 </b></p>
<p><b>Nm_GetVersionInfo: Version Information API </b></p>
<p><b>Nm_GetVersionInfo </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_GetVersionInfo </b>( Std_VersionInfoType* NmVerInfoPtr ) </p>
<p><b>Parameter </b></p>
<p>NmVerInfoPtr </p>
<p>Pointer where the Version Information shall be copied to </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x0F </p>
<p><b>Functional Description </b></p>
<p>This service returns the version information of this module. The version information includes the Module Id, </p>
<p>the Vendor Id and the vendor specific version numbers (BSW00407). </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_VERSION_INFO_API is STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>51 / 104 </p>
<p><b>5.6.3 </b></p>
<p><b>Nm_PassiveStartUp: Wake-up Network Management </b></p>
<p><b>Nm_PassiveStartUp </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_PassiveStartUp </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Start of Network Management has failed </p>
<p>NM_E_NOT_EXECUTED </p>
<p>Start of Network Management is currently not executed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x01 </p>
<p><b>Functional Description </b></p>
<p>Passive startup of the network management. This function calls the PassiveStartUp function for the </p>
<p>respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>The wake-up handling is done by ComM. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>52 / 104 </p>
<p><b>5.6.4 </b></p>
<p><b>Wake-up Registration </b></p>
<p><b>5.6.4.1 </b></p>
<p><b>Nm_NetworkRequest: Request the Network </b></p>
<p><b>Nm_NetworkRequest </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_NetworkRequest </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Requesting the network has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x02 </p>
<p><b>Functional Description </b></p>
<p>Request the network if the ECU needs to communicate on the bus by calling the NetworkRequest function </p>
<p>for the respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service is called by ComM. </p>
<p></p>
<p> </p>
<p>Not available for passive nodes (</p>
<p>NM_PASSIVE_MODE_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p>) </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>53 / 104 </p>
<p><b>5.6.4.2 </b></p>
<p><b>Nm_NetworkRelease: Release the Network </b></p>
<p><b>Nm_NetworkRelease </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_NetworkRelease  </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Releasing the network has failed </p>
<p>NM_E_NOT_EXECUTED </p>
<p>Network Release is currently not executed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x03 </p>
<p><b>Functional Description </b></p>
<p>Release the network if the ECU doesn’t have to communicate on the bus by calling the NetworkRelease </p>
<p>function for the respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service is called by ComM. </p>
<p></p>
<p> </p>
<p>Not available for passive nodes (</p>
<p>NM_PASSIVE_MODE_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p>) </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>54 / 104 </p>
<p><b>5.6.5 </b></p>
<p><b>Communication Control Service </b></p>
<p><b>5.6.5.1 </b></p>
<p><b>Nm_DisableCommunication: Disable NM Message Transmission </b></p>
<p><b>Nm_DisableCommunication </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_DisableCommunication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Disabling NM message transmission has failed </p>
<p>NM_E_NOT_EXECUTED </p>
<p>Disabling NM message transmission is currently not executed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x04 </p>
<p><b>Functional Description </b></p>
<p>Disable transmission of NM messages by calling the corresponding bus-specific function. Note that FlexRay </p>
<p>NM does not support this feature and therefore this function returns for FlexRay NM channels </p>
<p>NM_E_NOT_EXECUTED. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Only re-entrant with different channel handles </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_COM_CONTROL_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>55 / 104 </p>
<p><b>5.6.5.2 </b></p>
<p><b>Nm_EnableCommunication: Enable NM Message Transmission </b></p>
<p><b>Nm_EnableCommunication </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_EnableCommunication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Enabling NM message transmission has failed </p>
<p>NM_E_NOT_EXECUTED </p>
<p>Enabling NM message transmission is currently not executed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x05 </p>
<p><b>Functional Description </b></p>
<p>Enable transmission of NM messages by calling the corresponding bus-specific function. Note that for </p>
<p>FlexRay NM this feature is not available and therefore this function just returns NM_E_NOT_OK. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Only re-entrant with different channel handles </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_COM_CONTROL_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>56 / 104 </p>
<p><b>5.6.6 </b></p>
<p><b>User Data Handling </b></p>
<p><b>5.6.6.1 </b></p>
<p><b>Nm_SetUserData: Set User Data </b></p>
<p><b>Nm_SetUserData </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_SetUserData </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>const uint8 * const nmUserDataPtr ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmUserDataPtr </p>
<p>Pointer to the user data for the next transmitted NM message </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Setting of user data has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x06 </p>
<p><b>Functional Description </b></p>
<p>Set user data for NM messages transmitted next on the bus by calling the SetUserData function for the </p>
<p>respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Only re-entrant with different channel handles </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_USER_DATA_ENABLED is STD_ON </p>
<p></p>
<p> </p>
<p>Not available for passive nodes (</p>
<p>NM_PASSIVE_MODE_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p>) or if </p>
<p>NM_COM_USER_DATA_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>57 / 104 </p>
<p><b>5.6.6.2 </b></p>
<p><b>Nm_GetUserData: Get User Data </b></p>
<p><b>Nm_GetUserData </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_GetUserData </b>(  </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>uint8* const nmUserDataPtr ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmUserDataPtr </p>
<p>Pointer where user data out of the last received NM message shall be copied to </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Getting of user data has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x07 </p>
<p><b>Functional Description </b></p>
<p>Get user data of the last NM message received previously on the bus by calling the GetUserData function </p>
<p>for the respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_USER_DATA_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>58 / 104 </p>
<p><b>5.6.6.3 </b></p>
<p><b>Nm_GetPduData: Get NM Pdu Data </b></p>
<p><b>Nm_GetPduData </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_GetPduData </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>uint8* const nmPduData ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmPduData </p>
<p>Pointer where the NM Pdu Data shall be copied to </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Getting of NM Pdu Data has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x08 </p>
<p><b>Functional Description </b></p>
<p>Get the whole PDU data out of the last received NM message by calling the GetPduData function for the </p>
<p>respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_NODE_ID_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> or </p>
<p>NM_USER_DATA_ENABLED</p>
<p> </p>
<p>is </p>
<p>STD_ON</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>59 / 104 </p>
<p><b>5.6.7 </b></p>
<p><b>Node Detection </b></p>
<p><b>5.6.7.1 </b></p>
<p><b>Nm_RepeatMessageRequest: Set Repeat Message Request Bit </b></p>
<p><b>Nm_RepeatMessageRequest </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_RepeatMessageRequest </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Requesting of node detection has failed </p>
<p>NM_E_NOT_EXECUTED </p>
<p>Requesting of node detection is currently not executed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x09 </p>
<p><b>Functional Description </b></p>
<p>Set Repeat Message Request Bit for NM messages transmitted next on the bus by calling the </p>
<p>RepeatMessageRequest function for the respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Only re-entrant with different channel handles </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_NODE_DETECTION_ENABLED</p>
<p> is</p>
<p> STD_ON</p>
<p> and if </p>
<p>NM_PASSIVE_MODE_ENABLED</p>
<p> is </p>
<p>STD_OFF</p>
<p>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>60 / 104 </p>
<p><b>5.6.7.2 </b></p>
<p><b>Nm_GetNodeIdentifier: Get Source Node Identifier </b></p>
<p><b>Nm_GetNodeIdentifier </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_GetNodeIdentifier </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>uint8* const nmNodeIdPtr ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmNodeIdPtr</p>
<p> </p>
<p>Pointer where node identifier from the last received NM message is copied to </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Getting of the node identifier from the last received NM message has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x0A </p>
<p><b>Functional Description </b></p>
<p>Get the node identifier from the last received NM message by calling the GetNodeIdentifier function for the </p>
<p>respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_NODE_ID_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>61 / 104 </p>
<p><b>5.6.7.3 </b></p>
<p><b>Nm_GetLocalNodeIdentifier: Get Local Source Node Identifier </b></p>
<p><b>Nm_GetLocalNodeIdentifier </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_GetLocalNodeIdentifier </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>uint8* const nmNodeIdPtr  ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmNodeIdPtr</p>
<p> </p>
<p>Pointer where node identifier of the local node is copied </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Getting of the node identifier of the local node has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x0B </p>
<p><b>Functional Description </b></p>
<p>Get the node identifier configured for the local node by calling the GetLocalNodeIdentifier function for the </p>
<p>respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_NODE_ID_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>62 / 104 </p>
<p><b>5.6.8 </b></p>
<p><b>Remote Sleep Indication </b></p>
<p><b>5.6.8.1 </b></p>
<p><b>Nm_CheckRemoteSleepIndication: Check for Remote Sleep Indication </b></p>
<p><b>Nm_CheckRemoteSleepIndication </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_CheckRemoteSleepIndication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>boolean* const nmRemoteSleepIndPtr ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmRemoteSleepIndPtr</p>
<p> </p>
<p>Pointer where check result of remote sleep indication shall be copied to </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Checking of remote sleep indication has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x0D </p>
<p><b>Functional Description </b></p>
<p>Check if remote sleep indication takes place or not by calling the CheckRemoteSleepIndication function for </p>
<p>the respective bus-specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task and interrupt level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_REMOTE_SLEEP_INDICATION_ENABLED</p>
<p> is</p>
<p> STD_ON</p>
<p> and if </p>
<p>NM_PASSIVE_MODE_ENABLED</p>
<p> is </p>
<p>STD_OFF</p>
<p>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>63 / 104 </p>
<p><b>5.6.9 </b></p>
<p><b>Vector Extensions </b></p>
<p><b>5.6.9.1 </b></p>
<p><b>Nm_InitMemory: Memory Initialization </b></p>
<p><b>Nm_InitMemory </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_InitMemory </b>( void ) </p>
<p><b>Parameter </b></p>
<p>- </p>
<p>- </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>- </p>
<p><b>Functional Description </b></p>
<p>If RAM is not automatically initialized at start-up, this function must be called from start-up code to ensure </p>
<p>that variables which must be initialized with a certain value (e.g. initialization status with UNINIT value) are </p>
<p>set to those values. </p>
<p><b>Particularities and Limitations </b></p>
<p><b>&gt; </b></p>
<p>The function </p>
<p>Nm_InitMemory()</p>
<p> has to be called with disabled global interrupts. </p>
<p><b>&gt; </b></p>
<p>Call context: task level. </p>
<p><b>&gt; </b></p>
<p>Not re-entrant. </p>
<p><b>&gt; </b></p>
<p>This function is only available if </p>
<p>NM_COORDINATOR_SUPPORT_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p>. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>64 / 104 </p>
<p><b>5.6.9.2 </b></p>
<p><b>Nm_RequestBusSynchronization: Request Bus Synchronization</b></p>
<p><b>14</b></p>
<p><b> </b></p>
<p><b>Nm_RequestBusSynchronization </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_RequestBusSynchronization </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Checking of remote sleep indication has failed </p>
<p>NM_E_NOT_EXECUTED </p>
<p>Requesting of node detection is currently not executed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0xC0 </p>
<p><b>Functional Description </b></p>
<p>Request Bus Synchronization by calling the RequestBusSynchronization function for the respective bus-</p>
<p>specific NM. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level only </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_ENABLE_COMM21_SUPPORT</p>
<p> is defined and </p>
<p>NM_BUS_SYNCHRONIZATION_ENABLED</p>
<p> is</p>
<p> STD_ON</p>
<p> and if </p>
<p>NM_PASSIVE_MODE_ENABLED</p>
<p> is </p>
<p>STD_OFF</p>
<p>. </p>
<p>                                            </p>
<p>14</p>
<p> If </p>
<p>NM_ENABLE_COMM21_SUPPORT</p>
<p> is not defined this is only an internal API. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>65 / 104 </p>
<p><b>5.6.9.3 </b></p>
<p><b>Nm_CheckLimpHomeIndication: Check the Limp Home Status </b></p>
<p><b>Nm_CheckLimpHomeIndication </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_CheckLimpHomeIndication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>boolean* const nmLimpHomeIndPtr ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmLimpHomeIndPtr</p>
<p> </p>
<p>Pointer where check result of remote sleep indication shall be copied to </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Checking of limp home status has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0xD0 </p>
<p><b>Functional Description </b></p>
<p>Check the limp home status of the respective bus-specific NM. Note that only CAN NM and OSEK NM are </p>
<p>supported. For channels where CAN NM and OSEK NM are both assigned true (limp home) is returned </p>
<p>when both NMs are in limp home, otherwise false is returned. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level only </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_LIMP_HOME_INDICATION</p>
<p> is</p>
<p> defined</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>66 / 104 </p>
<p><b>5.6.9.4 </b></p>
<p><b>Nm_SetGwRemoteSleepFilter: Set Remote Sleep Filter </b></p>
<p><b>Nm_SetGwRemoteSleepFilter </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_SetGwRemoteSleepFilter </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>uint8 nmFilterMask ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmFilterMask</p>
<p> </p>
<p>Filter mask that shall be set for the remote sleep filter. The bit position </p>
<p>corresponds to the channel number. If the bit on a position is set the </p>
<p>corresponding channel is kept awake by routing relations. </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Setting of Remote Sleep Filter has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0xD1 </p>
<p><b>Functional Description </b></p>
<p>API sets the remote sleep filter for a channel. The filter influences the shutdown behavior of the NM gateway </p>
<p>algorithm on that channel. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level only </p>
<p></p>
<p> </p>
<p>Only re-entrant for different channel handles </p>
<p></p>
<p> </p>
<p>This function is enabled if ‘NM Gateway Extension’ is enabled </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>67 / 104 </p>
<p><b>5.6.9.5 </b></p>
<p><b>Nm_SetGwRemoteWakeupFilter: Set Remote Wakeup Filter </b></p>
<p><b>Nm_SetGwRemoteWakeupFilter </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_SetGwRemoteWakeupFilter </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>uint8 nmFilterMask ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmFilterMask</p>
<p> </p>
<p>Filter mask that shall be set for the remote wakeup filter. The bit position </p>
<p>corresponds to the channel number. If the bit on a position is set the </p>
<p>corresponding channel is (re-)started during wakeup. </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Setting of Remote Wakeup Filter has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0xD2 </p>
<p><b>Functional Description </b></p>
<p>API sets the remote wakeup filter for a channel. The filter influences the wakeup behavior of the NM gateway </p>
<p>algorithm on that channel. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level only </p>
<p></p>
<p> </p>
<p>Only re-entrant for different channel handles </p>
<p></p>
<p> </p>
<p>This function is enabled if ‘NM Gateway Extension’ is enabled </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>68 / 104 </p>
<p><b>5.6.9.6 </b></p>
<p><b>Nm_WakeupNotification: Wakeup Notification </b></p>
<p><b>Nm_WakeupNotification </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_WakeupNotification </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Notification for an external wakeup has failed </p>
<p>NM_E_NOT_EXECUTED </p>
<p>Notification for an external wakeup will be ignored due to not allowed in current </p>
<p>NM state. </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0xD3 </p>
<p><b>Functional Description </b></p>
<p>API that informs the NM that an external wakeup has been detected by the application. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task or interrupt level </p>
<p></p>
<p> </p>
<p>Only re-entrant for different channel handles </p>
<p></p>
<p> </p>
<p>This function is enabled if ‘NM Gateway Extension’ is enabled </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>69 / 104 </p>
<p><b>5.6.9.7 </b></p>
<p><b>Nm_SetDiagGwReqId: Set Requested Diagnostic Node Identifier </b></p>
<p><b>Nm_SetDiagGwReqId </b></p>
<p><b>Prototype </b></p>
<p>Nm_ReturnType <b>Nm_SetDiagGwReqId </b>( uint8 nmReqId ) </p>
<p><b>Parameter </b></p>
<p>nmReqId</p>
<p> </p>
<p>Requested Diagnostic Node Identifier </p>
<p><b>Return code </b></p>
<p>NM_E_OK </p>
<p>No error </p>
<p>NM_E_NOT_OK </p>
<p>Setting requested diagnostic node identifier has failed </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0xD4 </p>
<p><b>Functional Description </b></p>
<p>API sets the fourth byte in the NM transmission message on all channels and requests an additional </p>
<p>transmission in the next CAN NM main function. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task or interrupt level </p>
<p></p>
<p> </p>
<p>Not re-entrant </p>
<p></p>
<p> </p>
<p>This function is enabled if ‘Diagnostic Gateway Extension’ is enabled </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>70 / 104 </p>
<p><b>5.7 </b></p>
<p><b>Service Functions Used by NM Interface </b></p>
<p>In the following table services provided by other components, which are used by the NM </p>
<p>Interface are listed. For details about prototype and functionality refer to the documentation </p>
<p>of the providing component. </p>
<p><b>Component </b></p>
<p><b>API </b></p>
<p>DET </p>
<p>Det_ReportError </p>
<p>SchM </p>
<p>SchM_Enter_Nm </p>
<p>SchM_Exit_Nm </p>
<p>CanNm </p>
<p>CanNm_PassiveStartUp </p>
<p>CanNm_NetworkRequest </p>
<p>CanNm_NetworkRelease </p>
<p>CanNm_GetState </p>
<p>CanNm_SetUserData </p>
<p>CanNm_GetUserData </p>
<p>CanNm_GetPduData </p>
<p>CanNm_RepeatMessageRequest </p>
<p>CanNm_GetNodeIdentifier </p>
<p>CanNm_GetLocalNodeIdentifier </p>
<p>CanNm_CheckRemoteSleepIndication </p>
<p>CanNm_DisableCommunication </p>
<p>CanNm_EnableCommunication </p>
<p>CanNm_RequestBusSynchronization </p>
<p>FrNm </p>
<p>FrNm_PassiveStartUp </p>
<p>FrNm_NetworkRequest </p>
<p>FrNm_NetworkRelease </p>
<p>FrNm_GetState </p>
<p>FrNm_SetUserData </p>
<p>FrNm_GetUserData </p>
<p>FrNm_GetPduData </p>
<p>FrNm_RepeatMessageRequest </p>
<p>FrNm_GetNodeIdentifier </p>
<p>FrNm_GetLocalNodeIdentifier </p>
<p>FrNm_CheckRemoteSleepIndication </p>
<p>FrNm_DisableCommunication </p>
<p>FrNm_EnableCommunication </p>
<p>FrNm_RequestBusSynchronization </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>71 / 104 </p>
<p><b>Component </b></p>
<p><b>API </b></p>
<p>NmOsek </p>
<p>NmOsekInit </p>
<p>GotoMode </p>
<p>GetConfig </p>
<p>NmGetStatus </p>
<p>NmGetRemoteSleepInd </p>
<p>TalkNM </p>
<p>SilentNM </p>
<p>NmStateLimphome </p>
<p>NmStateBusSleep </p>
<p>NmStateWaitBusSleep </p>
<p>NmStateBusSleepInd </p>
<p>NmFiatB </p>
<p>NmFiatB_PassiveStartUp </p>
<p>NmFiatB_NetworkRequest </p>
<p>NmFiatB_NetworkRelease </p>
<p>NmFiatB_GetState </p>
<p>NmFiatB_SetUserData </p>
<p>NmFiatB_GetUserData </p>
<p>NmFiatB_GetNodeIdentifier </p>
<p>NmFiatB_GetLocalNodeIdentifier </p>
<p>NmFiatB_RepeatMessageRequest </p>
<p>NmFiatB_GetPduData </p>
<p>NmFiatB_CheckRemoteSleepIndication </p>
<p>NmFiatB_EnableCommunication </p>
<p>NmFiatB_DisableCommunication </p>
<p>NmFiatC </p>
<p>NmFiatC_PassiveStartUp </p>
<p>NmFiatC_NetworkRequest </p>
<p>NmFiatC_NetworkRelease </p>
<p>NmFiatC_GetState </p>
<p>NmFiatC_SetUserData </p>
<p>NmFiatC_GetUserData </p>
<p>NmFiatC_GetNodeIdentifier </p>
<p>NmFiatC_GetLocalNodeIdentifier </p>
<p>NmFiatC_RepeatMessageRequest </p>
<p>NmFiatC_GetPduData </p>
<p>NmFiatC_CheckRemoteSleepIndication </p>
<p>NmFiatC_EnableCommunication </p>
<p>NmFiatC_DisableCommunication </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>72 / 104 </p>
<p><b>Component </b></p>
<p><b>API </b></p>
<p>ComM (CCL) </p>
<p>ComM_Nm_NetworkStartIndication </p>
<p>ComM_Nm_NetworkMode </p>
<p>ComM_Nm_PrepareBusSleepMode </p>
<p>ComM_Nm_BusSleepMode </p>
<p>ComM_Nm_RestartIndication </p>
<p>ComM_Nm_LimpHomeIndication </p>
<p>ComM_Nm_LimpHomeCancelation </p>
<p>ComM_Nm_DiagGwReqIdIndication </p>
<p>Table 5-6  </p>
<p>Services Used by the NM Interface </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>73 / 104 </p>
<p><b>5.8 </b></p>
<p><b>Callback Functions Provided by NM Interface </b></p>
<p>The following callback functions are called from CAN NM, FlexRay Nm, Fiat Class B or </p>
<p>Fiat Class C. </p>
<p><b>5.8.1 </b></p>
<p><b>Nm_NetworkStartIndication: Network Start Indication  </b></p>
<p><b>Nm_NetworkStartIndication </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_NetworkStartIndication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x20 </p>
<p><b>Functional Description </b></p>
<p>Notification that a NM-message has been received in the Bus-Sleep Mode indicating that some nodes in the </p>
<p>network have already entered the Network Mode. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM, FlexRay NM, Fiat Class B or Fiat Class C </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>74 / 104 </p>
<p><b>5.8.2 </b></p>
<p><b>Nm_NetworkMode: Network Mode Indication  </b></p>
<p><b>Nm_NetworkMode </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_NetworkMode </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x21 </p>
<p><b>Functional Description </b></p>
<p>Notification that the network management has entered Network Mode. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM, FlexRay NM, Fiat Class B or Fiat Class C </p>
<p> </p>
<p><b>5.8.3 </b></p>
<p><b>Nm_PrepareBusSleepMode: Prepare Bus Sleep Mode Indication  </b></p>
<p><b>Nm_PrepareBusSleepMode </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_PrepareBusSleepMode </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x22 </p>
<p><b>Functional Description </b></p>
<p>Notification that the network management has entered Prepare Bus Sleep Mode. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM, Fiat Class B or Fiat Class C </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>75 / 104 </p>
<p><b>5.8.4 </b></p>
<p><b>Nm_BusSleepMode: Bus Sleep Mode Indication  </b></p>
<p><b>Nm_BusSleepMode </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_BusSleepMode </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x23 </p>
<p><b>Functional Description </b></p>
<p>Notification that the network management has entered Bus Sleep Mode. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM, FlexRay NM, Fiat Class B or Fiat Class C </p>
<p> </p>
<p><b>5.8.5 </b></p>
<p><b>Nm_RemoteSleepIndication: Remote Sleep Indication </b></p>
<p><b>Nm_RemoteSleepIndication </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_RemoteSleepIndication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x24 </p>
<p><b>Functional Description </b></p>
<p>Notification that the network management has detected that all other nodes are ready to sleep. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM, FlexRay NM, Fiat Class B or Fiat Class C </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_REMOTE_SLEEP_IND_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>76 / 104 </p>
<p><b>5.8.6 </b></p>
<p><b>Nm_RemoteSleepCancellation: NM Remote Sleep Cancellation </b></p>
<p><b>Nm_RemoteSleepCancellation </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_RemoteSleepCancellation </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x25 </p>
<p><b>Functional Description </b></p>
<p>Notification that the network management has detected that no more all other nodes are ready to sleep. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM, FlexRay NM, Fiat Class B or Fiat Class C </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_REMOTE_SLEEP_IND_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<p><b>5.8.7 </b></p>
<p><b>Nm_PduRxIndication: NM Message Reception Indication </b></p>
<p><b>Nm_PduRxIndication </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_PduRxIndication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x26 </p>
<p><b>Functional Description </b></p>
<p>Notification that a NM message has been received. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM or FlexRay NM </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_PDU_RX_INDICATION_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>77 / 104 </p>
<p><b>5.8.8 </b></p>
<p><b>Nm_RepeatMessageIndication: Repeat Message Request Indication </b></p>
<p><b>Nm_RepeatMessageIndication </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_RepeatMessageIndication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x28 </p>
<p><b>Functional Description </b></p>
<p>Notification that a NM message has been received where the Repeat Message Bit was set. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM or FlexRay NM </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_NODE_DETECTION_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>78 / 104 </p>
<p><b>5.8.9 </b></p>
<p><b>Nm_StateChangeNotification: State Change Notification </b></p>
<p><b>Nm_StateChangeNotification </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_StateChangeNotification </b>(  </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>const Nm_StateType nmPreviousState, </p>
<p>   </p>
<p> </p>
<p>const Nm_StateType nmCurrentState ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmPreviousState </p>
<p>Previous State </p>
<p>nmCurrentState </p>
<p>Current State </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID </p>
<p>0x27 </p>
<p><b>Functional Description </b></p>
<p>Notification that the NM state has changed. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM, FlexRay NM, Fiat Class B or Fiat Class C </p>
<p></p>
<p> </p>
<p>This function is enabled if </p>
<p>NM_STATE_CHANGE_IND_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>79 / 104 </p>
<p><b>5.8.10 </b></p>
<p><b>Nm_TxTimeoutException: Transmission Timeout Exception </b></p>
<p><b>Nm_TxTimeoutException </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_TxTimeoutException </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x29 </p>
<p><b>Functional Description </b></p>
<p>Notification that the transmission of network management was not successful for a configurable amount of </p>
<p>time. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM or FlexRay NM </p>
<p></p>
<p> </p>
<p>This function is disabled if </p>
<p>NM_PASSIVE_MODE_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<p><b>5.8.11 </b></p>
<p><b>Nm_CarWakeUpIndication: Car Wake-up Indication </b></p>
<p><b>Nm_CarWakeUpIndication </b></p>
<p><b>Prototype </b></p>
<p>void <b>Nm_CarWakeUpIndication </b>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x2A </p>
<p><b>Functional Description </b></p>
<p>Notification that a message with the car wake-up bit set has been received. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM or FlexRay NM </p>
<p></p>
<p> </p>
<p>This function is only enabled if </p>
<p>NM_CAR_WAKE_UP_RX_ENABLED</p>
<p> is </p>
<p>STD_ON</p>
<p> </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>80 / 104 </p>
<p><b>5.8.12 </b></p>
<p><b>Vector Extensions </b></p>
<p><b>5.8.12.1 </b></p>
<p><b>Nm_ActiveCoordIndication: Indication of an Active Coordinator Bit </b></p>
<p><b>Nm_ActiveCoordIndication </b></p>
<p><b>Prototype </b></p>
<p>void </p>
<p><b>Nm_ActiveCoordIndication </b></p>
<p>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>const uint8 nmCoordPrio </p>
<p> </p>
<p> </p>
<p> </p>
<p>const uint8 nmSleepInd ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmCoordPrio </p>
<p>Coordinator priority received </p>
<p>nmSleepInd </p>
<p>Sleep Indication Bit </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x32 </p>
<p><b>Functional Description </b></p>
<p>This callback function is called when a NM message with a priority from another coordinator is received. The </p>
<p>handling of the information is done in the NM Interface. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: Interrupt and task level </p>
<p></p>
<p> </p>
<p>Only re-entrant for different channel handles </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM or FlexRay NM </p>
<p></p>
<p> </p>
<p>This function is enabled if Coordinator Extension feature is available and </p>
<p>NM_ENABLE_COORD_SYNC_SUPPORT</p>
<p> is defined </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>81 / 104 </p>
<p><b>5.8.12.2 </b></p>
<p><b>Nm_LimpHomeIndication: Limp Home Indication </b></p>
<p><b>Nm_LimpHomeIndication </b></p>
<p><b>Prototype </b></p>
<p>void </p>
<p><b>Nm_LimpHomeIndication </b></p>
<p>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x30 </p>
<p><b>Functional Description </b></p>
<p>Notification that the network management has detected that no NM message was received and no message </p>
<p>could be transmitted for a certain amount of time. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM </p>
<p></p>
<p> </p>
<p>This function is enabled if Limp Home Indication feature is available and </p>
<p>NM_LIMP_HOME_INDICATION</p>
<p> is defined </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>82 / 104 </p>
<p><b>5.8.12.3 </b></p>
<p><b>Nm_LimpHomeCancelation: NM Remote Sleep Cancellation </b></p>
<p><b>Nm_LimpHomeCancelation </b></p>
<p><b>Prototype </b></p>
<p>void </p>
<p><b>Nm_LimpHomeCancelation </b></p>
<p>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle ) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x31 </p>
<p><b>Functional Description </b></p>
<p>Notification that the network management has successfully received or transmitted a NM message after </p>
<p>Nm_LimpHomeIndication</p>
<p> was called. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: task level </p>
<p></p>
<p> </p>
<p>Re-entrant </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM </p>
<p></p>
<p> </p>
<p>This function is enabled if Limp Home Indication feature is available and </p>
<p>NM_LIMP_HOME_INDICATION</p>
<p> is defined </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>83 / 104 </p>
<p><b>5.8.12.4 </b></p>
<p><b>Nm_GwPduRxIndication: Extended Gateway Message Indication </b></p>
<p><b>Nm_GwPduRxIndication </b></p>
<p><b>Prototype </b></p>
<p>void </p>
<p><b>Nm_GwPduRxIndication </b></p>
<p>( </p>
<p> </p>
<p> </p>
<p> </p>
<p>const NetworkHandleType nmChannelHandle, </p>
<p> </p>
<p> </p>
<p> </p>
<p>uint8 </p>
<p>nmNodeId, uint8 nmReqId, </p>
<p> uint8 </p>
<p>nmReqCh </p>
<p>) </p>
<p><b>Parameter </b></p>
<p>nmChannelHandle </p>
<p>Identification of the physical channel </p>
<p>nmNodeId</p>
<p> </p>
<p>Node identifier in the received NM PDU </p>
<p>nmReqId </p>
<p>Requestor ID in the received NM PDU (byte 4) </p>
<p>nmReqCh</p>
<p> </p>
<p>Requested channels to be active in the received NM PDU (byte 5) </p>
<p><b>Return code </b></p>
<p>- </p>
<p>- </p>
<p><b>Service ID </b></p>
<p>Service ID</p>
<p> </p>
<p>0x33 </p>
<p><b>Functional Description </b></p>
<p>This callback function is called each time when a NM message is received. The additional information in that </p>
<p>callback is required for the gateway extension algorithm. </p>
<p><b>Particularities and Limitations </b></p>
<p></p>
<p> </p>
<p>Call context: Interrupt or task level </p>
<p></p>
<p> </p>
<p>Only re-entrant for different channel handles </p>
<p></p>
<p> </p>
<p>This service may only be called by CAN NM </p>
<p></p>
<p> </p>
<p>This function is enabled if Gateway Extension feature is enabled </p>
<p> </p>
<p><b>5.8.12.5 </b></p>
<p><b>OSEK NM Callback Functions </b></p>
<p>The  following  table  provides  an  overview  which  OSEK  NM  callbacks  are  implemented </p>
<p>within the NM Interface. For more information about the callbacks refer to the Technical </p>
<p>Reference of OSEK NM. </p>
<p><b>OSEK NM Callback Function </b></p>
<p><b>Description </b></p>
<p>ApplNmCanNormal </p>
<p>Notification that OSEK NM entered 'Network Mode' from </p>
<p>‘Sleep’ </p>
<p>ApplNmBusStart </p>
<p>Notification of OSEK NM Bus Start </p>
<p>ApplNmWaitBusSleep </p>
<p>Notification that OSEK NM entered 'Prepare Bus Sleep' </p>
<p>ApplNmWaitBusSleepCancel </p>
<p>Notification that OSEK NM restarted from 'Prepare Bus Sleep' </p>
<p>and entered ‘Network Mode’ </p>
<p>ApplNmCanBusSleep </p>
<p>Notification that OSEK NM entered 'Bus Sleep' </p>
<p>ApplNmCanSleep </p>
<p>Notification that OSEK NM entered 'Bus Sleep' </p>
<p>ApplNmBusOff </p>
<p>Notification that OSEK NM was informed about BusOff </p>
<p>occurrence </p>
<p>ApplNmBusOffEnd </p>
<p>Notification that OSEK NM was informed about a BusOff </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>84 / 104 </p>
<p><b>OSEK NM Callback Function </b></p>
<p><b>Description </b></p>
<p>recovery attempt </p>
<p>ApplNmGwPduRxIndication </p>
<p>Extended gateway notification that a NM message with </p>
<p>cleared sleep indication bit was received </p>
<p>Table 5-7  </p>
<p>OSEK NM Callback Functions </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>85 / 104 </p>
<p><b>5.9 </b></p>
<p><b>Callback Functions Used by NM Interface </b></p>
<p>Refer </p>
<p>also </p>
<p>to </p>
<p>chapter </p>
<p>5.8 </p>
<p>‘Callback </p>
<p>Functions </p>
<p>Provided </p>
<p>by </p>
<p>NM </p>
<p>Interface’ </p>
<p>for </p>
<p>more </p>
<p>information about these callback functions. </p>
<p><b>5.9.1 </b></p>
<p><b>Service Callback Functions of NM Interface </b></p>
<p>The following service  callback functions of NM Interface are implemented within ComM. </p>
<p>Please refer to documentation of the ComM component for a detailed description of these </p>
<p>services: </p>
<p>void <b>ComM_Nm_NetworkStartIndication</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>ComM_Nm_NetworkMode</b>( const NetworkHandleType nmChannelHandle </p>
<p>) </p>
<p>void <b>ComM_Nm_PrepareBusSleepMode</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>ComM_Nm_BusSleepMode</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>ComM_Nm_RestartIndication</b>( const NetworkHandleType </p>
<p>nmChannelHandle )</p>
<p>15</p>
<p> </p>
<p>These functions are called from task level. </p>
<p><b>5.9.2 </b></p>
<p><b>Configurable Service Callback Functions </b></p>
<p>For  the  following  service  functions  called  optionally  from  the  NM  Interface  an  arbitrary </p>
<p>callback function to the upper layer can be configured (see also chapter 6.3.1 ‘Component </p>
<p>Configuration’): </p>
<p>void <b>Ul_Nm_RepeatMessageIndication</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>Ul_Nm_RemoteSleepIndication</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>Ul_Nm_RemoteSleepCancellation</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>Ul_Nm_PduRxIndication</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>Ul_Nm_StateChangeNotification</b>(const NetworkHandleType nmChannelHandle,  </p>
<p>  const Nm_StateType nmPreviousState, </p>
<p> </p>
<p>  const Nm_StateType nmCurrentState ) </p>
<p>void <b>Ul_TxTimeoutException</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>The naming of these functions can be configured arbitrarily. </p>
<p>These functions are called from task level except the </p>
<p>Ul_Nm_PduRxIndication</p>
<p>, which </p>
<p>can be called from interrupt or from task level. </p>
<p>                                            </p>
<p>15</p>
<p> This callback function will only be called if the Coordination Feature is enabled. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>86 / 104 </p>
<p><b>5.9.3 </b></p>
<p><b>Additional Service Callback Functions of NM Interface </b></p>
<p>The service callbacks described in this are additionally provided by the NM Interface when </p>
<p>the corresponding feature is available. They have to be provided by the upper layer. </p>
<p><b>5.9.3.1 </b></p>
<p><b>Callbacks for Limp Home Indication </b></p>
<p>The  following  two  callbacks  are  provided  for  limp  home  detection  /  cancellation  if  limp </p>
<p>home feature is enabled: </p>
<p>void <b>ComM_Nm_LimpHomeIndication</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>void <b>ComM_Nm_LimpHomeCancelation</b>( const NetworkHandleType </p>
<p>nmChannelHandle ) </p>
<p>These functions are called from task level. </p>
<p><b>5.9.3.2 </b></p>
<p><b>Callback for Diagnostic Gateway Extension </b></p>
<p>The following callback is provided by the NM Interface if the diagnostic gateway extension </p>
<p>feature is enabled: </p>
<p>void <b>ComM_Nm_DiagGwReqIdIndication</b>( const NetworkHandleType </p>
<p>nmChannelHandle, </p>
<p>  uint8 nmNodeId, uint8 nmReqId ) </p>
<p>This function is called during NM message reception indication function, i.e. in most cases </p>
<p>from interrupt level. </p>
<p><b>5.9.3.3 </b></p>
<p><b>Generator Compatibility Error </b></p>
<p>The  following  callback  has  to  be  provided  by  the  ECU  Manager  if  the  Version  Check </p>
<p>feature is not explicitly suppressed or if the CRC Check feature is enabled: </p>
<p>void <b>EcuM_GeneratorCompatibilityError</b>( </p>
<p> </p>
<p> </p>
<p>uint16 ModuleId, </p>
<p> </p>
<p> </p>
<p>uint8 InstanceId ) </p>
<p>This function is called during the initialization, i.e. from task level, of the NM Interface if the </p>
<p>Generator Version Check or the CRC Check fails. </p>
<p>Refer to [10] for more information. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>87 / 104 </p>
<p><b>6 </b></p>
<p><b>Configuration </b></p>
<p>The  configuration  of  the  AUTOSAR  NM  Interface  component  is  done  by  pre-compile </p>
<p>configuration or post-compile configuration. Pre-compile configuration can only be carried </p>
<p>out  if  source  code  is  available.  Post-compile  configuration  is  only  reasonable  if  source </p>
<p>code is not available, i.e. the components are available as object code or library.  </p>
<p>It depends on the OEM and license whether pre-compile configuration with source code or </p>
<p>post-compile configuration with object code and library has to be used. </p>
<p>In the Nm the attributes can be configured according to/ with the following methods/ tools: </p>
<p><b>&gt; </b> Configuration in Database, for a detailed description see chapter 6.2 </p>
<p><b>&gt; </b> Configuration in GENy for a detailed description see chapter 6.3 </p>
<p><b>6.1 </b></p>
<p><b>Configuration Variants </b></p>
<p>The Nm supports the configuration variants </p>
<p><b>&gt; </b></p>
<p>VARIANT-PRE-COMPILE </p>
<p><b>&gt; </b></p>
<p>VARIANT-LINK-TIME </p>
<p>The configuration classes of the  Nm parameters depend on the supported configuration </p>
<p>variants. For their definitions please see the Nm_bswmd.arxml file. </p>
<p><b>6.2 </b></p>
<p><b>Configuration in Data Base </b></p>
<p>The following table provides a list of database attributes defined in a DBC file that apply to </p>
<p>NM Interface. </p>
<p><b>Attribute </b></p>
<p><b>Object </b></p>
<p><b>Type </b></p>
<p><b>Values </b></p>
<p><b>Default </b></p>
<p><b>Description </b></p>
<p>NmType </p>
<p>Network </p>
<p>String </p>
<p>“NmAsr”,</p>
<p> </p>
<p>“&lt;OEM&gt;-</p>
<p>OSEK” </p>
<p>None </p>
<p>This attribute defines the </p>
<p>type of the NM. For OSEK-</p>
<p>NM this type is OEM-</p>
<p>specific. </p>
<p>NmAsrNode</p>
<p>16</p>
<p> </p>
<p>Node </p>
<p>Enumer</p>
<p>ation </p>
<p>No, yes </p>
<p>No </p>
<p>This attribute defines </p>
<p>whether the corresponding </p>
<p>node uses the AUTOSAR </p>
<p>NM (“Yes””) or not (“No”). </p>
<p>Table 6-1  </p>
<p>Database Attributes </p>
<p>                                            </p>
<p>16</p>
<p> Database attribute is required if GENy is used for the configuration. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>88 / 104 </p>
<p><b>6.3 </b></p>
<p><b>Configuration with GENy </b></p>
<p>The </p>
<p>configuration </p>
<p>of </p>
<p>the </p>
<p>AUTOSAR </p>
<p>Network </p>
<p>Management </p>
<p>is </p>
<p>performed </p>
<p>with </p>
<p>the </p>
<p>generation tool GENy. </p>
<p>It is strongly recommend using the database attributes listed in chapter 6.2 ‘Configuration </p>
<p>in Data Base’. Some attributes are mandatory for the usage of NM Interface. Please note </p>
<p>that  the  configuration  items  gathered  from  the  database  are  disabled  and  grayed  and </p>
<p>cannot be overwritten by the user. </p>
<p> </p>
<p> </p>
<p>Figure 6-1 </p>
<p>Component Selection in GENy </p>
<p>In  order  to  configure  the  AUTOSAR  Network  Management  Interface  component,  the </p>
<p>component ‘Nm’ has to be activated on the designated channels. </p>
<p>NM  Interface  can  be  activated  independently  of  the  underlying  bus  specific  network </p>
<p>management. The activation of a bus-specific NM requires the activation of NM Interface </p>
<p>on the same channel. </p>
<p>The  configuration  of  the  component  is  done  on  separate  pages  due  to  there  are  ECU </p>
<p>specific and channel specific settings that have to be customized separately. </p>
<p>Depending  on  the  used  features  and  bus-specific  NMs  some  restrictions  apply  to  the </p>
<p>configuration </p>
<p>of </p>
<p>the </p>
<p>NM </p>
<p>Interface </p>
<p>and </p>
<p>all </p>
<p>used </p>
<p>subjacent </p>
<p>network </p>
<p>managements. </p>
<p>Additionally if OSEK Support is enabled (refer to chapter 3.8 ‘OSEK NM Support’) some </p>
<p>additional configuration items have to be considered to the OSEK NM configuration. </p>
<p>If a mixed-mode NM is used, all underlying bus-specific NMs have to be enabled on that </p>
<p>channel. </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>89 / 104 </p>
<p><b>6.3.1 </b></p>
<p><b>Component Configuration </b></p>
<p>The component configuration of NM Interface is done as follows: </p>
<p> </p>
<p>Figure 6-2 </p>
<p>Component Configuration NM Interface </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>90 / 104 </p>
<p> </p>
<p><b>Configuration options </b></p>
<p><b>Value </b></p>
<p><b>Description </b></p>
<p>Common </p>
<p>Configuration Variant </p>
<p><b>&gt; </b></p>
<p>Variant 1 </p>
<p><b>&gt; </b></p>
<p>Variant 2 </p>
<p>Set the AUTOSAR Configuration Variant </p>
<p>(Variant 1: Pre-compile configuration; Variant 2: </p>
<p>Link-time configuration). </p>
<p>Version Info API</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate the version information </p>
<p>functionality. </p>
<p>Dev Error Detection</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate error reporting to the </p>
<p>development error detection. </p>
<p>The development error detection comprises </p>
<p>amongst others channel parameter checks and </p>
<p>check of initialization upon every service call. </p>
<p>It is strongly recommended to disable this </p>
<p>option in production code. </p>
<p>Prod Error Detect</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate error reporting to the </p>
<p>diagnostic event manager </p>
<p>User Config File </p>
<p>string </p>
<p>Enter the path of a user config file.</p>
<p> </p>
<p>The user config file is pasted at the end of the </p>
<p>NM Interface configuration file during the </p>
<p>generation process. </p>
<p>It can be used to manually customize the NM </p>
<p>Interface. </p>
<p>Miscellaneous </p>
<p> </p>
<p>Network Management Interface Options </p>
<p>Bus Synchronization </p>
<p>Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate bus synchronization </p>
<p>(gateway functionality). It is automatically </p>
<p>configured depending on the feature </p>
<p>‘Coordinator Support’. </p>
<p>Node Detection Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate node detection support. It </p>
<p>can only be enabled if Passive Mode is </p>
<p>disabled and Node Identifier is enabled. </p>
<p>Node Id Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate node identifier support. </p>
<p>Passive Mode Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate passive mode. </p>
<p>PDU Rx Indication Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate PDU receive indication </p>
<p>functionality. </p>
<p>Remote Sleep Ind Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate remote sleep indication </p>
<p>(gateway functionality). It can only be enabled if </p>
<p>Passive Mode is disabled. </p>
<p>State Change Ind Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate state change notification </p>
<p>functionality. </p>
<p>                                            </p>
<p>17</p>
<p> Pre-compile parameter which is read-only in post-compile configurations. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>91 / 104 </p>
<p>User Data Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate the user data support. </p>
<p>Com Control Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate communication control </p>
<p>service. It can only be enabled if Passive Mode </p>
<p>is disabled. </p>
<p>Car Wake Up Rx Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate the feature ‘Car Wakeup’. </p>
<p>Feature details can be found in chapter 3.11 </p>
<p>‘Car Wakeup’. </p>
<p> </p>
<p>NM Callbacks to Upper Layer </p>
<p>Nm Callbacks Prototype </p>
<p>Header </p>
<p>string </p>
<p>Enter the header file name that contains the </p>
<p>prototypes for all used callback functions (i.e. all </p>
<p>callback functions below where a function name </p>
<p>is entered). Return Type and API parameters for </p>
<p>the function prototypes have to be the same as </p>
<p>for the callback functions provided by the NM </p>
<p>(see chapter 5.8). </p>
<p>This field can be left blank if no callback to the </p>
<p>upper layer is used. </p>
<p>State Change Indication </p>
<p>Callback </p>
<p>string </p>
<p>Enter the function name of the service that </p>
<p>should be called to the upper layer in case of a </p>
<p>state transition. </p>
<p>This field can be left blank if a callback to the </p>
<p>upper layer is not required. </p>
<p>Remote Sleep Indication </p>
<p>Callback </p>
<p>string </p>
<p>Enter the function name of the service that </p>
<p>should be called to the upper layer in case of a </p>
<p>remote sleep indication. </p>
<p>This field can be left blank if a callback to the </p>
<p>upper layer is not required. </p>
<p>Remote Sleep Cancellation </p>
<p>Callback </p>
<p>string </p>
<p>Enter the function name of the service that </p>
<p>should be called to the upper layer in case of a </p>
<p>remote sleep cancellation. </p>
<p>This field can be left blank if a callback to the </p>
<p>upper layer is not required. </p>
<p>PDU Receive Indication </p>
<p>Callback </p>
<p>string </p>
<p>Enter the function name of the service that </p>
<p>should be called to the upper layer in case of a </p>
<p>NM message reception. </p>
<p>This field can be left blank if a callback to the </p>
<p>upper layer is not required. </p>
<p>Repeat Message Indication </p>
<p>Callback </p>
<p>string </p>
<p>Enter the function name of the service that </p>
<p>should be called to the upper layer in case of a </p>
<p>repeat message indication. </p>
<p>This field can be left blank if a callback to the </p>
<p>upper layer is not required. </p>
<p>Transmission Timeout Error </p>
<p>Callback </p>
<p>string </p>
<p>Enter the function name of the service that </p>
<p>should be called to the upper layer in case a </p>
<p>transmission timeout occurs. </p>
<p>This field can be left blank if a callback to the </p>
<p>upper layer is not required. </p>
<p>Car Wake Up Callback </p>
<p>string </p>
<p>Enter the function name of the service that </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>92 / 104 </p>
<p>should be called to the upper layer in case a car </p>
<p>wakeup is detected. </p>
<p>This field can be left blank if a callback to the </p>
<p>upper layer is not required. </p>
<p> </p>
<p>NM Coordinator Options </p>
<p>Coordinator Support </p>
<p>Enabled</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate Network Management </p>
<p>Coordinator Support for synchronous shutdown. </p>
<p>NM Coordination Shutdown </p>
<p>Timer </p>
<p>0..65535 </p>
<p>The shutdown timer used for the computation of </p>
<p>the shutdown timing for each channel. </p>
<p>This parameter is only editable if Coordination </p>
<p>Synchronization Support is enabled. Refer to </p>
<p>chapter 6.3.3 ‘NM Coordination Restrictions’ for </p>
<p>more information. </p>
<p>Cycle Time Main Function </p>
<p>[ms]  </p>
<p>1..xxxx </p>
<p>The call cycle time value of the NM main </p>
<p>function has to be set here. The default value is </p>
<p>10. Refer to chapter 6.3.3 ‘NM Coordination </p>
<p>Restrictions’ for more information. </p>
<p>OSEK Support Enabled</p>
<p>17</p>
<p> </p>
<p>Read Only </p>
<p>Activate/Deactivate Support for OSEK Network </p>
<p>Management. </p>
<p>The feature is handled automatically depending </p>
<p>whether OSEK NM is enabled on at least one </p>
<p>channel together with the NM. </p>
<p>Synchronized OSEK NM </p>
<p>channel</p>
<p>17</p>
<p> </p>
<p>0..255 </p>
<p>System channel handle to identify the OSEK </p>
<p>NM channel that is relevant for the NM </p>
<p>Coordination. </p>
<p>This parameter is only visible and editable if </p>
<p>more than one OSEK NM channel is available. </p>
<p>In all other cases this value is automatically </p>
<p>computed. </p>
<p> </p>
<p>NM Extensions </p>
<p>Macro Layer Optimization</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>In some configurations the NM Interface can be </p>
<p>optimized to be a macro layer. </p>
<p>Refer to chapter 3.3 ‘Macro Layer Optimization’ </p>
<p>for more details. </p>
<p>Limp Home Indication</p>
<p>18</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate the limp home indication. It </p>
<p>can only be enabled if Passive Mode is </p>
<p>disabled. </p>
<p>NM Support for ComM 2.1 </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate NM support for AUTOSAR </p>
<p>3 NM in combination with AUTOSAR 2.1 </p>
<p>ComM. </p>
<p>NM User Data via Com </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate the feature ‘NM User Data </p>
<p>via Com’. It can only be enabled if Passive </p>
<p>Mode is disabled. </p>
<p>State Change Ind Osek Nm </p>
<p>Enabled </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate state change notifications </p>
<p>when OSEK NM changes its state. </p>
<p>Nm Ext Init Osek Nm </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p>Activate/Deactivate the OSEK NM Initialization </p>
<p>                                            </p>
<p>18</p>
<p> This configuration item is only relevant if the Limp Home Indication feature is available. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>93 / 104 </p>
<p>Enabled </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Extension feature. </p>
<p>Ext Init Osek Nm State </p>
<p><b>&gt; </b></p>
<p>NM_CANSLEEP </p>
<p><b>&gt; </b></p>
<p>NM_NORMAL </p>
<p><b>&gt; </b></p>
<p>NM_SLEEPIND </p>
<p>Set the OSEK NM Initialization state. </p>
<p>Refer to chapter 3.8.6 ‘Extended Initialization’ </p>
<p>for further information. </p>
<p> </p>
<p> </p>
<p>NM Coordinator Extensions </p>
<p>Coordinator Synchronization </p>
<p>Support</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate Coordinator </p>
<p>Synchronization Support for supporting more </p>
<p>than one coordinator connected to one channel. </p>
<p>Coordinator Synchronization </p>
<p>Priority </p>
<p><b>&gt; </b></p>
<p>Low </p>
<p><b>&gt; </b></p>
<p>Middle </p>
<p><b>&gt; </b></p>
<p>High </p>
<p>Set the coordination synchronization priority </p>
<p>used for the detection of the active coordinator. </p>
<p> </p>
<p> </p>
<p>NM Gateway Extensions </p>
<p>NM Gateway Extension</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate NM Gateway Extension. </p>
<p>Refer to chapter 3.10.2 ‘NM Gateway </p>
<p>Extension’ for further information. Please </p>
<p>consider also the configuration restrictions in </p>
<p>chapter 6.3.7 ‘NM Gateway Extension </p>
<p>Configuration Restrictions’. </p>
<p>Diagnostic Gateway </p>
<p>Extension</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate Diagnostic Gateway </p>
<p>Extension. Refer to chapter 3.10.1 ‘Diagnostic </p>
<p>Gateway Extension’ for further information. </p>
<p>Please consider also the configuration </p>
<p>restrictions in chapter 6.3.6 ‘Diagnostic </p>
<p>Gateway Extension Configuration Restrictions’. </p>
<p> </p>
<p>AMD Runtime Measurement </p>
<p>AMD Runtime </p>
<p>Measurement</p>
<p>17</p>
<p> </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>This parameter defines if AMD Runtime </p>
<p>Measurement (RTM) is enabled for this module. </p>
<p>Table 6-2   Component Configuration NM Interface </p>
<p><b>6.3.2 </b></p>
<p><b>Channel Configuration </b></p>
<p>The channel configuration of NM Interface is done as follows: </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>94 / 104 </p>
<p> </p>
<p>Figure 6-3 </p>
<p>Channel Configuration NM Interface </p>
<p><b>Configuration options </b></p>
<p><b>Value </b></p>
<p><b>Description </b></p>
<p>General Settings </p>
<p>Bus System Type </p>
<p>Read Only </p>
<p>Bus system type of the respective channel.  </p>
<p>Manufacturer </p>
<p>Read Only </p>
<p>Value is currently not available for FlexRay </p>
<p>channels. Therefore it will always be set to </p>
<p>‘Unknown’. </p>
<p>Miscellaneous </p>
<p> </p>
<p>NM Coordinator Options </p>
<p>Selective NM Channel </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>If enabled the corresponding channel is selective </p>
<p>and therefore not part of the coordinated channels. </p>
<p>If disabled the channel is synchronous and is </p>
<p>considered in the NM Coordination. </p>
<p>Refer to chapter 3.4.1 ‘Selective Channels’ for </p>
<p>further information. </p>
<p>Passive Coordinated Nm </p>
<p>Channel </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>When enabling this feature the corresponding </p>
<p>channel does not coordinate the channel actively </p>
<p>and behaves always as if another coordinator with a </p>
<p>higher priority is active. </p>
<p>Refer to chapter 3.6 ‘Passive Coordinator’ for more </p>
<p>information. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>95 / 104 </p>
<p> </p>
<p>NM Options </p>
<p>State Report Enabled </p>
<p><b>&gt; </b></p>
<p>Enable </p>
<p><b>&gt; </b></p>
<p>Disable </p>
<p>Activate/Deactivate the feature ‘Set Nm State in </p>
<p>User Data’ on the corresponding channel. </p>
<p>Refer to chapter 3.12 ‘Set Nm State in User Data’ </p>
<p>for further information. </p>
<p>State Report Signal Ref </p>
<p>Signal Name </p>
<p>This parameter defines the signal where the state </p>
<p>change information is set. Note that this feature can </p>
<p>only be enabled if ‘State Report Enabled’ is enabled. </p>
<p>Refer to chapter 3.12 ‘Set Nm State in User Data’ </p>
<p>for further information. </p>
<p>Table 6-3  </p>
<p>Channel Configuration NM Interface </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>96 / 104 </p>
<p><b>6.3.3 </b></p>
<p><b>NM Coordination Restrictions </b></p>
<p><b>6.3.3.1 </b></p>
<p><b>Needed NM Features </b></p>
<p>For  the  proper  usage  of  the  NM  Coordination  some  configuration  items  of  the  NMs  are </p>
<p>required  to  be  enabled.  They  are  listed  for  all  possibly  involved  components  in  the </p>
<p>following table: </p>
<p> </p>
<p><b>Component </b></p>
<p><b>Required Configuration Item </b></p>
<p>NM Interface / CAN NM / FlexRay NM </p>
<p>Remote Sleep Ind Enabled </p>
<p>NM Interface / CAN NM / FlexRay NM </p>
<p>Bus Synchronization Enabled </p>
<p>FlexRay NM / CAN NM </p>
<p>Ext Remote Sleep Indication </p>
<p>OSEK NM </p>
<p>Remote Sleep </p>
<p>OSEK NM </p>
<p>Node Monitoring </p>
<p>OSEK NM </p>
<p>Extended Callbacks </p>
<p>OSEK NM </p>
<p>Token Monitoring </p>
<p>OSEK NM </p>
<p>Indexed Component </p>
<p>Fiat Class B </p>
<p>Nm Type = ‘Master’ </p>
<p>Fiat Class C </p>
<p>Nm Type = ‘Master’ </p>
<p>Table 6-4  </p>
<p>Required Configuration Items for the NM Coordination </p>
<p>For a detailed description of these descriptions and their configuration please refer to the </p>
<p>Technical Reference of the corresponding network management. </p>
<p><b>6.3.3.2 </b></p>
<p><b>NM Main Function Cycle Time </b></p>
<p>The  NM  coordination  algorithm  is  performed  within  the  cyclic  NM  task.  To  ensure  an </p>
<p>immediate reaction to changes in the bus-specific NMs and the correct triggering of the </p>
<p>shutdown phase the following timing restrictions must be fulfilled: </p>
<p><b>&gt; </b> NM Main Function Cycle Time must be less or equal than the CAN NM Main Function </p>
<p>Cycle Time </p>
<p><b>&gt; </b> NM Main Function Cycle Time must be less or equal than the OSEK NM Main </p>
<p>Function Cycle Time </p>
<p><b>&gt; </b> NM Main Function Cycle Time must be less or equal than the FlexRay NM Repetition </p>
<p>Cycle Time</p>
<p>19</p>
<p> </p>
<p>Additionally it is recommended that the bus-specific NM tasks are executed after the NM </p>
<p>task. </p>
<p><b>6.3.3.3 </b></p>
<p><b>Shutdown Timing </b></p>
<p>For the computation of the shutdown timing of each channel a maximum value is required. </p>
<p>This value can be configured with the parameter ‘NM Coordination Shutdown Timer’ (see </p>
<p>chapter 6.3.1 ‘Component Configuration’). If this value is set to 0, GENy will automatically </p>
<p>compute  this value as  maximum  of  the  shutdown  timing of all AUTOSAR  NM  channels. </p>
<p>Any other value entered has to be greater or equal as this maximum value. </p>
<p>                                            </p>
<p>19</p>
<p> FlexRay NM Repetition Cycle Time: (Repetition Cycle) * (FlexRay Cycle Time) </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>97 / 104 </p>
<p>If OSEK NM Support is enabled the ‘NM Coordination Shutdown Timer’ has also to be at </p>
<p>least greater than the OSEK NM Wait Bus Sleep Time. If the shutdown timer value is set to </p>
<p>0, GENy will automatically generate a valid value. </p>
<p><b> </b></p>
<p> </p>
<p><b>Info</b> </p>
<p>Adding a manual shutdown timing is most likely only necessary when the Extended </p>
<p>Coordination feature is enabled, since in a scenario where multiple coordinators are </p>
<p>connected to the same bus and having further independent channels each of the </p>
<p>coordinator does not know all shutdown timings. </p>
<p><b> </b></p>
<p>The calculation of a common minimum shutdown time is described in detail in the following </p>
<p>sub-chapter. </p>
<p><b>6.3.3.3.1 </b></p>
<p><b>Shutdown Time Calculation </b></p>
<p>The  common  shutdown  timing  can  be  calculated  as  maximum  shutdown  timing  of  all </p>
<p>coordinated channels from all coordinators. The shutdown timing of each channel depends </p>
<p>on the NM type (OSEK NM, CAN NM, FlexRay NM, Fiat Class B or Fiat Class C). The </p>
<p>computation formula for each type is listed in the following table. </p>
<p><b>NM Type </b></p>
<p><b>Shutdown Timing </b></p>
<p>CAN NM </p>
<p>CanNmWaitBusSleepTime</p>
<p>20</p>
<p> + CanNmTimeoutTime</p>
<p>20</p>
<p> + </p>
<p>CanNmMainFunctionPeriod</p>
<p>20</p>
<p> </p>
<p>FlexRay NM </p>
<p>((FrNmReadySleepCnt</p>
<p>21</p>
<p> + 2) * FrNmRepetitionCycle</p>
<p>22</p>
<p> * FrCycleTime</p>
<p>23</p>
<p> ) </p>
<p>OSEK NM </p>
<p>OsekNmWaitBusSleepTime</p>
<p>20</p>
<p> + (OsekNmRingTime</p>
<p>24</p>
<p> * nrOfOsekNodes</p>
<p>25</p>
<p>) </p>
<p>Fiat Class B </p>
<p>NmFiatBSilentTime</p>
<p>26</p>
<p> </p>
<p>Fiat Class C </p>
<p>NmFiatCWaitBusSleepTime</p>
<p>27</p>
<p> </p>
<p>Table 6-5  </p>
<p>Common Shutdown Time Calculation </p>
<p><b>6.3.3.4 </b></p>
<p><b>Synchronized Channels </b></p>
<p>For a reasonable coordination at least two NMs must be available that are coordinated. </p>
<p>Therefore  the  minimum  number  of  synchronous  channels  is  one,  if  this  synchronous </p>
<p>channel  is  a  channel  with  multiple  NMs  (refer  to  chapter  3.4.3  ‘Coordination  of  Multiple </p>
<p>NMs within one Channel’). In all other cases at least two channels must be available that </p>
<p>are not set to ‘Selective’. </p>
<p>                                            </p>
<p>20</p>
<p> Timing value given in ms </p>
<p>21</p>
<p> Ready Sleep Counter is given in number of Repetition Cycles </p>
<p>22</p>
<p> Repetition Cycle is given in number of FlexRay Cycles </p>
<p>23</p>
<p> FlexRay Cycle Time (duration of one FlexRay cycle) given in ms </p>
<p>24</p>
<p> Time interval between two ring messages (TTyp) given in ms </p>
<p>25</p>
<p> (Maximum) Number of OSEK NM Nodes in the network </p>
<p>26</p>
<p> Silent Time value given in s </p>
<p>27</p>
<p> Wait Bus Sleep Timeout Time given in s </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>98 / 104 </p>
<p><b>6.3.4 </b></p>
<p><b>NM Extended Coordination Restrictions </b></p>
<p>In  the  following  table  the  required  enabled  configuration  items  of  all  possibly  involved </p>
<p>components for a proper usage of the Coordinator Extension are listed: </p>
<p> </p>
<p><b>Component </b></p>
<p><b>Required Configuration Item </b></p>
<p>NM Interface / CAN NM / FlexRay NM </p>
<p>Coordinator Synchronization Support</p>
<p>28</p>
<p> </p>
<p>CAN NM </p>
<p>Pdu Cbv Position </p>
<p>FlexRay NM </p>
<p>Control Bit Vector Enabled </p>
<p>Table 6-6  </p>
<p>Required Items of Involved Components for Proper Usage of the Coordinator Extension </p>
<p>Additionally the following listed timing restrictions are required: </p>
<p><b>&gt; </b> For each channel: (Ready Sleep Timeout Time)</p>
<p>29</p>
<p> &gt; 2 * (Message Cycle Time) </p>
<p><b>&gt; </b> For all coordinators that are connected (directly or indirectly) the ‘NM Coordination </p>
<p>Shutdown Timer’ has to be set explicitly (no automatic computation via setting the </p>
<p>value to 0) to the same value. Refer to chapter 6.3.3.3 ‘Shutdown Timing’ for details </p>
<p>about the ‘NM Coordination Shutdown Timer’. </p>
<p><b>&gt; </b> If the CAN NM Feature ‘Busload Reduction’ is used all coordinators must have smaller </p>
<p>‘Reduced Message Cycle Times’ than all other nodes and a coordinator with a higher </p>
<p>priority must have always a smaller ‘Reduced Message Cycle Time’ than another </p>
<p>coordinator with a lower priority. For a detailed description of the ‘Busload Reduction’ </p>
<p>Feature please refer to [3] and the Technical Reference of the CAN NM. </p>
<p><b>6.3.5 </b></p>
<p><b>OSEK NM Configuration </b></p>
<p>For  the  usage  of  an  OSEK  NM  channel  the  feature  ‘OSEK  Support’  has  to  be  enabled </p>
<p>(refer also to chapter 6.3.1 ‘Component Configuration’). For the configuration of this OSEK </p>
<p>NM  channel  the  configuration  options  as  described  in  chapter  6.3.3  ‘NM  Coordination </p>
<p>Restrictions’ have to be made. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>For the correct usage of OSEK NM within the AUTOSAR stack the OSEK NM feature </p>
<p>‘Extended Callback’ must be enabled in all cases (not only for coordination scenario). </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p>The following figure shows an OSEK NM configuration which is configured correctly for the </p>
<p>OSEK  Support  within  NM  Interface  and  additionally  the  settings  necessary  for  the  NM </p>
<p>Coordination are activated: </p>
<p>                                            </p>
<p>28</p>
<p> When GENy is used for configuration this is automatically handled by GENy for CAN NM and FlexRay NM. </p>
<p>29</p>
<p> CAN: NM Timeout Time; FlexRay: (Ready Sleep Counter + 1) * (Repetition Cycle) * (FlexRay Cycle Time) </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>99 / 104 </p>
<p> </p>
<p>Figure 6-4 </p>
<p>OSEK NM Configuration </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>100 / 104 </p>
<p><b>6.3.6 </b></p>
<p><b>Diagnostic Gateway Extension Configuration Restrictions </b></p>
<p>For the proper usage of the diagnostic gateway extension some NM configuration items </p>
<p>are  required  to  be  enabled.  They  are  listed  for  all  possibly  involved  components  in  the </p>
<p>following table: </p>
<p><b>Component </b></p>
<p><b>Required Configuration Item </b></p>
<p>NM Interface / CAN NM </p>
<p>Node Id Enabled </p>
<p>CAN NM </p>
<p>Diagnostic Gateway Extension Support </p>
<p>OSEK NM </p>
<p>NM Message Rx Indication </p>
<p>OSEK NM </p>
<p>Indexed Component </p>
<p>Table 6-7  </p>
<p>Required Configuration Items for Diagnostic Gateway Extension </p>
<p>Additionally  the  PDU  length  of  the  CAN  NM  message  must  be  greater  5  and  the  node </p>
<p>identifier  position  must  not  be  configured  off.  For  details  of  the  CAN  NM  or  OSEK  NM </p>
<p>configuration refer to the corresponding Technical Reference. </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p><b> </b></p>
<p><b>Caution </b></p>
<p>Diagnostic Gateway Extension cannot be used when FlexRay NM, Fiat Class B or Fiat </p>
<p>Class C is used. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p><b>6.3.7 </b></p>
<p><b>NM Gateway Extension Configuration Restrictions </b></p>
<p>For  the  proper  usage  of  the  NM  gateway  extension  some  NM  configuration  items  are </p>
<p>required to be enabled. The feature has the same restrictions as the diagnostic gateway </p>
<p>extension </p>
<p>(refer </p>
<p>to </p>
<p>chapter </p>
<p>6.3.6 </p>
<p>‘Diagnostic </p>
<p>Gateway </p>
<p>Extension </p>
<p>Configuration </p>
<p>Restrictions’). Additionally required configuration items listed in the following table: </p>
<p><b>Component </b></p>
<p><b>Required Configuration Item </b></p>
<p>NM Interface / CAN NM / OSEK NM </p>
<p>Remote Sleep Ind Enabled </p>
<p>NM Interface / CAN NM </p>
<p>Bus Synchronization Enabled </p>
<p>CAN NM </p>
<p>Extended Remote Sleep Indication </p>
<p>CAN NM </p>
<p>NM Gateway Extension Support </p>
<p>OSEK NM </p>
<p>Remote Sleep </p>
<p>OSEK NM </p>
<p>Node Monitoring </p>
<p>OSEK NM </p>
<p>Extended Callbacks </p>
<p>OSEK NM </p>
<p>Ring Data Access </p>
<p>Table 6-8  </p>
<p>Required Configuration Items for NM Gateway Extension </p>
<p>Additionally </p>
<p>the </p>
<p>same </p>
<p>restrictions </p>
<p>to </p>
<p>the </p>
<p>NM </p>
<p>main </p>
<p>function </p>
<p>cycle </p>
<p>time </p>
<p>as </p>
<p>for </p>
<p>the </p>
<p>‘Coordinator Support’  have  to  be  taken  into  account.  Refer to  chapter  6.3.3.2  ‘NM  Main </p>
<p>Function Cycle Time’ for details. </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>101 / 104 </p>
<p><b>6.3.8 </b></p>
<p><b>Fiat Class B NM / Fiat Class C NM Configuration Restrictions </b></p>
<p>For  the  usage  of  Fiat  Class  B  NM  /  Fiat  Class  C  NM  some  features  must  be  set </p>
<p>accordingly in the NM Interface. The following table contains those configuration items and </p>
<p>the required setting. </p>
<p> </p>
<p><b>Feature </b></p>
<p><b>Required Setting </b></p>
<p>Passive Mode Enabled </p>
<p>Disabled </p>
<p>State Change Ind Enabled </p>
<p>Enabled </p>
<p>NM Callbacks Prototype Header </p>
<p>BswM_Nm.h </p>
<p>State Change Indication Callback </p>
<p>BswM_Nm_StateChangeNotification </p>
<p>Table 6-9  </p>
<p>Required Configuration Settings for Fiat Class B NM / Fiat Class C NM Usage </p>
<p> </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p><b>Note </b></p>
<p>These configuration restrictions should be already preconfigured when using a </p>
<p>configuration with Fiat Class B NM / Fiat Class C NM. </p>
<p><b> </b></p>
<p><b> </b></p>
<p> </p>
<p> </p>
<p>Note that no other callback function except ‘State Change Indication Callback’, ‘Remote </p>
<p>Sleep Indication Callback’</p>
<p>30</p>
<p> and ‘Remote Sleep Cancellation Callback’</p>
<p>30</p>
<p> are used by Fiat </p>
<p>Class B NM / Fiat Class C NM. </p>
<p>                                            </p>
<p>30</p>
<p> Only if ‘Nm Type’ is ‘Master’ in Fiat Class B / Fiat Class C </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>102 / 104 </p>
<p><b>7 </b></p>
<p><b>Glossary and Abbreviations </b></p>
<p><b>7.1 </b></p>
<p><b>Abbreviations </b></p>
<p><b>Abbreviations </b></p>
<p><b>Complete expression </b></p>
<p><b>API </b></p>
<p><b>A</b>pplication <b>P</b>rogramming <b>I</b>nterface </p>
<p><b>AUTOSAR </b></p>
<p><b>Aut</b>omotive <b>O</b>pen <b>S</b>ystem <b>Ar</b>chitecture </p>
<p><b>BSW </b></p>
<p><b>B</b>asic <b>S</b>oft<b>w</b>are </p>
<p><b>BSWM </b></p>
<p><b>B</b>asic <b>S</b>oft<b>w</b>are Mode <b>M</b>anager </p>
<p><b>CAN </b></p>
<p><b>C</b>ontroller <b>A</b>rea <b>N</b>etwork </p>
<p><b>CBV </b></p>
<p><b>C</b>ontrol <b>B</b>it <b>V</b>ector </p>
<p><b>CCL </b></p>
<p><b>C</b>ommunication <b>C</b>ontrol <b>L</b>ayer </p>
<p><b>ComM </b></p>
<p><b>C</b>OM <b>M</b>anager </p>
<p><b>DEM </b></p>
<p><b>D</b></p>
<p>iagnostic </p>
<p><b>E</b></p>
<p>vent </p>
<p><b>M</b></p>
<p>anager</p>
<p> </p>
<p><b>DET </b></p>
<p><b>D</b>evelopment <b>E</b>rror <b>T</b>racer </p>
<p><b>DLC </b></p>
<p><b>D</b>ata <b>L</b>ength <b>C</b>ode (Number of data bytes of a CAN message) </p>
<p><b>DLL </b></p>
<p><b>D</b>ata <b>l</b>ink <b>l</b>ayer </p>
<p><b>EAD </b></p>
<p><b>E</b>mbedded <b>A</b>rchitecture <b>D</b>esigner (Generation tool for MICROSAR </p>
<p>components) </p>
<p><b>ECU </b></p>
<p><b>E</b>lectronic <b>C</b>ontrol <b>U</b>nit </p>
<p><b>FIBEX </b></p>
<p><b>Fi</b>eld <b>B</b>us <b>Ex</b>change </p>
<p><b>ID </b></p>
<p><b>Id</b>entifier (of a CAN message) </p>
<p><b>IL </b></p>
<p><b>I</b>nteraction <b>L</b>ayer </p>
<p><b>ISR </b></p>
<p><b>I</b>nterrupt <b>S</b>ervice <b>R</b>outine </p>
<p><b>KL15 </b></p>
<p><b>K</b>lemme <b>15 </b></p>
<p><b>KL30 </b></p>
<p><b>K</b>lemme <b>30 </b></p>
<p><b>KL31 </b></p>
<p><b>K</b>lemme <b>31 </b></p>
<p><b>MICROSAR </b></p>
<p><b>Micr</b>ocontroller <b>O</b>pen <b>S</b>ystem <b>Ar</b>chitecture (the Vector AUTOSAR solution) </p>
<p><b>MISRA </b></p>
<p><b>M</b>otor <b>I</b>ndustry <b>S</b>oftware <b>R</b>eliability <b>A</b>ssociation </p>
<p><b>NID </b></p>
<p><b>N</b>ode <b>Id</b>entifier </p>
<p><b>NM </b></p>
<p><b>N</b>etwork <b>M</b>anagement  </p>
<p><b>PDU </b></p>
<p><b>P</b>rotocol <b>D</b>ata <b>U</b>nit </p>
<p><b>RAM </b></p>
<p><b>R</b>andom <b>A</b>ccess <b>M</b>emory </p>
<p><b>RI </b></p>
<p><b>R</b>eference <b>I</b>mplementation</p>
<p> </p>
<p>(Reference Implementation of the CAN-Driver High Level part) </p>
<p><b>ROM </b></p>
<p><b>R</b>ead <b>O</b>nly <b>M</b>emory </p>
<p><b>SRS </b></p>
<p><b>S</b>oftware <b>R</b>equirement <b>S</b>pecification </p>
<p><b>SWS </b></p>
<p><b>S</b>oft<b>w</b>are <b>S</b>pecification </p>
<p>Table 7-1  </p>
<p>Abbreviations </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>103 / 104 </p>
<p><b>7.2 </b></p>
<p><b>Glossary </b></p>
<p> </p>
<p><b>Glossary </b></p>
<p><b>Description </b></p>
<p><b>Confirmation </b></p>
<p>Notification by the data link layer on asynchronous successful transmission of a  </p>
<p>CAN message. </p>
<p><b>Identifier </b></p>
<p>Identifies a message. </p>
<p><b>Indication </b></p>
<p>Notification by the data link layer on asynchronous reception of a message. </p>
<p><b>Message </b></p>
<p>One or more signals are assigned to each message. </p>
<p><b>NM Channel </b></p>
<p>Logical communication path associated with one NM cluster. </p>
<p><b>NM Cluster </b></p>
<p>Instance of the NM to handle one physical bus. </p>
<p><b>Signal </b></p>
<p>Signals  describe  the  significance  of  the  individual  data  segments  within  a </p>
<p>message.  Typically  bits,  bytes  or  words  are  used  for  data  segments  but </p>
<p>individual bit combinations are also possible. In the CAN database, each data </p>
<p>segment  is  assigned  a  symbolic  name,  a  value  range,  a  conversion  formula </p>
<p>and a physical unit, as well as a list of receiving nodes. </p>
<p>Table 7-2  </p>
<p>Glossary </p>
<p> </p>
<h1 style="page-break-before:always; "></h1>
<p>Technical Reference MICROSAR Network Management Interface </p>
<p></p>
<p>2013, Vector Informatik GmbH </p>
<p>Version: 2.22.00 </p>
<p>based on template version 4.8.0 </p>
<p>104 / 104 </p>
<p><b>8 </b></p>
<p><b>Contact </b></p>
<p>Visit our website for more information on </p>
<p> </p>
<p>&gt;   News </p>
<p>&gt;   Products </p>
<p>&gt;   Demo software </p>
<p>&gt;   Support </p>
<p>&gt;   Training data </p>
<p>&gt;   Addresses </p>
<p> </p>
<p><b>www.vector.com </b></p>
<p> </p>
<p> </p>
</body>
</html>
{% endraw %}